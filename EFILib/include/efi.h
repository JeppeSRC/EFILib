#pragma once
/*
_______________________________________________ 
|     UEFI memory types        | Legacy types |
| EfiReservedMemoryType        |              |
| EfiRuntimeServicesCode       |              |
| EfiRuntimeServicesData       |  Reserved    |
| EfiMemoryMappedIO            |              |
| EfiMemoryMappedIOPortSpace   |              |
| EfiPalCode                   |              |
| EfiUnusableMemory            |  bad memory  |
| EfiACPIReclaimMemory         | ACPI reclaim |
| EfiLoaderCode                |              |
| EfiLoaderData                |              |
| EfiBootServicesCode          |   Usable     | 
| EfiBootServicesData          |              |
| EfiConventionalMemory        |              |
| EfiACPIMemoryNVS             | ACPI NVS     |
*/
//definitions
#define EFI_SYSTEM_TABLE_SIGNATURE 0x5453595320494249
#define EFI_2_60_SYSTEM_TABLE_REVISION ((2<<16) | (60))
#define EFI_2_50_SYSTEM_TABLE_REVISION ((2<<16) | (50))
#define EFI_2_40_SYSTEM_TABLE_REVISION ((2<<16) | (40))
#define EFI_2_31_SYSTEM_TABLE_REVISION ((2<<16) | (31))
#define EFI_2_30_SYSTEM_TABLE_REVISION ((2<<16) | (30))
#define EFI_2_20_SYSTEM_TABLE_REVISION ((2<<16) | (20))
#define EFI_2_10_SYSTEM_TABLE_REVISION ((2<<16) | (10))
#define EFI_2_00_SYSTEM_TABLE_REVISION ((2<<16) | (00))
#define EFI_1_10_SYSTEM_TABLE_REVISION ((1<<16) | (10))
#define EFI_1_02_SYSTEM_TABLE_REVISION ((1<<16) | (02))
#define EFI_SYSTEM_TABLE_REVISION EFI_2_60_SYSTEM_TABLE_REVISION
#define EFI_SPECIFICATION_VERSION EFI_SYSTEM_TABLE_REVISION

#define EFI_BOOT_SERVICES_SIGNATURE 0x56524553544f4f42
#define EFI_BOOT_SERVICES_REVISION EFI_SPECIFICATION_VERSION

#define EFI_RUNTIME_SERVICES_SIGNATURE 0x56524553544e5552
#define EFI_RUNTIME_SERVICES_REVISION EFI_SPECIFICATION_VERSION

#define EFI_SUCCESS 0

#ifdef _M_AMD64
#define HIGH_BIT (1 << 63)
#else 
#define HIGH_BIT (1 << 31)
#endif

#define EFI_LOAD_ERROR				(1  | HIGH_BIT)
#define EFI_INVALID_PARAMETER		(2  | HIGH_BIT)
#define EFI_UNSUPPORTED				(3  | HIGH_BIT)
#define EFI_BAD_BUFFER_SIZE			(4  | HIGH_BIT)
#define EFI_BUFFER_TOO_SMALL		(5  | HIGH_BIT)
#define EFI_NOT_READY				(6  | HIGH_BIT)
#define EFI_DEVICE_ERROR			(7  | HIGH_BIT)
#define EFI_WRITE_PROTECTED			(8  | HIGH_BIT)
#define EFI_OUT_OF_RESOURCES		(9  | HIGH_BIT)
#define EFI_VOLUME_CORRUPTED		(10 | HIGH_BIT)
#define EFI_VOLUME_FULL				(11 | HIGH_BIT)
#define EFI_NO_MEDIA				(12 | HIGH_BIT)
#define EFI_MEDIA_CHANGED			(13 | HIGH_BIT)
#define EFI_NOT_FOUND				(14 | HIGH_BIT)
#define EFI_ACCESS_DENIED			(15 | HIGH_BIT)
#define EFI_NO_RESPONSE				(16 | HIGH_BIT)
#define EFI_NO_MAPPING				(17 | HIGH_BIT)
#define EFI_TIMEOUT					(18 | HIGH_BIT)
#define EFI_NOT_STARTED				(19 | HIGH_BIT)
#define EFI_ALREADY_STARTED			(20 | HIGH_BIT)
#define EFI_ABORTED					(21 | HIGH_BIT)
#define EFI_ICMP_ERROR				(22 | HIGH_BIT)
#define EFI_TFTP_ERROR				(23 | HIGH_BIT)
#define EFI_PROTOCOL_ERROR			(24 | HIGH_BIT)
#define EFI_INCOMPATIBLE_VERSION	(25 | HIGH_BIT)
#define EFI_SECURITY_VIOLATION		(26 | HIGH_BIT)
#define EFI_CRC_ERROR				(27 | HIGH_BIT)
#define EFI_END_OF_MEDIA			(28 | HIGH_BIT)
#define EFI_END_OF_FILE				(31 | HIGH_BIT)
#define EFI_INVALID_LANGUAGE		(32 | HIGH_BIT)
#define EFI_COMPROMISED_DATA		(33 | HIGH_BIT)
#define EFI_IP_ADDRESS_CONFLICT		(34 | HIGH_BIT)
#define EFI_HTTP_ERROR				(35 | HIGH_BIT)

#define EFI_WARN_UNKNOW_GLYPH		1
#define EFI_WARN_DELETE_FAILURE		2
#define	EFI_WARN_WRITE_FAILURE		3
#define EFI_WARN_BUFFER_TOO_SMALL	4
#define EFI_WARN_STALE_DATA			5
#define EFI_WARN_FILE_SYSTEM		6


#define EFIAPI __cdecl

#define IN 
#define OUT 
#define OPTIONAL 
#define CONST const

//data types

typedef unsigned char									BOOLEAN;
typedef signed char										INT8;
typedef unsigned char									UINT8;
typedef signed short									INT16;
typedef unsigned short									UINT16;
typedef signed int										INT32;
typedef unsigned int									UINT32;
typedef signed long long								INT64;
typedef unsigned long long								UINT64;

#ifdef _M_AMD64
typedef INT64											INTN;
typedef UINT64											UINTN;
#else
typedef INT32											INTN;
typedef UINT32											UINTN;
#endif

typedef char											CHAR8;
typedef short											CHAR16;

typedef void											VOID;
typedef UINTN											EFI_STATUS;

//Struct declarations and typedefs

#define DEF_STRUCT(name) typedef struct name name

DEF_STRUCT(EFI_SYSTEM_TABLE);
DEF_STRUCT(EFI_CONFIGURATION_TABLE);
DEF_STRUCT(EFI_GUID);
DEF_STRUCT(EFI_TABLE_HEADER);
DEF_STRUCT(EFI_MEMORY_DESCRIPTOR);
DEF_STRUCT(EFI_OPEN_PROTOCOL_INFORMATION_ENTRY);
DEF_STRUCT(EFI_DEVICE_PATH_PROTOCOL);
DEF_STRUCT(EFI_HII_PACKAGE_LIST_HEADER);
DEF_STRUCT(EFI_BOOT_SERVICES);
DEF_STRUCT(EFI_TIME);
DEF_STRUCT(EFI_TIME_CAPABILITIES);
DEF_STRUCT(WIN_CERTIFICATE);
DEF_STRUCT(WIN_CERTIFICATE_UEFI_GUID);
DEF_STRUCT(EFI_VARIABLE_AUTHENTICATION);
DEF_STRUCT(EFI_VARIABLE_AUTHENTICATION_2);
DEF_STRUCT(EFI_CAPSULE_BLOCK_DESCRIPTOR);
DEF_STRUCT(EFI_CAPSULE_HEADER);
DEF_STRUCT(EFI_RUNTIME_SERVICES);
DEF_STRUCT(EFI_LOADED_IMAGE_PROTOCOL);
DEF_STRUCT(EFI_INPUT_KEY);
DEF_STRUCT(EFI_SIMPLE_TEXT_INPUT_PROTOCOL);
DEF_STRUCT(EFI_KEY_STATE);
DEF_STRUCT(EFI_KEY_DATA);
DEF_STRUCT(SIMPLE_TEXT_OUTPUT_MODE);
DEF_STRUCT(EFI_SIMPLE_TEXT_INPUT_EX_PROTOCOL);
DEF_STRUCT(EFI_SIMPLE_TEXT_OUTPUT_PROTOCOL);
DEF_STRUCT(EFI_SIMPLE_POINTER_MODE);
DEF_STRUCT(EFI_SIMPLE_POINTER_STATE);
DEF_STRUCT(EFI_SIMPLE_POINTER_PROTOCOL);
DEF_STRUCT(EFI_ABSOLUTE_POINTER_MODE);
DEF_STRUCT(EFI_ABSOLUTE_POINTER_PROTOCOL);
DEF_STRUCT(SERIAL_IO_MODE);
DEF_STRUCT(EFI_SERIAL_IO_PROTOCOL);
DEF_STRUCT(EFI_PIXEL_BITMASK);
DEF_STRUCT(EFI_GRAPHICS_OUTPUT_MODE_INFORMATION);
DEF_STRUCT(EFI_GRAPHICS_OUTPUT_PROTOCOL_MODE);
DEF_STRUCT(EFI_GRAPHICS_OUTPUT_BLT_PIXEL);
DEF_STRUCT(EFI_GRAPHICS_OUTPUT_PROTOCOL);
DEF_STRUCT(EFI_EDID_DISCOVERED_PROTOCOL);
DEF_STRUCT(EFI_EDID_ACTIVE_PROTOCOL);
DEF_STRUCT(EFI_EDID_OVERRIDE_PROTOCOL);
DEF_STRUCT(EFI_LOAD_FILE_PROTOCOL);
DEF_STRUCT(EFI_SIMPLE_FILE_SYSTEM_PROTOCOL);
DEF_STRUCT(EFI_FILE_IO_TOKEN);
DEF_STRUCT(EFI_FILE_PROTOCOL);
DEF_STRUCT(EFI_FILE_INFO);
DEF_STRUCT(EFI_FILE_SYSTEM_INFO);
DEF_STRUCT(EFI_FILE_SYSTEM_VOLUME_LABEL);
DEF_STRUCT(EFI_TAPE_IO_PROTOCOL);
DEF_STRUCT(EFI_TAPE_HEADER);
DEF_STRUCT(EFI_DISK_IO_PROTOCOL);
DEF_STRUCT(EFI_DISK_IO2_TOKEN);
DEF_STRUCT(EFI_DISK_IO2_PROTOCOL);
DEF_STRUCT(EFI_BLOCK_IO_MEDIA);
DEF_STRUCT(EFI_BLOCK_IO_PROTOCOL);
DEF_STRUCT(EFI_BLOCK_IO2_TOKEN);
DEF_STRUCT(EFI_BLOCK_IO2_PROTOCOL);
DEF_STRUCT(EFI_BLOCK_IO_CRYPTO_CAPABILITY);
DEF_STRUCT(EFI_BLOCK_IO_CRYPTO_IV_INPUT);
DEF_STRUCT(EFI_BLOCK_IO_CRYPTO_IV_INPUT_AES_XTS);
DEF_STRUCT(EFI_BLOCK_IO_CRYPTO_IV_INPUT_AES_CBC_MICROSOFT_BITLOCKER);
DEF_STRUCT(EFI_BLOCK_IO_CRYPTO_CONFIGURATION_TABLE_ENTRY);
DEF_STRUCT(EFI_BLOCK_IO_CRYPTO_RESPONSE_CONFIGURATION_ENTRY);
DEF_STRUCT(EFI_BLOCK_IO_CRYPTO_CAPABILITIES);
DEF_STRUCT(EFI_BLOCK_IO_CRYPTO_TOKEN);
DEF_STRUCT(EFI_BLOCK_IO_CRYPTO_PROTOCOL);
DEF_STRUCT(EFI_ERASE_BLOCK_TOKEN);
DEF_STRUCT(EFI_ERASE_BLOCK_PROTOCOL);
DEF_STRUCT(EFI_ATA_PASS_THRU_MODE);
DEF_STRUCT(EFI_ATA_COMMAND_BLOCK);
DEF_STRUCT(EFI_ATA_STATUS_BLOCK);
DEF_STRUCT(EFI_ATA_PASS_THRU_COMMAND_PACKET);
DEF_STRUCT(EFI_ATA_PASS_THRU_PROTOCOL);
DEF_STRUCT(EFI_STORAGE_SECURITY_COMMAND_PROTOCOL);
DEF_STRUCT(EFI_NVM_EXPRESS_PASS_THRU_MODE);
DEF_STRUCT(NVME_CDW0);
DEF_STRUCT(EFI_NVM_EXPRESS_COMMAND);
DEF_STRUCT(EFI_NVM_EXPRESS_COMPLETION);
DEF_STRUCT(EFI_NVM_EXPRESS_PASS_THRU_COMMAND_PACKET);
DEF_STRUCT(EFI_NVM_EXPRESS_PASS_THRU_PROTOCOL);
DEF_STRUCT(EFI_SD_MMC_COMMAND_BLOCK);
DEF_STRUCT(EFI_SD_MMC_STATUS_BLOCK);
DEF_STRUCT(EFI_SD_MMC_PASS_THRU_COMMAND_PACKET);
DEF_STRUCT(EFI_SD_MMC_PASS_THRU_PROTOCOL);
DEF_STRUCT(EFI_RAM_DISK_PROTOCOL);
DEF_STRUCT(EFI_PCI_ROOT_BRIDGE_IO_PROTOCOL);
DEF_STRUCT(EFI_PCI_ROOT_BRIDGE_IO_PROTOCOL_ACCESS);
DEF_STRUCT(EFI_PCI_IO_PROTOCOL);
DEF_STRUCT(EFI_PCI_IO_PROTOCOL_ACCESS);
DEF_STRUCT(EFI_PCI_IO_PROTOCOL_CONFIG_ACCESS);
DEF_STRUCT(EFI_SCSI_IO_PROTOCOL);
DEF_STRUCT(EFI_SCSI_IO_SCSI_REQUEST_PACKET);
DEF_STRUCT(EFI_EXT_SCSI_PASS_THRU_PROTOCOL);
DEF_STRUCT(EFI_EXT_SCSI_PASS_THRU_MODE);
DEF_STRUCT(EFI_EXT_SCSI_PASS_THRU_SCSI_REQUEST_PACKET);
DEF_STRUCT(EFI_ISCSI_INITIATOR_NAME_PROTOCOL);
DEF_STRUCT(EFI_USB2_HC_PROTOCOL);
DEF_STRUCT(EFI_USB2_HC_TRANSACTION_TRANSLATOR);
DEF_STRUCT(EFI_USB_PORT_STATUS);
DEF_STRUCT(EFI_USB_IO_PROTOCOL);
DEF_STRUCT(EFI_USB_DEVICE_REQUEST);
DEF_STRUCT(EFI_USB_DEVICE_DESCRIPTOR);
DEF_STRUCT(EFI_USB_CONFIG_DESCRIPTOR);
DEF_STRUCT(EFI_USB_INTERFACE_DESCRIPTOR);
DEF_STRUCT(EFI_USB_ENDPOINT_DESCRIPTOR);
DEF_STRUCT(EFI_USBFN_IO_PROTOCOL);
DEF_STRUCT(EFI_USB_INTERFACE_INFO);
DEF_STRUCT(EFI_USB_CONFIG_INFO);
DEF_STRUCT(EFI_USB_DEVICE_INFO);
DEF_STRUCT(EFI_USBFN_TRANSFER_RESULT);
DEF_STRUCT(EFI_DEBUG_SUPPORT_PROTOCOL);
DEF_STRUCT(EFI_SYSTEM_CONTEXT_EBC);
DEF_STRUCT(EFI_SYSTEM_CONTEXT_IA32);
DEF_STRUCT(EFI_FX_SAVE_STATE_IA32);
DEF_STRUCT(EFI_SYSTEM_CONTEXT_X64);
DEF_STRUCT(EFI_FX_SAVE_STATE_X64);
DEF_STRUCT(EFI_SYSTEM_CONTEXT_IPF);
DEF_STRUCT(EFI_SYSTEM_CONTEXT_ARM);
DEF_STRUCT(EFI_SYSTEM_CONTEXT_AARCH64);
DEF_STRUCT(EFI_DEBUGPORT_PROTOCOL);
DEF_STRUCT(EFI_DEBUG_IMAGE_INFO_NORMAL);
DEF_STRUCT(EFI_DECOMPRESS_PROTOCOL);
DEF_STRUCT(EFI_ACPI_TABLE_PROTOCOL);
DEF_STRUCT(EFI_UNICODE_COLLATION_PROTOCOL);
DEF_STRUCT(EFI_REGULAR_EXPRESSION_PROTOCOL);
DEF_STRUCT(EFI_REGEX_CAPTURE);
DEF_STRUCT(EFI_EBC_PROTOCOL);
DEF_STRUCT(EFI_FIRMWARE_MANAGEMENT_PROTOCOL);
DEF_STRUCT(EFI_FIRMWARE_IMAGE_DESCRIPTOR);
DEF_STRUCT(EFI_FIRMWARE_IMAGE_AUTHENTICATION);
DEF_STRUCT(EFI_FIRMWARE_MANAGEMENT_CAPSULE_HEADER);
DEF_STRUCT(EFI_FIRMWARE_MANAGEMENT_CAPSULE_IMAGE_HEADER);
DEF_STRUCT(EFI_SYSTEM_RESOURCE_TABLE);
DEF_STRUCT(EFI_SYSTEM_RESOURCE_ENTRY);
DEF_STRUCT(EFI_SIMPLE_NETWORK_PROTOCOL);
DEF_STRUCT(EFI_SIMPLE_NETWORK_MODE);
DEF_STRUCT(EFI_NETWORK_STATISTICS);
DEF_STRUCT(EFI_NETWORK_INTERFACE_IDENTIFIER_PROTOCOL);
DEF_STRUCT(EFI_PXE_BASE_CODE_PROTOCOL);
DEF_STRUCT(EFI_PXE_BASE_CODE_MODE);
DEF_STRUCT(EFI_IPv4_ADDRESS);
DEF_STRUCT(EFI_IPv6_ADDRESS);
DEF_STRUCT(EFI_MAC_ADDRESS);
DEF_STRUCT(EFI_PXE_BASE_CODE_DHCPV4_PACKET);
DEF_STRUCT(EFI_PXE_BASE_CODE_DHCPV6_PACKET);
DEF_STRUCT(EFI_PXE_BASE_CODE_ICMP_ERROR);
DEF_STRUCT(EFI_PXE_BASE_CODE_TFTP_ERROR);
DEF_STRUCT(EFI_PXE_BASE_CODE_IP_FILTER);
DEF_STRUCT(EFI_PXE_BASE_CODE_ARP_ENTRY);
DEF_STRUCT(EFI_PXE_BASE_CODE_ROUTE_ENTRY);
DEF_STRUCT(EFI_PXE_BASE_CODE_DISCOVER_INFO);
DEF_STRUCT(EFI_PXE_BASE_CODE_SRVLIST);
DEF_STRUCT(EFI_PXE_BASE_CODE_MTFTP_INFO);
DEF_STRUCT(EFI_PXE_BASE_CODE_CALLBACK_PROTOCOL);
DEF_STRUCT(EFI_BIS_PROTOCOL);
DEF_STRUCT(EFI_BIS_VERSION);
DEF_STRUCT(EFI_BIS_DATA);
DEF_STRUCT(EFI_BIS_SIGNATURE_INFO);
DEF_STRUCT(EFI_MANAGED_NETWORK_PROTOCOL);
DEF_STRUCT(EFI_MANAGED_NETWORK_CONFIG_DATA);
DEF_STRUCT(EFI_MANAGED_NETWORK_COMPLETION_TOKEN);
DEF_STRUCT(EFI_MANAGED_NETWORK_RECEIVE_DATA);
DEF_STRUCT(EFI_MANAGED_NETWORK_TRANSMIT_DATA);
DEF_STRUCT(EFI_MANAGED_NETWORK_FRAGMENT_DATA);
DEF_STRUCT(EFI_VLAN_CONFIG_PROTOCOL);
DEF_STRUCT(EFI_VLAN_FIND_DATA);
DEF_STRUCT(EFI_EAP_PROTOCOL);
DEF_STRUCT(EFI_EAPOL_PORT_INFO);
DEF_STRUCT(EFI_EAP_MANAGEMENT_PROTOCOL);
DEF_STRUCT(EFI_EAPOL_SUPPLICANT_PAE_CONFIGURATION);
DEF_STRUCT(EFI_EAPOL_SUPPLICANT_PAE_STATISTICS);
DEF_STRUCT(EFI_EAP_MANAGEMENT2_PROTOCOL);
DEF_STRUCT(EFI_EAP_CONFIGURATION_PROTOCOL);
DEF_STRUCT(EFI_WIRELESS_MAC_CONNECTION_PROTOCOL);
DEF_STRUCT(EFI_80211_SCAN_DATA_TOKEN);
DEF_STRUCT(EFI_80211_SCAN_DATA);
DEF_STRUCT(EFI_80211_ELEMENT_REQ);
DEF_STRUCT(EFI_80211_ELEMENT_HEADER);
DEF_STRUCT(EFI_80211_ELEMENT_SSID);
DEF_STRUCT(EFI_80211_SCAN_RESULT);
DEF_STRUCT(EFI_80211_BSS_DESCRIPTION);
DEF_STRUCT(EFI_80211_ELEMENT_COUNTRY);
DEF_STRUCT(EFI_80211_COUNTRY_TRIPLET_SUBBAND);
DEF_STRUCT(EFI_80211_COUNTRY_TRIPLET_OPERATE);
DEF_STRUCT(EFI_80211_ELEMENT_RSN);
DEF_STRUCT(EFI_80211_ELEMENT_DATA_RSN);
DEF_STRUCT(EFI_80211_BSS_DESP_PILOT);
DEF_STRUCT(EFI_80211_SUBELEMENT_INFO);
DEF_STRUCT(EFI_80211_ASSOCIATE_DATA_TOKEN);
DEF_STRUCT(EFI_80211_ASSOCIATE_DATA);
DEF_STRUCT(EFI_80211_ELEMENT_SUPP_CHANNEL);
DEF_STRUCT(EFI_80211_ELEMENT_SUPP_CHANNEL_TUPLE);
DEF_STRUCT(EFI_80211_ASSOCIATE_RESULT);
DEF_STRUCT(EFI_80211_ELEMENT_TIMEOUT_VAL);
DEF_STRUCT(EFI_80211_DISASSOCIATE_DATA_TOKEN);
DEF_STRUCT(EFI_80211_DISASSOCIATE_DATA);
DEF_STRUCT(EFI_80211_AUTHENTICATE_DATA_TOKEN);
DEF_STRUCT(EFI_80211_AUTHENTICATE_DATA);
DEF_STRUCT(EFI_80211_AUTHENTICATE_RESULT);
DEF_STRUCT(EFI_80211_DEAUTHENTICATE_DATA_TOKEN);
DEF_STRUCT(EFI_80211_DEAUTHENTICATE_DATA);
DEF_STRUCT(EFI_WIRELESS_MAC_CONNECTION_II_PROTOCOL);
DEF_STRUCT(EFI_80211_GET_NETWORKS_TOKEN);
DEF_STRUCT(EFI_80211_GET_NETWORKS_DATA);
DEF_STRUCT(EFI_80211_SSID);
DEF_STRUCT(EFI_80211_GET_NETWORKS_RESULT);
DEF_STRUCT(EFI_80211_NETWORK_DESCRIPTION);
DEF_STRUCT(EFI_80211_NETWORK);
DEF_STRUCT(EFI_80211_SUITE_SELECTOR);
DEF_STRUCT(EFI_80211_AKM_SUITE_SELECTOR);
DEF_STRUCT(EFI_80211_CIPHER_SUITE_SELECTOR);
DEF_STRUCT(EFI_80211_CONNECT_NETWORK_TOKEN);
DEF_STRUCT(EFI_80211_CONNECT_NETWORK_DATA);
DEF_STRUCT(EFI_80211_DISCONNECT_NETWORK_TOKEN);
DEF_STRUCT(EFI_SUPPLICANT_PROTOCOL);
DEF_STRUCT(EFI_SUPPLICANT_FRAGMENT_DATA);
DEF_STRUCT(EFI_SUPPLICANT_KEY_REFRESH);
DEF_STRUCT(EFI_SUPPLICANT_GTK_LIST);
DEF_STRUCT(EFI_SUPPLICANT_KEY);
DEF_STRUCT(EFI_80211_MAC_ADDRESS);
DEF_STRUCT(EFI_80211_ELEMENT_EXT_CAP);
DEF_STRUCT(EFI_80211_MULTIPLE_BSSID);
DEF_STRUCT(EFI_BLUETOOTH_HC_PROTOCOL);
DEF_STRUCT(EFI_BLUETOOTH_IO_PROTOCOL);
DEF_STRUCT(EFI_BLUETOOTH_DEVICE_INFO);
DEF_STRUCT(BLUETOOTH_ADDRESS);
DEF_STRUCT(BLUETOOTH_CLASS_OF_DEVICE);
DEF_STRUCT(EFI_BLUETOOTH_CONFIG_PROTOCOL);
DEF_STRUCT(EFI_BLUETOOTH_SCAN_CALLBACK_INFORMATION);
DEF_STRUCT(EFI_TCP4_PROTOCOL);
DEF_STRUCT(EFI_TCP4_ACCESS_POINT);
DEF_STRUCT(EFI_TCP4_OPTION);
DEF_STRUCT(EFI_TCP4_CONFIG_DATA);
DEF_STRUCT(EFI_TCP4_COMPLETION_TOKEN);
DEF_STRUCT(EFI_TCP4_CONNECTION_TOKEN);
DEF_STRUCT(EFI_TCP4_LISTEN_TOKEN);
DEF_STRUCT(EFI_TCP4_IO_TOKEN);
DEF_STRUCT(EFI_TCP4_RECEIVE_DATA);
DEF_STRUCT(EFI_TCP4_FRAGMENT_DATA);
DEF_STRUCT(EFI_TCP4_TRANSMIT_DATA);
DEF_STRUCT(EFI_TCP4_CLOSE_TOKEN);
DEF_STRUCT(EFI_IP4_MODE_DATA);
DEF_STRUCT(EFI_IP4_ICMP_TYPE);
DEF_STRUCT(EFI_IP4_CONFIG_DATA);
DEF_STRUCT(EFI_IP4_ROUTE_TABLE);
DEF_STRUCT(EFI_TCP6_PROTOCOL);
DEF_STRUCT(EFI_TCP6_ACCESS_POINT);
DEF_STRUCT(EFI_TCP6_OPTION);
DEF_STRUCT(EFI_TCP6_CONFIG_DATA);
DEF_STRUCT(EFI_TCP6_COMPLETION_TOKEN);
DEF_STRUCT(EFI_TCP6_CONNECTION_TOKEN);
DEF_STRUCT(EFI_TCP6_LISTEN_TOKEN);
DEF_STRUCT(EFI_TCP6_IO_TOKEN);
DEF_STRUCT(EFI_TCP6_RECEIVE_DATA);
DEF_STRUCT(EFI_TCP6_TRANSMIT_DATA);
DEF_STRUCT(EFI_TCP6_FRAGMENT_DATA);
DEF_STRUCT(EFI_TCP6_CLOSE_TOKEN);
DEF_STRUCT(EFI_IP6_ADDRESS_PAIR);
DEF_STRUCT(EFI_IP6_VARIABLE_DATA);
DEF_STRUCT(EFI_IP6_CONFIG_DATA);
DEF_STRUCT(EFI_IP6_ADDRESS_INFO);
DEF_STRUCT(EFI_IP6_ROUTE_TABLE);
DEF_STRUCT(EFI_IP6_NEIGHBOR_CACHE);
DEF_STRUCT(EFI_IP6_ICMP_TYPE);
DEF_STRUCT(EFI_IP6_MODE_DATA);
DEF_STRUCT(EFI_IP6_ADDRESS_PAIR);
DEF_STRUCT(EFI_IP4_PROTOCOL);
DEF_STRUCT(EFI_IP4_COMPLETION_TOKEN);
DEF_STRUCT(EFI_IP4_RECEIVE_DATA);
DEF_STRUCT(EFI_IP4_HEADER);
DEF_STRUCT(EFI_IP4_FRAGMENT_DATA);
DEF_STRUCT(EFI_IP4_TRANSMIT_DATA);
DEF_STRUCT(EFI_IP4_OVERRIDE_DATA);
DEF_STRUCT(EFI_IP4_CONFIG_PROTOCOL);
DEF_STRUCT(EFI_IP4_IPCONFIG_DATA);
DEF_STRUCT(EFI_IP4_CONFIG2_PROTOCOL);
DEF_STRUCT(EFI_IP4_CONFIG2_INTERFACE_INFO);
DEF_STRUCT(EFI_IP4_CONFIG2_MANUAL_ADDRESS);
DEF_STRUCT(EFI_IP6_PROTOCOL);
DEF_STRUCT(EFI_IP6_COMPLETION_TOKEN);
DEF_STRUCT(EFI_IP6_RECEIVE_DATA);
DEF_STRUCT(EFI_IP6_HEADER);
DEF_STRUCT(EFI_IP6_FRAGMENT_DATA);
DEF_STRUCT(EFI_IP6_TRANSMIT_DATA);
DEF_STRUCT(EFI_IP6_OVERRIDE_DATA);
DEF_STRUCT(EFI_IP6_CONFIG_PROTOCOL);
DEF_STRUCT(EFI_IP6_CONFIG_INTERFACE_INFO);
DEF_STRUCT(EFI_IP6_CONFIG_INTERFACE_ID);
DEF_STRUCT(EFI_IP6_CONFIG_DUP_ADDR_DETECT_TRANSMITS);
DEF_STRUCT(EFI_IP6_CONFIG_MANUAL_ADDRESS);
DEF_STRUCT(EFI_IPSEC_CONFIG_PROTOCOL);
DEF_STRUCT(EFI_IPSEC_SPD_SELECTOR);
DEF_STRUCT(EFI_IP_ADDRESS_INFO);
DEF_STRUCT(EFI_IPSEC_SPD_DATA);
DEF_STRUCT(EFI_IPSEC_PROCESS_POLICY);
DEF_STRUCT(EFI_IPSEC_PROTOCOL);
DEF_STRUCT(EFI_IPSEC2_PROTOCOL);
DEF_STRUCT(EFI_FTP4_PROTOCOL);
DEF_STRUCT(EFI_FTP4_COMMAND_TOKEN);
DEF_STRUCT(EFI_TLS_PROTOCOL);
DEF_STRUCT(EFI_TLS_CONFIGURATION_PROTOCOL);
DEF_STRUCT(EFI_ARP_PROTOCOL);
DEF_STRUCT(EFI_DHCP4_PROTOCOL);
DEF_STRUCT(EFI_DHCP6_PROTOCOL);
DEF_STRUCT(EFI_DNS4_PROTOCOL);
DEF_STRUCT(EFI_DNS6_PROTOCOL);
DEF_STRUCT(EFI_HTTP_PROTOCOL);
DEF_STRUCT(EFI_HTTP_UTILITIES_PROTOCOL);
DEF_STRUCT(EFI_REST_PROTOCOL);
DEF_STRUCT(EFI_UDP4_PROTOCOL);
DEF_STRUCT(EFI_UDP6_PROTOCOL);
DEF_STRUCT(EFI_MTFTP4_PROTOCOL);
DEF_STRUCT(EFI_MTFTP4_TOKEN);
DEF_STRUCT(EFI_MTFTP6_PROTOCOL);
DEF_STRUCT(EFI_MTFTP6_TOKEN);
DEF_STRUCT(EFI_AUTHENTICATION_INFO_PROTOCOL);
DEF_STRUCT(WIN_CERTIFICATE);
DEF_STRUCT(EFI_TIMESTAMP_PROTOCOL);

//Tables


struct EFI_TABLE_HEADER {
	UINT64 Signature;
	UINT32 Revision;
	UINT32 HeaderSize;
	UINT32 CRC32;
	UINT32 Reserved;
};

struct EFI_GUID {
	UINT32 Data1;
	UINT16 Data2;
	UINT16 Data3;
	UINT8 Data4[8];
};

struct EFI_CONFIGURATION_TABLE {
	EFI_GUID VendorGuid;
	VOID *VendorTable;
};


typedef VOID* EFI_HANDLE;

struct EFI_SYSTEM_TABLE {
	EFI_TABLE_HEADER Hdr;
	CHAR16 *FirmwareVendor;
	UINT32 FirmwareRevision;
	EFI_HANDLE ConsoleInHandle;
	EFI_SIMPLE_TEXT_INPUT_PROTOCOL *ConIn;
	EFI_HANDLE ConsoleOutHandle;
	EFI_SIMPLE_TEXT_OUTPUT_PROTOCOL *ConOut;
	EFI_HANDLE StandardErrorHandle;
	EFI_SIMPLE_TEXT_OUTPUT_PROTOCOL *StdErr;
	EFI_RUNTIME_SERVICES *RuntimeServices;
	EFI_BOOT_SERVICES *BootServices;
	UINTN NumberOfTableEntries;
	EFI_CONFIGURATION_TABLE *ConfigurationTable;
};

//Boot services

#define EVT_TIMER 0x80000000
#define EVT_RUNTIME 0x40000000
#define EVT_NOTIFY_WAIT 0x00000100
#define EVT_NOTIFY_SIGNAL 0x00000200
#define EVT_SIGNAL_EXIT_BOOT_SERVICES 0x00000201
#define EVT_SIGNAL_VIRTUAL_ADDRESS_CHANGE 0x60000202
#define EFI_EVENT_GROUP_EXIT_BOOT_SERVICES \
 {0x27abf055, 0xb1b8, 0x4c26, 0x80, 0x48, 0x74, 0x8f, 0x37,\
 0xba, 0xa2, 0xdf}}
#define EFI_EVENT_GROUP_VIRTUAL_ADDRESS_CHANGE \
 {0x13fa7698, 0xc831, 0x49c7, 0x87, 0xea, 0x8f, 0x43, 0xfc,\
 0xc2, 0x51, 0x96}
#define EFI_EVENT_GROUP_MEMORY_MAP_CHANGE \
 {0x78bee926, 0x692f, 0x48fd, 0x9e, 0xdb, 0x1, 0x42, 0x2e, \
 0xf0, 0xd7, 0xab}
#define EFI_EVENT_GROUP_READY_TO_BOOT \
 {0x7ce88fb3, 0x4bd7, 0x4679, 0x87, 0xa8, 0xa8, 0xd8, 0xde,\
 0xe5,0xd, 0x2b}

typedef enum {
	TimerCancel,
	TimerPeriodic,
	TimerRelative
} EFI_TIMER_DELAY;

typedef VOID* EFI_EVENT;
typedef UINTN EFI_TPL;

typedef VOID(EFIAPI *EFI_EVENT_NOTIFY)(IN EFI_EVENT Event, IN VOID* Context);
typedef EFI_STATUS(EFIAPI *EFI_CREATE_EVENT)(IN UINT32 Type, IN EFI_TPL NotifyTpl, IN EFI_EVENT_NOTIFY NotifyFunction OPTIONAL, IN CONST VOID* NotifyContext OPTIONAL, OUT EFI_EVENT);
typedef EFI_STATUS(EFIAPI *EFI_CREATE_EVENT_EX)(IN UINT32 Type, IN EFI_TPL NotifyTpl, IN EFI_EVENT_NOTIFY NotifyFunction OPTIONAL, IN CONST VOID* NotifyContext OPTIONAL, IN CONST EFI_GUID* EventGroup OPTIONAL, OUT EFI_EVENT);
typedef EFI_STATUS(EFIAPI *EFI_CLOSE_EVENT)(IN EFI_EVENT Event);
typedef EFI_STATUS(EFIAPI *EFI_SIGNAL_EVENT)(IN EFI_EVENT Event);
typedef EFI_STATUS(EFIAPI *EFI_WAIT_FOR_EVENT)(IN UINTN NumberOfEvents, IN EFI_EVENT* Event, OUT UINTN* Index);
typedef EFI_STATUS(EFIAPI *EFI_CHECK_EVENT)(IN EFI_EVENT Event);
typedef EFI_STATUS(EFIAPI *EFI_SET_TIMER)(IN EFI_EVENT Event, IN EFI_TIMER_DELAY Type, IN UINT64 TriggerTime);

#define TPL_APPLICATION 4
#define TPL_CALLBACK 8
#define TPL_NOTIFY 16
#define TPL_HIGH_LEVEL 31

typedef EFI_STATUS(EFIAPI *EFI_RAISE_TPL)(IN EFI_TPL NewTpl);
typedef EFI_STATUS(EFIAPI *EFI_RESTORE_TPL)(IN EFI_TPL OldTpl);

#define EFI_MEMORY_UC 0x0000000000000001
#define EFI_MEMORY_WC 0x0000000000000002
#define EFI_MEMORY_WT 0x0000000000000004
#define EFI_MEMORY_WB 0x0000000000000008
#define EFI_MEMORY_UCE 0x0000000000000010
#define EFI_MEMORY_WP 0x0000000000001000
#define EFI_MEMORY_RP 0x0000000000002000
#define EFI_MEMORY_XP 0x0000000000004000
#define EFI_MEMORY_NV 0x0000000000008000
#define EFI_MEMORY_MORE_RELIABLE 0x0000000000010000
#define EFI_MEMORY_RO 0x0000000000020000
#define EFI_MEMORY_RUNTIME 0x8000000000000000
#define EFI_MEMORY_DESCRIPTOR_VERSION 1

typedef UINT64 EFI_PHYSICAL_ADDRESS;
typedef UINT64 EFI_VIRTUAL_ADDRESS;

typedef enum {
	AllocateAnyPages,
	AllocateMaxAddress,
	AllocateAddress,
	MaxAllocateType
} EFI_ALLOCATE_TYPE;

typedef enum {
	EfiReservedMemoryType,
	EfiLoaderCode,
	EfiLoaderData,
	EfiBootServicesCode,
	EfiBootServicesData,
	EfiRuntimeServicesCode,
	EfiRuntimeServicesData,
	EfiConventionalMemory,
	EfiUnusableMemory,
	EfiACPIReclaimMemory,
	EfiACPIMemoryNVS,
	EfiMemoryMappedIO,
	EfiMemoryMappedIOPortSpace,
	EfiPalCode,
	EfiPersistentMemory,
	EfiMaxMemoryType
} EFI_MEMORY_TYPE;

struct EFI_MEMORY_DESCRIPTOR {
	UINT32 Type;
	EFI_PHYSICAL_ADDRESS PhysicalStart;
	EFI_VIRTUAL_ADDRESS VirtualStart;
	UINT64 NumberOfPages;
	UINT64 Attribute;
};

typedef EFI_STATUS(EFIAPI *EFI_ALLOCATE_PAGES)(IN EFI_ALLOCATE_TYPE Type, IN EFI_MEMORY_TYPE MemoryType, IN UINTN Pages, IN OUT EFI_PHYSICAL_ADDRESS* Memory);
typedef EFI_STATUS(EFIAPI *EFI_FREE_PAGES)(IN EFI_PHYSICAL_ADDRESS* Memory, IN UINTN pages);
typedef EFI_STATUS(EFIAPI *EFI_GET_MEMORY_MAP)(IN OUT UINTN* MemoryMapSize, IN OUT EFI_MEMORY_DESCRIPTOR* MemoryMap, OUT UINTN *MapKey, OUT UINTN* DescriptorSize, OUT UINT32* DescriptorVersion);
typedef EFI_STATUS(EFIAPI *EFI_ALLOCATE_POOL)(IN EFI_MEMORY_TYPE PoolType, IN UINTN Size, OUT VOID** Buffer);
typedef EFI_STATUS(EFIAPI *EFI_FREE_POOL)(IN VOID* Buffer);

#define EFI_OPEN_PROTOCOL_BY_HANDLE_PROTOCOL 0x00000001
#define EFI_OPEN_PROTOCOL_GET_PROTOCOL 0x00000002
#define EFI_OPEN_PROTOCOL_TEST_PROTOCOL 0x00000004
#define EFI_OPEN_PROTOCOL_BY_CHILD_CONTROLLER 0x00000008
#define EFI_OPEN_PROTOCOL_BY_DRIVER 0x00000010
#define EFI_OPEN_PROTOCOL_EXCLUSIVE 0x00000020

typedef enum {
	EFI_NATIVE_INTERFACE
} EFI_INTERFACE_TYPE;

typedef enum {
	AllHandles,
	ByRegisterNotify,
	ByProtocol
} EFI_LOCATE_SEARCH_TYPE;

struct EFI_OPEN_PROTOCOL_INFORMATION_ENTRY {
	EFI_HANDLE AgentHandle;
	EFI_HANDLE ControllerHandle;
	UINT32 Attributes;
	UINT32 OpenCount;
};

struct _EFI_DEVICE_PATH_PROTOCOL {
	UINT8 Type;
	UINT8 SubType;
	UINT8 Length[2];
};

typedef EFI_STATUS(EFIAPI *EFI_INSTALL_PROTOCOL_INTERFACE) ( IN OUT EFI_HANDLE *Handle, IN EFI_GUID *Protocol, IN EFI_INTERFACE_TYPE InterfaceType,	IN VOID *Interface);
typedef EFI_STATUS(EFIAPI *EFI_UNINSTALL_PROTOCOL_INTERFACE) (IN EFI_HANDLE Handle,	IN EFI_GUID *Protocol, IN VOID *Interface);
typedef EFI_STATUS(EFIAPI *EFI_REINSTALL_PROTOCOL_INTERFACE) (IN EFI_HANDLE Handle, IN EFI_GUID *Protocol, IN VOID *OldInterface, IN VOID *NewInterface);
typedef EFI_STATUS(EFIAPI *EFI_REGISTER_PROTOCOL_NOTIFY) (IN EFI_GUID *Protocol, IN EFI_EVENT Event, OUT VOID **Registration);
typedef EFI_STATUS(EFIAPI *EFI_LOCATE_HANDLE) (IN EFI_LOCATE_SEARCH_TYPE SearchType, IN EFI_GUID *Protocol OPTIONAL, IN VOID *SearchKey OPTIONAL, IN OUT UINTN *BufferSize,	OUT EFI_HANDLE *Buffer);
typedef EFI_STATUS(EFIAPI *EFI_HANDLE_PROTOCOL) (IN EFI_HANDLE Handle, IN EFI_GUID *Protocol, OUT VOID **Interface);
typedef EFI_STATUS(EFIAPI *EFI_LOCATE_DEVICE_PATH) (IN EFI_GUID *Protocol, IN OUT EFI_DEVICE_PATH_PROTOCOL **DevicePath, OUT EFI_HANDLE *Device);
typedef EFI_STATUS(EFIAPI *EFI_OPEN_PROTOCOL) (IN EFI_HANDLE Handle, IN EFI_GUID *Protocol, OUT VOID **Interface OPTIONAL, IN EFI_HANDLE AgentHandle, IN EFI_HANDLE ControllerHandle, IN UINT32 Attributes);
typedef EFI_STATUS(EFIAPI *EFI_CLOSE_PROTOCOL) (IN EFI_HANDLE Handle, IN EFI_GUID *Protocol, IN EFI_HANDLE AgentHandle, IN EFI_HANDLE ControllerHandle);
typedef EFI_STATUS(EFIAPI *EFI_OPEN_PROTOCOL_INFORMATION) (IN EFI_HANDLE Handle, IN EFI_GUID *Protocol, OUT EFI_OPEN_PROTOCOL_INFORMATION_ENTRY **EntryBuffer, OUT UINTN *EntryCount);
typedef EFI_STATUS(EFIAPI *EFI_CONNECT_CONTROLLER) (IN EFI_HANDLE ControllerHandle, IN EFI_HANDLE *DriverImageHandle OPTIONAL, IN EFI_DEVICE_PATH_PROTOCOL *RemainingDevicePath OPTIONAL, IN BOOLEAN Recursive);
typedef EFI_STATUS(EFIAPI *EFI_DISCONNECT_CONTROLLER) (IN EFI_HANDLE ControllerHandle, IN EFI_HANDLE DriverImageHandle OPTIONAL, IN EFI_HANDLE ChildHandle OPTIONAL);
typedef EFI_STATUS(EFIAPI *EFI_PROTOCOLS_PER_HANDLE) (IN EFI_HANDLE Handle, OUT EFI_GUID ***ProtocolBuffer, OUT UINTN *ProtocolBufferCount);
typedef EFI_STATUS(EFIAPI *EFI_LOCATE_HANDLE_BUFFER) (IN EFI_LOCATE_SEARCH_TYPE SearchType, IN EFI_GUID *Protocol OPTIONAL, IN VOID *SearchKey OPTIONAL, IN OUT UINTN *NoHandles, OUT EFI_HANDLE **Buffer);
typedef EFI_STATUS(EFIAPI *EFI_LOCATE_PROTOCOL) (IN EFI_GUID *Protocol, IN VOID *Registration OPTIONAL, OUT VOID **Interface);
typedef EFI_STATUS(EFIAPI *EFI_INSTALL_MULTIPLE_PROTOCOL_INTERFACES) (IN OUT EFI_HANDLE *Handle, ...);
typedef EFI_STATUS(EFIAPI *EFI_UNINSTALL_MULTIPLE_PROTOCOL_INTERFACES) (IN EFI_HANDLE Handle, ...);

#define EFI_HII_PACKAGE_LIST_PROTOCOL_GUID \
 { 0x6a1ee763, 0xd47a, 0x43b4, \
 { 0xaa, 0xbe, 0xef, 0x1d, 0xe2, 0xab, 0x56, 0xfc } }

#define EFI_ACPI_20_TABLE_GUID \
 {0x8868e871,0xe4f1,0x11d3,\
 {0xbc,0x22,0x00,0x80,0xc7,0x3c,0x88,0x81}}

#define ACPI_TABLE_GUID \
 {0xeb9d2d30,0x2d88,0x11d3,\
 {0x9a,0x16,0x00,0x90,0x27,0x3f,0xc1,0x4d}}

#define SAL_SYSTEM_TABLE_GUID \
 {0xeb9d2d32,0x2d88,0x11d3,\
 {0x9a,0x16,0x00,0x90,0x27,0x3f,0xc1,0x4d}}

#define SMBIOS_TABLE_GUID \
 {0xeb9d2d31,0x2d88,0x11d3,\
 {0x9a,0x16,0x00,0x90,0x27,0x3f,0xc1,0x4d}}

#define SMBIOS3_TABLE_GUID \
 {0xf2fd1544, 0x9794, 0x4a2c,\
 {0x99,0x2e,0xe5,0xbb,0xcf,0x20,0xe3,0x94})

#define MPS_TABLE_GUID \
 {0xeb9d2d2f,0x2d88,0x11d3,\
 {0x9a,0x16,0x00,0x90,0x27,0x3f,0xc1,0x4d}}
//
// ACPI 2.0 or newer tables should use EFI_ACPI_TABLE_GUID
//
#define EFI_ACPI_TABLE_GUID \
 {0x8868e871,0xe4f1,0x11d3,\
 {0xbc,0x22,0x00,0x80,0xc7,0x3c,0x88,0x81}}

#define ACPI_10_TABLE_GUID \
 {0xeb9d2d30,0x2d88,0x11d3,\
 {0x9a,0x16,0x00,0x90,0x27,0x3f,0xc1,0x4d}}

#define EFI_PROPERTIES_TABLE_GUID \
 {0x880aaca3, 0x4adc, 0x4a04,\
 {0x90,0x79,0xb7,0x47,0x34,0x8,0x25,0xe5}}

struct EFI_HII_PACKAGE_LIST_HEADER {
	EFI_GUID PackageListGuid;
	UINT32 PackagLength;
};

typedef EFI_HII_PACKAGE_LIST_HEADER *EFI_HII_PACKAGE_LIST_PROTOCOL;

typedef EFI_STATUS(EFIAPI *EFI_IMAGE_LOAD) (IN BOOLEAN BootPolicy, IN EFI_HANDLE ParentImageHandle, IN EFI_DEVICE_PATH_PROTOCOL *DevicePath, IN VOID *SourceBuffer OPTIONAL, IN UINTN SourceSize, OUT EFI_HANDLE *ImageHandle);
typedef EFI_STATUS(EFIAPI *EFI_IMAGE_START) (IN EFI_HANDLE ImageHandle, OUT UINTN *ExitDataSize, OUT CHAR16 **ExitData OPTIONAL);
typedef EFI_STATUS(EFIAPI *EFI_IMAGE_UNLOAD) (IN EFI_HANDLE ImageHandle);

typedef EFI_STATUS(EFIAPI *EFI_IMAGE_ENTRY_POINT) (IN EFI_HANDLE ImageHandle, IN EFI_SYSTEM_TABLE *SystemTable);
typedef EFI_STATUS(EFIAPI *EFI_EXIT) (IN EFI_HANDLE ImageHandle, IN EFI_STATUS ExitStatus, IN UINTN ExitDataSize, IN CHAR16 *ExitData OPTIONAL);
typedef EFI_STATUS(EFIAPI *EFI_EXIT_BOOT_SERVICES) (IN EFI_HANDLE ImageHandle, IN UINTN MapKey);
typedef EFI_STATUS(EFIAPI *EFI_SET_WATCHDOG_TIMER) (IN UINTN Timeout, IN UINT64 WatchdogCode, IN UINTN DataSize, IN CHAR16 *WatchdogData OPTIONAL);
typedef EFI_STATUS(EFIAPI *EFI_STALL) (IN UINTN Microseconds);

typedef VOID(EFIAPI *EFI_COPY_MEM) (IN VOID *Destination, IN VOID *Source, IN UINTN Length);
typedef VOID(EFIAPI *EFI_SET_MEM) (IN VOID *Buffer, IN UINTN Size, IN UINT8 Value);

typedef EFI_STATUS(EFIAPI *EFI_GET_NEXT_MONOTONIC_COUNT) (OUT UINT64 *Count);
typedef EFI_STATUS(EFIAPI *EFI_INSTALL_CONFIGURATION_TABLE) (IN EFI_GUID *Guid, IN VOID *Table);
typedef EFI_STATUS(EFIAPI *EFI_CALCULATE_CRC32)(IN VOID *Data, IN UINTN DataSize, OUT UINT32 *Crc32);

struct EFI_BOOT_SERVICES {
	EFI_TABLE_HEADER							Hdr;

	EFI_RAISE_TPL								RaiseTpl;
	EFI_RESTORE_TPL								RestoreTpl;

	EFI_ALLOCATE_PAGES							AllocatePages;
	EFI_FREE_PAGES								FreePages;
	EFI_GET_MEMORY_MAP							GetMemoryMap;
	EFI_ALLOCATE_POOL							AllocatePool;
	EFI_FREE_POOL								FreePool;

	EFI_CREATE_EVENT							CreateEvent;
	EFI_SET_TIMER								SetTimer;
	EFI_WAIT_FOR_EVENT							WaitForEvent;
	EFI_SIGNAL_EVENT							SignalEvent;
	EFI_CLOSE_EVENT								CloseEvenet;
	EFI_CHECK_EVENT								CheckEvent;

	EFI_INSTALL_PROTOCOL_INTERFACE				InstallProtocolInterface; 
	EFI_REINSTALL_PROTOCOL_INTERFACE			ReinstallProtocolInterface;
	EFI_UNINSTALL_PROTOCOL_INTERFACE			UninstallProtocolInterface;

	EFI_HANDLE_PROTOCOL							HandleProtocol;
	VOID*										Reserved; 
	EFI_REGISTER_PROTOCOL_NOTIFY				RegisterProtocolNotify;
	EFI_LOCATE_HANDLE							LocateHandle; 
	EFI_LOCATE_DEVICE_PATH						LocateDevicePath; 
	EFI_INSTALL_CONFIGURATION_TABLE				InstallConfigurationTable; 


	EFI_IMAGE_LOAD								LoadImage; 
	EFI_IMAGE_START								StartImage; 
	EFI_EXIT									Exit; 
	EFI_IMAGE_UNLOAD							UnloadImage; 
	EFI_EXIT_BOOT_SERVICES						ExitBootServices; 
												 
												 
												 
	EFI_GET_NEXT_MONOTONIC_COUNT				GetNextMonotonicCount; 
	EFI_STALL									Stall;
	EFI_SET_WATCHDOG_TIMER						SetWatchdogTimer; 
												 
												 
												 
	EFI_CONNECT_CONTROLLER						ConnectController;
	EFI_DISCONNECT_CONTROLLER					DisconnectController;
														

									
	EFI_OPEN_PROTOCOL							OpenProtocol; 
	EFI_CLOSE_PROTOCOL							CloseProtocol;

	EFI_OPEN_PROTOCOL_INFORMATION				OpenProtocolInformation; 
	EFI_PROTOCOLS_PER_HANDLE					ProtocolsPerHandle; 
	EFI_LOCATE_HANDLE_BUFFER					LocateHandleBuffer; 
	EFI_LOCATE_PROTOCOL							LocateProtocol; 
	EFI_INSTALL_MULTIPLE_PROTOCOL_INTERFACES	InstallMultipleProtocolInterfaces;
	EFI_UNINSTALL_MULTIPLE_PROTOCOL_INTERFACES	UninstallMultipleProtocolInterfaces;
	EFI_CALCULATE_CRC32							CalculateCrc32; 

	
	EFI_COPY_MEM								CopyMem;
	EFI_SET_MEM									SetMem; 
	EFI_CREATE_EVENT_EX							CreateEventEx;

};


//Runtim Services

#define EFI_VARIABLE_NON_VOLATILE 0x00000001
#define EFI_VARIABLE_BOOTSERVICE_ACCESS 0x00000002
#define EFI_VARIABLE_RUNTIME_ACCESS 0x00000004
#define EFI_VARIABLE_HARDWARE_ERROR_RECORD 0x00000008 
#define EFI_VARIABLE_AUTHENTICATED_WRITE_ACCESS 0x00000010
#define EFI_VARIABLE_TIME_BASED_AUTHENTICATED_WRITE_ACCESS 0x00000020
#define EFI_VARIABLE_APPEND_WRITE 0x00000040


typedef EFI_STATUS(EFIAPI *EFI_GET_VARIABLE)(IN CHAR16 *VariableName, IN EFI_GUID *VendorGuid, OUT UINT32 *Attributes OPTIONAL, IN OUT UINTN *DataSize, OUT VOID *Data OPTIONAL);
typedef EFI_STATUS(EFIAPI *EFI_GET_NEXT_VARIABLE_NAME)(IN OUT UINTN *VariableNameSize, IN OUT CHAR16 *VariableName, IN OUT EFI_GUID *VendorGuid);
typedef EFI_STATUS(EFIAPI *EFI_SET_VARIABLE)(IN CHAR16 *VariableName, IN EFI_GUID *VendorGuid, IN UINT32 Attributes, IN UINTN DataSize, IN VOID *Data);
typedef EFI_STATUS(EFIAPI *EFI_QUERY_VARIABLE_INFO)(IN UINT32 Attributes, OUT UINT64 *MaximumVariableStorageSize, OUT UINT64 *RemainingVariableStorageSize, OUT UINT64 *MaximumVariableSize);

#define EFI_TIME_ADJUST_DAYLIGHT 0x01
#define EFI_TIME_IN_DAYLIGHT 0x02
#define EFI_UNSPECIFIED_TIMEZONE 0x07FF

struct EFI_TIME{
	UINT16 Year;
	UINT8 Month;
	UINT8 Day;
	UINT8 Hour;
	UINT8 Minute;
	UINT8 Second;
	UINT8 Pad1;
	UINT32 Nanosecond;
	INT16 TimeZone;
	UINT8 Daylight;
	UINT8 Pad2;
};

struct EFI_TIME_CAPABILITIES {
	UINT32 Resolution;
	UINT32 Accuracy;
	BOOLEAN SetsToZero;
};

struct WIN_CERTIFICATE {
	UINT32 dwLength;
	UINT16 wRevision;
	UINT16 wCertificateType;
	//UINT8 bCertificate[ANYSIZE_ARRAY];
};

struct WIN_CERTIFICATE_UEFI_GUID {
	WIN_CERTIFICATE Hdr;
	EFI_GUID CertType;
	UINT8 CertData[];
};

struct EFI_VARIABLE_AUTHENTICATION {
	UINT64 MonotonicCount;
	WIN_CERTIFICATE_UEFI_GUID AuthInfo;
};

struct EFI_VARIABLE_AUTHENTICATION_2 {
	EFI_TIME TimeStamp;
	WIN_CERTIFICATE_UEFI_GUID AuthInfo;
};


typedef EFI_STATUS(EFIAPI *EFI_GET_TIME)(OUT EFI_TIME *Time, OUT EFI_TIME_CAPABILITIES *Capabilities OPTIONAL);
typedef EFI_STATUS(EFIAPI *EFI_SET_TIME)(IN EFI_TIME *Time);
typedef EFI_STATUS(EFIAPI *EFI_GET_WAKEUP_TIME)(OUT BOOLEAN *Enabled, OUT BOOLEAN *Pending, OUT EFI_TIME *Time);
typedef EFI_STATUS(EFIAPI *EFI_SET_WAKEUP_TIME)(IN BOOLEAN Enable, IN EFI_TIME *Time OPTIONAL);

#define EFI_OPTIONAL_PTR 0x00000001

typedef EFI_STATUS(EFIAPI *EFI_SET_VIRTUAL_ADDRESS_MAP)(IN UINTN MemoryMapSize, IN UINTN DescriptorSize, IN UINT32 DescriptorVersion, IN EFI_MEMORY_DESCRIPTOR *VirtualMap);
typedef EFI_STATUS(EFIAPI *EFI_CONVERT_POINTER)(IN UINTN DebugDisposition, IN VOID **Address);

typedef enum {
	EfiResetCold,
	EfiResetWarm,
	EfiResetShutdown,
	EfiResetPlatformSpecific
} EFI_RESET_TYPE;

typedef VOID(EFIAPI *EFI_RESET_SYSTEM)(IN EFI_RESET_TYPE ResetType, IN EFI_STATUS ResetStatus, IN UINTN DataSize, IN VOID *ResetData OPTIONAL);
typedef EFI_STATUS(EFIAPI *EFI_GET_NEXT_HIGH_MONO_COUNT)(OUT UINT32 *HighCount);

#define CAPSULE_FLAGS_PERSIST_ACROSS_RESET 0x00010000
#define CAPSULE_FLAGS_POPULATE_SYSTEM_TABLE 0x00020000
#define CAPSULE_FLAGS_INITIATE_RESET 0x00040000

#define EFI_OS_INDICATIONS_BOOT_TO_FW_UI 0x0000000000000001
#define EFI_OS_INDICATIONS_TIMESTAMP_REVOCATION 0x0000000000000002
#define EFI_OS_INDICATIONS_FILE_CAPSULE_DELIVERY_SUPPORTED 0x0000000000000004
#define EFI_OS_INDICATIONS_FMP_CAPSULE_SUPPORTED 0x0000000000000008
#define EFI_OS_INDICATIONS_CAPSULE_RESULT_VAR_SUPPORTED 0x0000000000000010
#define EFI_OS_INDICATIONS_START_OS_RECOVERY 0x0000000000000020
#define EFI_OS_INDICATIONS_START_PLATFORM_RECOVERY 0x0000000000000040

struct EFI_CAPSULE_BLOCK_DESCRIPTOR {
	UINT64 Length;
	union {
		EFI_PHYSICAL_ADDRESS DataBlock;
		EFI_PHYSICAL_ADDRESS ContinuationPointer;
	}Union;
};

struct EFI_CAPSULE_HEADER {
	EFI_GUID CapsuleGuid;
	UINT32 HeaderSize;
	UINT32 Flags;
	UINT32 CapsuleImageSize;
};

typedef EFI_STATUS(EFIAPI *EFI_UPDATE_CAPSULE)(IN EFI_CAPSULE_HEADER **CapsuleHeaderArray, IN UINTN CapsuleCount, IN EFI_PHYSICAL_ADDRESS ScatterGatherList OPTIONAL);
typedef EFI_STATUS(EFIAPI *EFI_QUERY_CAPSULE_CAPABILITIES)(IN EFI_CAPSULE_HEADER **CapsuleHeaderArray, IN UINTN CapsuleCount, OUT UINT64 *MaximumCapsuleSize, OUT EFI_RESET_TYPE *ResetType);

 struct EFI_RUNTIME_SERVICES {
	EFI_TABLE_HEADER Hdr;
	
	EFI_GET_TIME GetTime;
	EFI_SET_TIME SetTime;
	EFI_GET_WAKEUP_TIME GetWakeupTime;
	EFI_SET_WAKEUP_TIME SetWakeupTime;

	EFI_SET_VIRTUAL_ADDRESS_MAP SetVirtualAddressMap;
	EFI_CONVERT_POINTER ConvertPointer;
	
	EFI_GET_VARIABLE GetVariable;
	EFI_GET_NEXT_VARIABLE_NAME GetNextVariableName;
	EFI_SET_VARIABLE SetVariable;
	
	EFI_GET_NEXT_HIGH_MONO_COUNT GetNextHighMonotonicCount;
	EFI_RESET_SYSTEM ResetSystem;
	
	EFI_UPDATE_CAPSULE UpdateCapsule;
	EFI_QUERY_CAPSULE_CAPABILITIES QueryCapsuleCapabilities;

	EFI_QUERY_VARIABLE_INFO QueryVariableInfo;
};

//Loaded Image

#define EFI_LOADED_IMAGE_PROTOCOL_REVISION 0x1000

#define EFI_LOADED_IMAGE_PROTOCOL_GUID\
 {0x5B1B31A1,0x9562,0x11d2,\
 {0x8E,0x3F,0x00,0xA0,0xC9,0x69,0x72,0x3B}}

#define EFI_DEVICE_PATH_PROTOCOL_GUID \
 {0x09576e91,0x6d3f,0x11d2,\
 {0x8e,0x39,0x00,0xa0,0xc9,0x69,0x72,0x3b}}

struct EFI_LOADED_IMAGE_PROTOCOL {
	UINT32 Revision;
	EFI_HANDLE ParentHandle;
	EFI_SYSTEM_TABLE *SystemTable;
	
	EFI_HANDLE DeviceHandle;
	EFI_DEVICE_PATH_PROTOCOL *FilePath;
	VOID *Reserved;

	UINT32 LoadOptionsSize;
	VOID *LoadOptions;
	
	VOID *ImageBase;
	UINT64 ImageSize;
	EFI_MEMORY_TYPE ImageCodeType;
	EFI_MEMORY_TYPE ImageDataType;
	EFI_IMAGE_UNLOAD Unload;
};

//Text IO

#define EFI_SIMPLE_TEXT_INPUT_PROTOCOL_GUID \
{0x387477c1,0x69c7,0x11d2,\
 {0x8e,0x39,0x00,0xa0,0xc9,0x69,0x72,0x3b}}

struct EFI_INPUT_KEY {
	UINT16 ScanCode;
	CHAR16 UnicodeChar;
};

typedef EFI_STATUS(EFIAPI *EFI_INPUT_RESET) (IN EFI_SIMPLE_TEXT_INPUT_PROTOCOL *This, IN BOOLEAN ExtendedVerification);
typedef EFI_STATUS(EFIAPI *EFI_INPUT_READ_KEY) (IN EFI_SIMPLE_TEXT_INPUT_PROTOCOL *This, OUT EFI_INPUT_KEY *Key);

struct EFI_SIMPLE_TEXT_INPUT_PROTOCOL {
	EFI_INPUT_RESET Reset;
	EFI_INPUT_READ_KEY ReadKeyStroke;
	EFI_EVENT WaitForKey;
};

#define EFI_SIMPLE_TEXT_INPUT_EX_PROTOCOL_GUID \
 {0xdd9e7534, 0x7762, 0x4698, \
 {0x8c, 0x14, 0xf5, 0x85, 0x17, 0xa6, 0x25, 0xaa}}

#define EFI_SHIFT_STATE_VALID 0x80000000
#define EFI_RIGHT_SHIFT_PRESSED 0x00000001
#define EFI_LEFT_SHIFT_PRESSED 0x00000002
#define EFI_RIGHT_CONTROL_PRESSED 0x00000004
#define EFI_LEFT_CONTROL_PRESSED 0x00000008
#define EFI_RIGHT_ALT_PRESSED 0x00000010
#define EFI_LEFT_ALT_PRESSED 0x00000020
#define EFI_RIGHT_LOGO_PRESSED 0x00000040
#define EFI_LEFT_LOGO_PRESSED 0x00000080
#define EFI_MENU_KEY_PRESSED 0x00000100
#define EFI_SYS_REQ_PRESSED 0x00000200

#define EFI_TOGGLE_STATE_VALID 0x80
#define EFI_KEY_STATE_EXPOSED 0x40
#define EFI_SCROLL_LOCK_ACTIVE 0x01
#define EFI_NUM_LOCK_ACTIVE 0x02
#define EFI_CAPS_LOCK_ACTIVE 0x04

typedef UINT8 EFI_KEY_TOGGLE_STATE;

struct EFI_KEY_STATE {
	UINT32 KeyShiftState;
	EFI_KEY_TOGGLE_STATE KeyToggleState;
};

struct EFI_KEY_DATA {
	EFI_INPUT_KEY Key;
	EFI_KEY_STATE KeyState;
};

struct SIMPLE_TEXT_OUTPUT_MODE {
	INT32 MaxMode;
	INT32 Mode;
	INT32 Attribute;
	INT32 CursorColumn;
	INT32 CursorRow;
	BOOLEAN CursorVisible;
};

typedef EFI_STATUS(EFIAPI *EFI_KEY_NOTIFY_FUNCTION) (IN EFI_KEY_DATA *KeyData);
typedef EFI_STATUS(EFIAPI *EFI_INPUT_RESET_EX) (IN EFI_SIMPLE_TEXT_INPUT_EX_PROTOCOL *This, IN BOOLEAN ExtendedVerification);
typedef EFI_STATUS(EFIAPI *EFI_INPUT_READ_KEY_EX) (IN EFI_SIMPLE_TEXT_INPUT_EX_PROTOCOL *This, OUT EFI_KEY_DATA *KeyData);
typedef EFI_STATUS(EFIAPI *EFI_SET_STATE) (IN EFI_SIMPLE_TEXT_INPUT_EX_PROTOCOL *This, IN EFI_KEY_TOGGLE_STATE *KeyToggleState);
typedef EFI_STATUS(EFIAPI *EFI_REGISTER_KEYSTROKE_NOTIFY) (IN EFI_SIMPLE_TEXT_INPUT_EX_PROTOCOL *This, IN EFI_KEY_DATA *KeyData, IN EFI_KEY_NOTIFY_FUNCTION KeyNotificationFunction, OUT VOID **NotifyHandle);
typedef EFI_STATUS(EFIAPI *EFI_UNREGISTER_KEYSTROKE_NOTIFY) (IN EFI_SIMPLE_TEXT_INPUT_EX_PROTOCOL *This, IN VOID *NotificationHandle);

struct EFI_SIMPLE_TEXT_INPUT_EX_PROTOCOL {
	EFI_INPUT_RESET_EX Reset;
	EFI_INPUT_READ_KEY_EX ReadKeyStrokeEx;
	EFI_EVENT WaitForKeyEx;
	EFI_SET_STATE SetState;
	EFI_REGISTER_KEYSTROKE_NOTIFY RegisterKeyNotify;
	EFI_UNREGISTER_KEYSTROKE_NOTIFY UnregisterKeyNotify;
};

#define EFI_SIMPLE_TEXT_OUTPUT_PROTOCOL_GUID \
 {0x387477c2,0x69c7,0x11d2,\
 {0x8e,0x39,0x00,0xa0,0xc9,0x69,0x72,0x3b}}

#define BOXDRAW_HORIZONTAL 0x2500
#define BOXDRAW_VERTICAL 0x2502
#define BOXDRAW_DOWN_RIGHT 0x250c
#define BOXDRAW_DOWN_LEFT 0x2510
#define BOXDRAW_UP_RIGHT 0x2514
#define BOXDRAW_UP_LEFT 0x2518
#define BOXDRAW_VERTICAL_RIGHT 0x251c
#define BOXDRAW_VERTICAL_LEFT 0x2524
#define BOXDRAW_DOWN_HORIZONTAL 0x252c
#define BOXDRAW_UP_HORIZONTAL 0x2534
#define BOXDRAW_VERTICAL_HORIZONTAL 0x253c
#define BOXDRAW_DOUBLE_HORIZONTAL 0x2550
#define BOXDRAW_DOUBLE_VERTICAL 0x2551
#define BOXDRAW_DOWN_RIGHT_DOUBLE 0x2552
#define BOXDRAW_DOWN_DOUBLE_RIGHT 0x2553
#define BOXDRAW_DOUBLE_DOWN_RIGHT 0x2554
#define BOXDRAW_DOWN_LEFT_DOUBLE 0x2555
#define BOXDRAW_DOWN_DOUBLE_LEFT 0x2556
#define BOXDRAW_DOUBLE_DOWN_LEFT 0x2557
#define BOXDRAW_UP_RIGHT_DOUBLE 0x2558
#define BOXDRAW_UP_DOUBLE_RIGHT 0x2559
#define BOXDRAW_DOUBLE_UP_RIGHT 0x255a
#define BOXDRAW_UP_LEFT_DOUBLE 0x255b
#define BOXDRAW_UP_DOUBLE_LEFT 0x255c
#define BOXDRAW_DOUBLE_UP_LEFT 0x255d
#define BOXDRAW_VERTICAL_RIGHT_DOUBLE 0x255e
#define BOXDRAW_VERTICAL_DOUBLE_RIGHT 0x255f
#define BOXDRAW_DOUBLE_VERTICAL_RIGHT 0x2560
#define BOXDRAW_VERTICAL_LEFT_DOUBLE 0x2561
#define BOXDRAW_VERTICAL_DOUBLE_LEFT 0x2562
#define BOXDRAW_DOUBLE_VERTICAL_LEFT 0x2563
#define BOXDRAW_DOWN_HORIZONTAL_DOUBLE 0x2564
#define BOXDRAW_DOWN_DOUBLE_HORIZONTAL 0x2565
#define BOXDRAW_DOUBLE_DOWN_HORIZONTAL 0x2566
#define BOXDRAW_UP_HORIZONTAL_DOUBLE 0x2567
#define BOXDRAW_UP_DOUBLE_HORIZONTAL 0x2568
#define BOXDRAW_DOUBLE_UP_HORIZONTAL 0x2569
#define BOXDRAW_VERTICAL_HORIZONTAL_DOUBLE 0x256a
#define BOXDRAW_VERTICAL_DOUBLE_HORIZONTAL 0x256b
#define BOXDRAW_DOUBLE_VERTICAL_HORIZONTAL 0x256c
#define BLOCKELEMENT_FULL_BLOCK 0x2588
#define BLOCKELEMENT_LIGHT_SHADE 0x2591
#define GEOMETRICSHAPE_UP_TRIANGLE 0x25b2
#define GEOMETRICSHAPE_RIGHT_TRIANGLE 0x25ba
#define GEOMETRICSHAPE_DOWN_TRIANGLE 0x25bc
#define GEOMETRICSHAPE_LEFT_TRIANGLE 0x25c4
#define ARROW_UP 0x2191
#define ARROW_DOWN 0x2193

typedef EFI_STATUS(EFIAPI *EFI_TEXT_RESET) (IN EFI_SIMPLE_TEXT_OUTPUT_PROTOCOL *This, IN BOOLEAN ExtendedVerification);
typedef EFI_STATUS(EFIAPI *EFI_TEXT_STRING) (IN EFI_SIMPLE_TEXT_OUTPUT_PROTOCOL *This, IN CHAR16 *String);
typedef EFI_STATUS(EFIAPI *EFI_TEXT_TEST_STRING) (IN EFI_SIMPLE_TEXT_OUTPUT_PROTOCOL *This, IN CHAR16 *String);
typedef EFI_STATUS(EFIAPI *EFI_TEXT_QUERY_MODE) (IN EFI_SIMPLE_TEXT_OUTPUT_PROTOCOL *This, IN UINTN ModeNumber, OUT UINTN *Columns, OUT UINTN *Rows);
typedef EFI_STATUS(EFIAPI *EFI_TEXT_SET_MODE) (IN EFI_SIMPLE_TEXT_OUTPUT_PROTOCOL *This, IN UINTN ModeNumber);


#define EFI_BLACK 0x00
#define EFI_BLUE 0x01
#define EFI_GREEN 0x02
#define EFI_CYAN 0x03
#define EFI_RED 0x04
#define EFI_MAGENTA 0x05
#define EFI_BROWN 0x06
#define EFI_LIGHTGRAY 0x07
#define EFI_BRIGHT 0x08
#define EFI_DARKGRAY (EFI_BLACK | EFI_BRIGHT) 
#define EFI_LIGHTBLUE 0x09
#define EFI_LIGHTGREEN 0x0A
#define EFI_LIGHTCYAN 0x0B
#define EFI_LIGHTRED 0x0C
#define EFI_LIGHTMAGENTA 0x0D
#define EFI_YELLOW 0x0E
#define EFI_WHITE 0x0F
#define EFI_BACKGROUND_BLACK 0x00
#define EFI_BACKGROUND_BLUE 0x10
#define EFI_BACKGROUND_GREEN 0x20
#define EFI_BACKGROUND_CYAN 0x30
#define EFI_BACKGROUND_RED 0x40
#define EFI_BACKGROUND_MAGENTA 0x50
#define EFI_BACKGROUND_BROWN 0x60
#define EFI_BACKGROUND_LIGHTGRAY 0x70

#define EFI_TEXT_ATTR(Foreground,Background) ((Foreground) | ((Background) << 4))

typedef EFI_STATUS(EFIAPI *EFI_TEXT_SET_ATTRIBUTE) (IN EFI_SIMPLE_TEXT_OUTPUT_PROTOCOL *This, IN UINTN Attribute);
typedef EFI_STATUS(EFIAPI *EFI_TEXT_CLEAR_SCREEN) (IN EFI_SIMPLE_TEXT_OUTPUT_PROTOCOL *This);
typedef EFI_STATUS(EFIAPI *EFI_TEXT_SET_CURSOR_POSITION) (IN EFI_SIMPLE_TEXT_OUTPUT_PROTOCOL *This, IN UINTN Column, IN UINTN Row);
typedef EFI_STATUS(EFIAPI *EFI_TEXT_ENABLE_CURSOR) (IN EFI_SIMPLE_TEXT_OUTPUT_PROTOCOL *This, IN BOOLEAN Visible);


struct EFI_SIMPLE_TEXT_OUTPUT_PROTOCOL {
	EFI_TEXT_RESET Reset;
	EFI_TEXT_STRING OutputString;
	EFI_TEXT_TEST_STRING TestString;
	EFI_TEXT_QUERY_MODE QueryMode;
	EFI_TEXT_SET_MODE SetMode;
	EFI_TEXT_SET_ATTRIBUTE SetAttribute;
	EFI_TEXT_CLEAR_SCREEN ClearScreen;
	EFI_TEXT_SET_CURSOR_POSITION SetCursorPosition;
	EFI_TEXT_ENABLE_CURSOR EnableCursor;
	SIMPLE_TEXT_OUTPUT_MODE *Mode;
};

#define EFI_SIMPLE_POINTER_PROTOCOL_GUID \
 {0x31878c87,0xb75,0x11d5,\
 {0x9a,0x4f,0x00,0x90,0x27,0x3f,0xc1,0x4d}}

struct EFI_SIMPLE_POINTER_MODE {
	UINT64 ResolutionX;
	UINT64 ResolutionY;
	UINT64 ResolutionZ;
	BOOLEAN LeftButton;
	BOOLEAN RightButton;
};

struct EFI_SIMPLE_POINTER_STATE {
	INT32 RelativeMovementX;
	INT32 RelativeMovementY;
	INT32 RelativeMovementZ;
	BOOLEAN LeftButton;
	BOOLEAN RightButton;
};

typedef EFI_STATUS(EFIAPI *EFI_SIMPLE_POINTER_RESET) (IN EFI_SIMPLE_POINTER_PROTOCOL *This, IN BOOLEAN ExtendedVerification);
typedef EFI_STATUS(EFIAPI *EFI_SIMPLE_POINTER_GET_STATE)(IN EFI_SIMPLE_POINTER_PROTOCOL *This, IN OUT EFI_SIMPLE_POINTER_STATE *State);

struct EFI_SIMPLE_POINTER_PROTOCOL {
	EFI_SIMPLE_POINTER_RESET Reset;
	EFI_SIMPLE_POINTER_GET_STATE GetState;
	EFI_EVENT WaitForInput;
	EFI_SIMPLE_POINTER_MODE *Mode;
};

#define EFI_ABSOLUTE_POINTER_PROTOCOL_GUID \
 {0x8D59D32B, 0xC655, 0x4AE9, \
 {0x9B, 0x15, 0xF2, 0x59, 0x04, 0x99, 0x2A, 0x43}} 

#define EFI_ABSP_SupportsAltActive 0x00000001
#define EFI_ABSP_SupportsPressureAsZ 0x00000002


#define EFI_ABSP_TouchActive 0x00000001
#define EFI_ABS_AltActive 0x00000002

struct EFI_ABSOLUTE_POINTER_MODE {
	UINT64 AbsoluteMinX;
	UINT64 AbsoluteMinY;
	UINT64 AbsoluteMinZ;
	UINT64 AbsoluteMaxX;
	UINT64 AbsoluteMaxY;
	UINT64 AbsoluteMaxZ;
	UINT32 Attributes;
};

typedef EFI_STATUS(EFIAPI *EFI_ABSOLUTE_POINTER_RESET) (IN EFI_ABSOLUTE_POINTER_PROTOCOL *This, IN BOOLEAN ExtendedVerification);
typedef EFI_STATUS(EFIAPI *EFI_ABSOLUTE_POINTER_GET_STATE) (IN EFI_ABSOLUTE_POINTER_PROTOCOL *This, IN OUT EFI_ABSOLUTE_POINTER_MODE *State);
struct EFI_ABSOLUTE_POINTER_PROTOCOL {	EFI_ABSOLUTE_POINTER_RESET Reset;	EFI_ABSOLUTE_POINTER_GET_STATE GetState;	EFI_EVENT Event;	EFI_ABSOLUTE_POINTER_MODE* Mode;};
#define EFI_SERIAL_IO_PROTOCOL_GUID \
 {0xBB25CF6F,0xF1D4,0x11D2,\
 {0x9a,0x0c,0x00,0x90,0x27,0x3f,0xc1,0xfd}}

#define EFI_SERIAL_IO_PROTOCOL_REVISION 0x00010000
#define EFI_SERIAL_CLEAR_TO_SEND 0x0010
#define EFI_SERIAL_DATA_SET_READY 0x0020
#define EFI_SERIAL_RING_INDICATE 0x0040
#define EFI_SERIAL_CARRIER_DETECT 0x0080
#define EFI_SERIAL_REQUEST_TO_SEND 0x0002
#define EFI_SERIAL_DATA_TERMINAL_READY 0x0001
#define EFI_SERIAL_INPUT_BUFFER_EMPTY 0x0100
#define EFI_SERIAL_OUTPUT_BUFFER_EMPTY 0x0200
#define EFI_SERIAL_HARDWARE_LOOPBACK_ENABLE 0x1000
#define EFI_SERIAL_SOFTWARE_LOOPBACK_ENABLE 0x2000
#define EFI_SERIAL_HARDWARE_FLOW_CONTROL_ENABLE 0x4000

#define EFI_SERIAL_CLEAR_TO_SEND 0x0010
#define EFI_SERIAL_DATA_SET_READY 0x0020
#define EFI_SERIAL_RING_INDICATE 0x0040
#define EFI_SERIAL_CARRIER_DETECT 0x0080
#define EFI_SERIAL_REQUEST_TO_SEND 0x0002
#define EFI_SERIAL_DATA_TERMINAL_READY 0x0001
#define EFI_SERIAL_INPUT_BUFFER_EMPTY 0x0100
#define EFI_SERIAL_OUTPUT_BUFFER_EMPTY 0x0200
#define EFI_SERIAL_HARDWARE_LOOPBACK_ENABLE 0x1000
#define EFI_SERIAL_SOFTWARE_LOOPBACK_ENABLE 0x2000
#define EFI_SERIAL_HARDWARE_FLOW_CONTROL_ENABLE 0x4000

struct SERIAL_IO_MODE {
	UINT32 ControlMask;
	UINT32 Timeout;
	UINT64 BaudRate;
	UINT32 ReceiveFifoDepth;
	UINT32 DataBits;
	UINT32 Parity;
	UINT32 StopBits;
};

typedef enum {
	DefaultParity,
	NoParity,
	EvenParity,
	OddParity,
	MarkParity,
	SpaceParity
} EFI_PARITY_TYPE;

typedef enum {
	DefaultStopBits,
	OneStopBit, 
	OneFiveStopBits,
	TwoStopBits 
} EFI_STOP_BITS_TYPE;

typedef EFI_STATUS(EFIAPI *EFI_SERIAL_RESET) (IN EFI_SERIAL_IO_PROTOCOL *This);
typedef EFI_STATUS(EFIAPI *EFI_SERIAL_SET_ATTRIBUTES) (IN EFI_SERIAL_IO_PROTOCOL *This, IN UINT64 BaudRate, IN UINT32 ReceiveFifoDepth, IN UINT32 Timeout, IN EFI_PARITY_TYPE Parity, IN UINT8 DataBits, IN EFI_STOP_BITS_TYPE StopBits);
typedef EFI_STATUS(EFIAPI *EFI_SERIAL_SET_CONTROL_BITS) (IN EFI_SERIAL_IO_PROTOCOL *This, IN UINT32 Control);
typedef EFI_STATUS(EFIAPI *EFI_SERIAL_GET_CONTROL_BITS) (IN EFI_SERIAL_IO_PROTOCOL *This, OUT UINT32 *Control);
typedef EFI_STATUS(EFIAPI *EFI_SERIAL_WRITE) (IN EFI_SERIAL_IO_PROTOCOL *This, IN OUT UINTN *BufferSize, IN VOID *Buffer);
typedef EFI_STATUS(EFIAPI *EFI_SERIAL_READ) (IN EFI_SERIAL_IO_PROTOCOL *This, IN OUT UINTN *BufferSize, OUT VOID *Buffer);

struct EFI_SERIAL_IO_PROTOCOL {
	UINT32 Revision;
	EFI_SERIAL_RESET Reset;
	EFI_SERIAL_SET_ATTRIBUTES SetAttributes;
	EFI_SERIAL_SET_CONTROL_BITS SetControl;
	EFI_SERIAL_GET_CONTROL_BITS GetControl;
	EFI_SERIAL_WRITE Write;
	EFI_SERIAL_READ Read;
	SERIAL_IO_MODE *Mode;
};

#define EFI_GRAPHICS_OUTPUT_PROTOCOL_GUID \
 {0x9042a9de,0x23dc,0x4a38,\
 {0x96,0xfb,0x7a,0xde,0xd0,0x80,0x51,0x6a}} 

struct EFI_PIXEL_BITMASK {
	UINT32 RedMask;
	UINT32 GreenMask;
	UINT32 BlueMask;
	UINT32 ReservedMask;
};

typedef enum {
	PixelRedGreenBlueReserved8BitPerColor,
	PixelBlueGreenRedReserved8BitPerColor,
	PixelBitMask,
	PixelBltOnly,
	PixelFormatMax
} EFI_GRAPHICS_PIXEL_FORMAT;

struct EFI_GRAPHICS_OUTPUT_MODE_INFORMATION {
	UINT32 Version;
	UINT32 HorizontalResolution;
	UINT32 VerticalResolution;
	EFI_GRAPHICS_PIXEL_FORMAT PixelFormat;
	EFI_PIXEL_BITMASK PixelInformation;
	UINT32 PixelsPerScanLine;
};

struct EFI_GRAPHICS_OUTPUT_PROTOCOL_MODE {
	UINT32 MaxMode;
	UINT32 Mode;
	EFI_GRAPHICS_OUTPUT_MODE_INFORMATION *Info;
	UINTN SizeOfInfo;
	EFI_PHYSICAL_ADDRESS FrameBufferBase;
	UINTN FrameBufferSize;
};

typedef EFI_STATUS(EFIAPI *EFI_GRAPHICS_OUTPUT_PROTOCOL_SET_MODE) (IN EFI_GRAPHICS_OUTPUT_PROTOCOL *This, IN UINT32 ModeNumber);
typedef EFI_STATUS(EFIAPI *EFI_GRAPHICS_OUTPUT_PROTOCOL_QUERY_MODE) (IN EFI_GRAPHICS_OUTPUT_PROTOCOL *This, IN UINT32 ModeNumber, OUT UINTN *SizeOfInfo, OUT EFI_GRAPHICS_OUTPUT_MODE_INFORMATION **Info);

struct EFI_GRAPHICS_OUTPUT_BLT_PIXEL {
	UINT8 Blue;
	UINT8 Green;
	UINT8 Red;
	UINT8 Reserved;
};

typedef enum {
	EfiBltVideoFill,
	EfiBltVideoToBltBuffer,
	EfiBltBufferToVideo,
	EfiBltVideoToVideo,
	EfiGraphicsOutputBltOperationMax
} EFI_GRAPHICS_OUTPUT_BLT_OPERATION;

typedef EFI_STATUS(EFIAPI *EFI_GRAPHICS_OUTPUT_PROTOCOL_BLT) (IN EFI_GRAPHICS_OUTPUT_PROTOCOL *This, IN OUT EFI_GRAPHICS_OUTPUT_BLT_PIXEL *BltBuffer OPTIONAL, IN EFI_GRAPHICS_OUTPUT_BLT_OPERATION BltOperation, IN UINTN SourceX, IN UINTN SourceY, IN UINTN DestinationX, IN UINTN DestinationY, IN UINTN Width, IN UINTN Height, IN UINTN Delta OPTIONAL);

struct EFI_GRAPHICS_OUTPUT_PROTOCOL {
	EFI_GRAPHICS_OUTPUT_PROTOCOL_QUERY_MODE QueryMode;
	EFI_GRAPHICS_OUTPUT_PROTOCOL_SET_MODE SetMode;
	EFI_GRAPHICS_OUTPUT_PROTOCOL_BLT Blt;
	EFI_GRAPHICS_OUTPUT_PROTOCOL_MODE *Mode;
};

#define EFI_EDID_DISCOVERED_PROTOCOL_GUID \
 {0x1c0c34f6,0xd380,0x41fa,\
 {0xa0,0x49,0x8a,0xd0,0x6c,0x1a,0x66,0xaa}}

struct EFI_EDID_DISCOVERED_PROTOCOL {
	UINT32 SizeOfEdid;
	UINT8 *Edid;
};

#define EFI_EDID_ACTIVE_PROTOCOL_GUID \
 {0xbd8c1056,0x9f36,0x44ec,\
 {0x92,0xa8,0xa6,0x33,0x7f,0x81,0x79,0x86}}

struct EFI_EDID_ACTIVE_PROTOCOL {
	UINT32 SizeOfEdid;
	UINT8 *Edid;
};


#define EFI_EDID_OVERRIDE_PROTOCOL_GUID \
 {0x48ecb431,0xfb72,0x45c0,\
 {0xa9,0x22,0xf4,0x58,0xfe,0x04,0x0b,0xd5}}

#define EFI_EDID_OVERRIDE_DONT_OVERRIDE 0x01
#define EFI_EDID_OVERRIDE_ENABLE_HOT_PLUG 0x02

typedef EFI_STATUS(EFIAPI *EFI_EDID_OVERRIDE_PROTOCOL_GET_EDID) (IN EFI_EDID_OVERRIDE_PROTOCOL *This, IN EFI_HANDLE *ChildHandle, OUT UINT32 *Attributes, IN OUT UINTN *EdidSize, IN OUT UINT8 **Edid);

struct EFI_EDID_OVERRIDE_PROTOCOL {
	EFI_EDID_OVERRIDE_PROTOCOL_GET_EDID GetEdid;
};

#define EFI_LOAD_FILE_PROTOCOL_GUID \
 {0x56EC3091,0x954C,0x11d2,\
 {0x8e,0x3f,0x00,0xa0, 0xc9,0x69,0x72,0x3b}}

typedef EFI_STATUS(EFIAPI *EFI_LOAD_FILE) (IN EFI_LOAD_FILE_PROTOCOL *This, IN EFI_DEVICE_PATH_PROTOCOL *FilePath, IN BOOLEAN BootPolicy, IN OUT UINTN *BufferSize, IN VOID *Buffer OPTIONAL);

struct EFI_LOAD_FILE_PROTOCOL {
	EFI_LOAD_FILE LoadFile;
};

#define EFI_LOAD_FILE2_PROTOCOL_GUID \
 { 0x4006c0c1, 0xfcb3, 0x403e, \
 { 0x99, 0x6d, 0x4a, 0x6c, 0x87, 0x24, 0xe0, 0x6d }}

typedef EFI_LOAD_FILE_PROTOCOL EFI_LOAD_FILE2_PROTOCOL;

#define EFI_SIMPLE_FILE_SYSTEM_PROTOCOL_REVISION 0x00010000

#define EFI_SIMPLE_FILE_SYSTEM_PROTOCOL_GUID \
 {0x0964e5b22,0x6459,0x11d2,\
 {0x8e,0x39,0x00,0xa0,0xc9,0x69,0x72,0x3b}}

typedef EFI_STATUS(EFIAPI *EFI_SIMPLE_FILE_SYSTEM_PROTOCOL_OPEN_VOLUME) (IN EFI_SIMPLE_FILE_SYSTEM_PROTOCOL *This, OUT EFI_FILE_PROTOCOL **Root);


struct EFI_SIMPLE_FILE_SYSTEM_PROTOCOL {
	UINT64 Revision;
	EFI_SIMPLE_FILE_SYSTEM_PROTOCOL_OPEN_VOLUME OpenVolume;
};

#define EFI_FILE_PROTOCOL_REVISION 0x00010000
#define EFI_FILE_PROTOCOL_REVISION2 0x00020000
#define EFI_FILE_PROTOCOL_LATEST_REVISION EFI_FILE_PROTOCOL_REVISION2

#define EFI_FILE_MODE_READ 0x0000000000000001
#define EFI_FILE_MODE_WRITE 0x0000000000000002
#define EFI_FILE_MODE_CREATE 0x8000000000000000
#define EFI_FILE_READ_ONLY 0x0000000000000001
#define EFI_FILE_HIDDEN 0x0000000000000002
#define EFI_FILE_SYSTEM 0x0000000000000004
#define EFI_FILE_RESERVED 0x0000000000000008
#define EFI_FILE_DIRECTORY 0x0000000000000010
#define EFI_FILE_ARCHIVE 0x0000000000000020
#define EFI_FILE_VALID_ATTR 0x0000000000000037

struct EFI_FILE_IO_TOKEN {
	EFI_EVENT Event;
	EFI_STATUS Status;
	UINTN BufferSize;
	VOID *Buffer;
};

typedef EFI_STATUS(EFIAPI *EFI_FILE_OPEN) (IN EFI_FILE_PROTOCOL *This, OUT EFI_FILE_PROTOCOL **NewHandle, IN CHAR16 *FileName, IN UINT64 OpenMode, IN UINT64 Attributes);
typedef EFI_STATUS(EFIAPI *EFI_FILE_CLOSE) (IN EFI_FILE_PROTOCOL *This);
typedef EFI_STATUS(EFIAPI *EFI_FILE_DELETE) (IN EFI_FILE_PROTOCOL *This);
typedef EFI_STATUS(EFIAPI *EFI_FILE_READ) (IN EFI_FILE_PROTOCOL *This, IN OUT UINTN *BufferSize, OUT VOID *Buffer);
typedef EFI_STATUS(EFIAPI *EFI_FILE_WRITE) (IN EFI_FILE_PROTOCOL *This, IN OUT UINTN *BufferSize, IN VOID *Buffer);
typedef EFI_STATUS(EFIAPI *EFI_FILE_OPEN_EX) (IN EFI_FILE_PROTOCOL *This, OUT EFI_FILE_PROTOCOL **NewHandle, IN CHAR16 *FileName, IN UINT64 OpenMode, IN UINT64 Attributes, IN OUT EFI_FILE_IO_TOKEN *Token);
typedef EFI_STATUS(EFIAPI *EFI_FILE_READ_EX) (IN EFI_FILE_PROTOCOL *This, IN OUT EFI_FILE_IO_TOKEN *Token);
typedef EFI_STATUS(EFIAPI *EFI_FILE_WRITE_EX) (IN EFI_FILE_PROTOCOL *This, IN OUT EFI_FILE_IO_TOKEN *Token);
typedef EFI_STATUS(EFIAPI *EFI_FILE_FLUSH_EX) (IN EFI_FILE_PROTOCOL *This, IN OUT EFI_FILE_IO_TOKEN *Token);
typedef EFI_STATUS(EFIAPI *EFI_FILE_SET_POSITION) (IN EFI_FILE_PROTOCOL *This, IN UINT64 Position);
typedef EFI_STATUS(EFIAPI *EFI_FILE_GET_POSITION) (IN EFI_FILE_PROTOCOL *This, OUT UINT64 *Position);
typedef EFI_STATUS(EFIAPI *EFI_FILE_GET_INFO) (IN EFI_FILE_PROTOCOL *This, IN EFI_GUID *InformationType, IN OUT UINTN *BufferSize, OUT VOID *Buffer);
typedef EFI_STATUS(EFIAPI *EFI_FILE_SET_INFO) (IN EFI_FILE_PROTOCOL *This, IN EFI_GUID *InformationType, IN UINTN BufferSize, IN VOID *Buffer);
typedef EFI_STATUS(EFIAPI *EFI_FILE_FLUSH) (IN EFI_FILE_PROTOCOL *This);

struct EFI_FILE_PROTOCOL {
	UINT64 Revision;
	EFI_FILE_OPEN Open;
	EFI_FILE_CLOSE Close;
	EFI_FILE_DELETE Delete;
	EFI_FILE_READ Read;
	EFI_FILE_WRITE Write;
	EFI_FILE_GET_POSITION GetPosition;
	EFI_FILE_SET_POSITION SetPosition;
	EFI_FILE_GET_INFO GetInfo;
	EFI_FILE_SET_INFO SetInfo;
	EFI_FILE_FLUSH Flush;
	EFI_FILE_OPEN_EX OpenEx; 
	EFI_FILE_READ_EX ReadEx; 
	EFI_FILE_WRITE_EX WriteEx;
	EFI_FILE_FLUSH_EX FlushEx;
};

#define EFI_FILE_INFO_ID \
 {0x09576e92,0x6d3f,0x11d2,\
 {0x8e,0x39,0x00,0xa0,0xc9,0x69,0x72,0x3b}}

#define EFI_FILE_READ_ONLY 0x0000000000000001
#define EFI_FILE_HIDDEN 0x0000000000000002
#define EFI_FILE_SYSTEM 0x0000000000000004
#define EFI_FILE_RESERVED 0x0000000000000008
#define EFI_FILE_DIRECTORY 0x0000000000000010
#define EFI_FILE_ARCHIVE 0x0000000000000020
#define EFI_FILE_VALID_ATTR 0x0000000000000037

struct EFI_FILE_INFO {
	UINT64 Size;
	UINT64 FileSize;
	UINT64 PhysicalSize;
	EFI_TIME CreateTime;
	EFI_TIME LastAccessTime;
	EFI_TIME ModificationTime;
	UINT64 Attribute;
	CHAR16* FileName;
};

#define EFI_FILE_SYSTEM_INFO_ID \
 {0x09576e93,0x6d3f,0x11d2,0x8e39,0x00,0xa0,0xc9,0x69,0x72,\
 0x3b}

struct EFI_FILE_SYSTEM_INFO {
	UINT64 Size;
	BOOLEAN ReadOnly;
	UINT64 VolumeSize;
	UINT64 FreeSpace;
	UINT32 BlockSize;
	CHAR16 VolumeLabel[];
};

#define EFI_FILE_SYSTEM_VOLUME_LABEL_ID \
{0xdb47d7d3,0xfe81,0x11d3,0x9a35,\
 {0x00,0x90,0x27,0x3f,0xC1,0x4d}}

struct EFI_FILE_SYSTEM_VOLUME_LABEL {
	CHAR16 VolumeLabel[];
};

#define EFI_TAPE_IO_PROTOCOL_GUID \
 {0x1e93e633,0xd65a,0x459e, \
 {0xab,0x84,0x93,0xd9,0xec,0x26,0x6d,0x18}} 

typedef EFI_STATUS(EFIAPI *EFI_TAPE_READ) (IN EFI_TAPE_IO_PROTOCOL *This, IN OUT UINTN *BufferSize, OUT VOID *Buffer);
typedef EFI_STATUS(EFIAPI *EFI_TAPE_WRITE) (IN EFI_TAPE_IO_PROTOCOL *This, IN UINTN *BufferSize, IN VOID *Buffer);
typedef EFI_STATUS(EFIAPI *EFI_TAPE_REWIND) (IN EFI_TAPE_IO_PROTOCOL *This);
typedef EFI_STATUS(EFIAPI *EFI_TAPE_SPACE) (IN EFI_TAPE_IO_PROTOCOL *This, IN INTN Direction, IN UINTN Type);
typedef EFI_STATUS(EFIAPI *EFI_TAPE_WRITEFM) (IN EFI_TAPE_IO_PROTOCOL *This, IN UINTN Count);
typedef EFI_STATUS(EFIAPI *EFI_TAPE_RESET) (IN EFI_TAPE_IO_PROTOCOL *This, IN BOOLEAN ExtendedVerification);

 struct EFI_TAPE_IO_PROTOCOL {
	EFI_TAPE_READ TapeRead;
	EFI_TAPE_WRITE TapeWrite;
	EFI_TAPE_REWIND TapeRewind;
	EFI_TAPE_SPACE TapeSpace;
	EFI_TAPE_WRITEFM TapeWriteFM;
	EFI_TAPE_RESET TapeReset;
};

struct EFI_TAPE_HEADER {
	UINT64 Signature;
	UINT32 Revision;
	UINT32 BootDescSize;
	UINT32 BootDescCRC;
	EFI_GUID TapeGUID;
	EFI_GUID TapeType;
	EFI_GUID TapeUnique;
	UINT32 BLLocation;
	UINT32 BLBlocksize;
	UINT32 BLFilesize;
	CHAR8 OSVersion[40];
	CHAR8 AppVersion[40];
	CHAR8 CreationDate[10];
	CHAR8 CreationTime[10];
	CHAR8 SystemName[256]; // UTF-8
	CHAR8 TapeTitle[120]; // UTF-8
	CHAR8 pad[468]; // pad to 1024
};

#define EFI_DISK_IO_PROTOCOL_GUID \
 {0xCE345171,0xBA0B,0x11d2,\
 {0x8e,0x4F,0x00,0xa0,0xc9,0x69,0x72,0x3b}}

#define EFI_DISK_IO_PROTOCOL_REVISION 0x00010000

typedef EFI_STATUS(EFIAPI *EFI_DISK_READ) (IN EFI_DISK_IO_PROTOCOL *This, IN UINT32 MediaId, IN UINT64 Offset, IN UINTN BufferSize, OUT VOID *Buffer);
typedef EFI_STATUS(EFIAPI *EFI_DISK_WRITE) (IN EFI_DISK_IO_PROTOCOL *This, IN UINT32 MediaId, IN UINT64 Offset, IN UINTN BufferSize, IN VOID *Buffer);

struct EFI_DISK_IO_PROTOCOL {
	UINT64 Revision;
	EFI_DISK_READ ReadDisk;
	EFI_DISK_WRITE WriteDisk;
};

#define EFI_DISK_IO2_PROTOCOL_REVISION 0x00020000

#define EFI_DISK_IO2_PROTOCOL_GUID \
 { 0x151c8eae, 0x7f2c, 0x472c, \
 {0x9e, 0x54, 0x98, 0x28, 0x19, 0x4f, 0x6a, 0x88 }}

struct EFI_DISK_IO2_TOKEN {
	EFI_EVENT Event;
	EFI_STATUS TransactionStatus;
};

typedef EFI_STATUS(EFIAPI *EFI_DISK_CANCEL_EX) (IN EFI_DISK_IO2_PROTOCOL *This);
typedef EFI_STATUS(EFIAPI *EFI_DISK_READ_EX) (IN EFI_DISK_IO2_PROTOCOL *This, IN UINT32 MediaId, IN UINT64 Offset, IN OUT EFI_DISK_IO2_TOKEN *Token, IN UINTN BufferSize, OUT VOID *Buffer);
typedef EFI_STATUS(EFIAPI *EFI_DISK_WRITE_EX) (IN EFI_DISK_IO2_PROTOCOL *This, IN UINT32 MediaId, IN UINT64 Offset, IN OUT EFI_DISK_IO2_TOKEN *Token, IN UINTN BufferSize, IN VOID *Buffer);
typedef EFI_STATUS(EFIAPI *EFI_DISK_FLUSH_EX) (IN EFI_DISK_IO2_PROTOCOL *This, IN OUT EFI_DISK_IO2_TOKEN *Token);

 struct EFI_DISK_IO2_PROTOCOL {
	UINT64 Revision;
	EFI_DISK_CANCEL_EX Cancel;
	EFI_DISK_READ_EX ReadDiskEx;
	EFI_DISK_WRITE_EX WriteDiskEx;
	EFI_DISK_FLUSH_EX FlushDiskEx;
};

#define EFI_BLOCK_IO_PROTOCOL_GUID \
 {0x964e5b21,0x6459,0x11d2,\
 {0x8e,0x39,0x00,0xa0,0xc9,0x69,0x72,0x3b}}

#define EFI_BLOCK_IO_PROTOCOL_REVISION2 0x00020001
#define EFI_BLOCK_IO_PROTOCOL_REVISION3 ((2<<16) | (31))

typedef UINT64 EFI_LBA;

struct EFI_BLOCK_IO_MEDIA {
	UINT32 MediaId;
	BOOLEAN RemovableMedia;
	BOOLEAN MediaPresent;
	BOOLEAN LogicalPartition;
	BOOLEAN ReadOnly;
	BOOLEAN WriteCaching;
	UINT32 BlockSize;
	UINT32 IoAlign;
	EFI_LBA LastBlock;
	EFI_LBA LowestAlignedLba;
	UINT32 LogicalBlocksPerPhysicalBlock;
	UINT32 OptimalTransferLengthGranularity;
};

typedef EFI_STATUS(EFIAPI *EFI_BLOCK_RESET) (IN EFI_BLOCK_IO_PROTOCOL *This, IN BOOLEAN ExtendedVerification);
typedef EFI_STATUS(EFIAPI *EFI_BLOCK_READ) (IN EFI_BLOCK_IO_PROTOCOL *This, IN UINT32 MediaId, IN EFI_LBA LBA, IN UINTN BufferSize, OUT VOID *Buffer);
typedef EFI_STATUS(EFIAPI *EFI_BLOCK_WRITE) (IN EFI_BLOCK_IO_PROTOCOL *This, IN UINT32 MediaId, IN EFI_LBA LBA, IN UINTN BufferSize, IN VOID *Buffer);
typedef EFI_STATUS(EFIAPI *EFI_BLOCK_FLUSH) (IN EFI_BLOCK_IO_PROTOCOL *This);

struct EFI_BLOCK_IO_PROTOCOL {
	UINT64 Revision;
	EFI_BLOCK_IO_MEDIA *Media;
	EFI_BLOCK_RESET Reset;
	EFI_BLOCK_READ ReadBlocks;
	EFI_BLOCK_WRITE WriteBlocks;
	EFI_BLOCK_FLUSH FlushBlocks;
};

#define EFI_BLOCK_IO2_PROTOCOL_GUID \
 {0xa77b2472, 0xe282, 0x4e9f, \
 {0xa2, 0x45, 0xc2, 0xc0, 0xe2, 0x7b, 0xbc, 0xc1}}

 struct EFI_BLOCK_IO2_TOKEN {
	EFI_EVENT Event;
	EFI_STATUS TransactionStatus;
};

typedef EFI_STATUS(EFIAPI *EFI_BLOCK_RESET_EX) (IN EFI_BLOCK_IO2_PROTOCOL *This, IN BOOLEAN ExtendedVerification);
typedef EFI_STATUS(EFIAPI *EFI_BLOCK_READ_EX) (IN EFI_BLOCK_IO2_PROTOCOL *This, IN UINT32 MediaId, IN EFI_LBA LBA, IN OUT EFI_BLOCK_IO2_TOKEN *Token, IN UINTN BufferSize, OUT VOID *Buffer);
typedef EFI_STATUS(EFIAPI *EFI_BLOCK_WRITE_EX) (IN EFI_BLOCK_IO2_PROTOCOL *This, IN UINT32 MediaId, IN EFI_LBA LBA, IN OUT EFI_BLOCK_IO2_TOKEN *Token, IN UINTN BufferSize, IN VOID *Buffer);
typedef EFI_STATUS(EFIAPI *EFI_BLOCK_FLUSH_EX) (IN EFI_BLOCK_IO2_PROTOCOL *This, IN OUT EFI_BLOCK_IO2_TOKEN *Token);

struct EFI_BLOCK_IO2_PROTOCOL {
	EFI_BLOCK_IO_MEDIA *Media;
	EFI_BLOCK_RESET_EX Reset;
	EFI_BLOCK_READ_EX ReadBlocksEx;
	EFI_BLOCK_WRITE_EX WriteBlocksEx;
	EFI_BLOCK_FLUSH_EX FlushBlocksEx;
};

#define EFI_BLOCK_IO_CRYPTO_PROTOCOL_GUID \
 {0xa00490ba,0x3f1a,0x4b4c,\
 {0xab,0x90,0x4f,0xa9,0x97,0x26,0xa1,0xe8}} 

#define EFI_BLOCK_IO_CRYPTO_ALGO_GUID_AES_XTS \
 {0x2f87ba6a,\
 0x5c04,0x4385,0xa7,0x80,0xf3,0xbf,0x78,0xa9,0x7b,0xec} 

#define EFI_BLOCK_IO_CRYPTO_ALGO_GUID_AES_CBC_MICROSOFT_BITLOCKER \
{0x689e4c62, \
0x70bf, 0x4cf3, 0x88, 0xbb, 0x33, 0xb3, 0x18, 0x26, 0x86, 0x70}

struct EFI_BLOCK_IO_CRYPTO_CAPABILITY {
	EFI_GUID Algorithm;
	UINT64 KeySize;
	UINT64 CryptoBlockSizeBitMask;
};

struct EFI_BLOCK_IO_CRYPTO_IV_INPUT {
	UINT64 InputSize;
};

struct EFI_BLOCK_IO_CRYPTO_IV_INPUT_AES_XTS {
	EFI_BLOCK_IO_CRYPTO_IV_INPUT Header;
	UINT64 CryptoBlockNumber;
	UINT64 CryptoBlockByteSize;
};

struct EFI_BLOCK_IO_CRYPTO_IV_INPUT_AES_CBC_MICROSOFT_BITLOCKER {
	EFI_BLOCK_IO_CRYPTO_IV_INPUT Header;
	UINT64 CryptoBlockByteOffset;
	UINT64 CryptoBlockByteSize;
};

 struct EFI_BLOCK_IO_CRYPTO_CONFIGURATION_TABLE_ENTRY {
	UINT64 Index;
	EFI_GUID KeyOwnerGuid;
	EFI_BLOCK_IO_CRYPTO_CAPABILITY Capability;
	VOID *CryptoKey;
};

struct EFI_BLOCK_IO_CRYPTO_RESPONSE_CONFIGURATION_ENTRY {
	UINT64 Index;
	EFI_GUID KeyOwnerGuid;
	EFI_BLOCK_IO_CRYPTO_CAPABILITY Capability;
};

#define EFI_BLOCK_IO_CRYPTO_INDEX_ANY 0xFFFFFFFFFFFFFFFF
struct EFI_BLOCK_IO_CRYPTO_CAPABILITIES {
	BOOLEAN Supported;
	UINT64 KeyCount;
	UINT64 CapabilityCount;
	EFI_BLOCK_IO_CRYPTO_CAPABILITY Capabilities[1];
};

struct EFI_BLOCK_IO_CRYPTO_TOKEN {
	EFI_EVENT Event;
	EFI_STATUS TransactionStatus;
};

typedef EFI_STATUS(EFIAPI *EFI_BLOCK_IO_CRYPTO_RESET) (IN EFI_BLOCK_IO_CRYPTO_PROTOCOL *This, IN BOOLEAN ExtendedVerification);
typedef EFI_STATUS(EFIAPI *EFI_BLOCK_IO_CRYPTO_GET_CAPABILITIES) (IN EFI_BLOCK_IO_CRYPTO_PROTOCOL *This, OUT EFI_BLOCK_IO_CRYPTO_CAPABILITIES *Capabilities);
typedef EFI_STATUS(EFIAPI *EFI_BLOCK_IO_CRYPTO_SET_CONFIGURATION) (IN EFI_BLOCK_IO_CRYPTO_PROTOCOL *This, IN UINT64 ConfigurationCount, IN EFI_BLOCK_IO_CRYPTO_CONFIGURATION_TABLE_ENTRY *ConfigurationTable, OUT EFI_BLOCK_IO_CRYPTO_RESPONSE_CONFIGURATION_ENTRY *ResultingTable OPTIONAL);
typedef EFI_STATUS(EFIAPI *EFI_BLOCK_IO_CRYPTO_GET_CONFIGURATION) (IN EFI_BLOCK_IO_CRYPTO_PROTOCOL *This, IN UINT64 StartIndex, IN UINT64 ConfigurationCount, IN EFI_GUID *KeyOwnerGuid OPTIONAL, OUT EFI_BLOCK_IO_CRYPTO_RESPONSE_CONFIGURATION_ENTRY*ConfigurationTable);
typedef EFI_STATUS(EFIAPI *EFI_BLOCK_IO_CRYPTO_READ_DEVICE_EXTENDED) (IN EFI_BLOCK_IO_CRYPTO_PROTOCOL *This, IN UINT32 MediaId, IN EFI_LBA LBA, IN OUT EFI_BLOCK_IO_CRYPTO_TOKEN *Token, IN UINT64 BufferSize, OUT VOID *Buffer, IN UINT64 *Index OPTIONAL, IN VOID *CryptoIvInput OPTIONAL);
typedef EFI_STATUS(EFIAPI *EFI_BLOCK_IO_CRYPTO_WRITE_DEVICE_EXTENDED) (IN EFI_BLOCK_IO_CRYPTO_PROTOCOL *This, IN UINT32 MediaId, IN EFI_LBA LBA, IN OUT EFI_BLOCK_IO_CRYPTO_TOKEN *Token, IN UINT64 BufferSize, IN VOID *Buffer, IN UINT64 *Index, OPTIONAL	IN VOID *CryptoIvInput OPTIONAL);
typedef EFI_STATUS(EFIAPI *EFI_BLOCK_IO_CRYPTO_FLUSH) (IN EFI_BLOCK_IO_CRYPTO_PROTOCOL *This, IN OUT EFI_BLOCK_IO_CRYPTO_TOKEN *Token);


 struct EFI_BLOCK_IO_CRYPTO_PROTOCOL {
	EFI_BLOCK_IO_MEDIA *Media;
	EFI_BLOCK_IO_CRYPTO_RESET Reset;
	EFI_BLOCK_IO_CRYPTO_GET_CAPABILITIES GetCapabilities;
	EFI_BLOCK_IO_CRYPTO_SET_CONFIGURATION SetConfiguration;
	EFI_BLOCK_IO_CRYPTO_GET_CONFIGURATION GetConfiguration;
	EFI_BLOCK_IO_CRYPTO_READ_DEVICE_EXTENDED ReadExtended;
	EFI_BLOCK_IO_CRYPTO_WRITE_DEVICE_EXTENDED WriteExtended;
	EFI_BLOCK_IO_CRYPTO_FLUSH FlushBlocks;
};

#define EFI_ERASE_BLOCK_PROTOCOL_REVISION ((2<<16) | (60))

#define EFI_ERASE_BLOCK_PROTOCOL_GUID \
{0x95A9A93E, 0xA86E, 0x4926, \
{0xaa, 0xef, 0x99, 0x18, 0xe7, 0x72, 0xd9, 0x87}}

 struct EFI_ERASE_BLOCK_TOKEN {
	EFI_EVENT Event;
	EFI_STATUS TransactionStatus;
};

typedef EFI_STATUS(EFIAPI *EFI_BLOCK_ERASE)(IN EFI_BLOCK_IO_PROTOCOL *This, IN UINT32 MediaId, IN EFI_LBA LBA, IN OUT EFI_ERASE_BLOCK_TOKEN *Token, IN UINTN Size);

 struct EFI_ERASE_BLOCK_PROTOCOL {
	UINT64 Revision;
	UINT32 EraseLengthGranularity; 
	EFI_BLOCK_ERASE EraseBlocks; 
};

#define EFI_ATA_PASS_THRU_PROTOCOL_GUID \
 {0x1d3de7f0,0x807,0x424f,\
 {0xaa,0x69,0x11,0xa5,0x4e,0x19,0xa4,0x6f}}

#define EFI_ATA_PASS_THRU_ATTRIBUTES_PHYSICAL 0x0001
#define EFI_ATA_PASS_THRU_ATTRIBUTES_LOGICAL 0x0002
#define EFI_ATA_PASS_THRU_ATTRIBUTES_NONBLOCKIO 0x0004

#define EFI_ATA_PASS_THRU_PROTOCOL_ATA_HARDWARE_RESET 0x00
#define EFI_ATA_PASS_THRU_PROTOCOL_ATA_SOFTWARE_RESET 0x01
#define EFI_ATA_PASS_THRU_PROTOCOL_ATA_NON_DATA 0x02
#define EFI_ATA_PASS_THRU_PROTOCOL_PIO_DATA_IN 0x04
#define EFI_ATA_PASS_THRU_PROTOCOL_PIO_DATA_OUT 0x05
#define EFI_ATA_PASS_THRU_PROTOCOL_DMA 0x06
#define EFI_ATA_PASS_THRU_PROTOCOL_DMA_QUEUED 0x07
#define EFI_ATA_PASS_THRU_PROTOCOL_DEVICE_DIAGNOSTIC 0x08
#define EFI_ATA_PASS_THRU_PROTOCOL_DEVICE_RESET 0x09
#define EFI_ATA_PASS_THRU_PROTOCOL_UDMA_DATA_IN 0x0A
#define EFI_ATA_PASS_THRU_PROTOCOL_UDMA_DATA_OUT 0x0B
#define EFI_ATA_PASS_THRU_PROTOCOL_FPDMA 0x0C
#define EFI_ATA_PASS_THRU_PROTOCOL_RETURN_RESPONSE 0xFF

#define EFI_ATA_PASS_THRU_LENGTH_BYTES 0x80
#define EFI_ATA_PASS_THRU_LENGTH_MASK 0x70
#define EFI_ATA_PASS_THRU_LENGTH_NO_DATA_TRANSFER 0x00
#define EFI_ATA_PASS_THRU_LENGTH_FEATURES 0x10
#define EFI_ATA_PASS_THRU_LENGTH_SECTOR_COUNT 0x20
#define EFI_ATA_PASS_THRU_LENGTH_TPSIU 0x30
#define EFI_ATA_PASS_THRU_LENGTH_COUNT 0x0F

typedef UINT8 EFI_ATA_PASS_THRU_CMD_PROTOCOL;
typedef UINT8 EFI_ATA_PASS_THRU_LENGTH;

 struct EFI_ATA_PASS_THRU_MODE {
	UINT32 Attributes;
	UINT32 IoAlign;
};

 struct EFI_ATA_COMMAND_BLOCK {
	UINT8 Reserved1[2];
	UINT8 AtaCommand;
	UINT8 AtaFeatures;
	UINT8 AtaSectorNumber;
	UINT8 AtaCylinderLow;
	UINT8 AtaCylinderHigh;
	UINT8 AtaDeviceHead;
	UINT8 AtaSectorNumberExp;
	UINT8 AtaCylinderLowExp;
	UINT8 AtaCylinderHighExp;
	UINT8 AtaFeaturesExp;
	UINT8 AtaSectorCount;
	UINT8 AtaSectorCountExp;
	UINT8 Reserved2[6];
};

struct EFI_ATA_STATUS_BLOCK {
	UINT8 Reserved1[2];
	UINT8 AtaStatus;
	UINT8 AtaError;
	UINT8 AtaSectorNumber;
	UINT8 AtaCylinderLow;
	UINT8 AtaCylinderHigh;
	UINT8 AtaDeviceHead;
	UINT8 AtaSectorNumberExp;
	UINT8 AtaCylinderLowExp;
	UINT8 AtaCylinderHighExp;
	UINT8 Reserved2;
	UINT8 AtaSectorCount;
	UINT8 AtaSectorCountExp;
	UINT8 Reserved3[6];
};

struct EFI_ATA_PASS_THRU_COMMAND_PACKET {
	EFI_ATA_STATUS_BLOCK *Asb;
	EFI_ATA_COMMAND_BLOCK *Acb;
	UINT64 Timeout;
	VOID *InDataBuffer;
	VOID *OutDataBuffer;
	UINT32 InTransferLength;
	UINT32 OutTransferLength;
	EFI_ATA_PASS_THRU_CMD_PROTOCOL Protocol;
	EFI_ATA_PASS_THRU_LENGTH Length;
};

typedef EFI_STATUS(EFIAPI *EFI_ATA_PASS_THRU_PASSTHRU) (IN EFI_ATA_PASS_THRU_PROTOCOL *This, IN UINT16 Port, IN UINT16 PortMultiplierPort, IN OUT EFI_ATA_PASS_THRU_COMMAND_PACKET *Packet, IN EFI_EVENT Event OPTIONAL);
typedef EFI_STATUS(EFIAPI *EFI_ATA_PASS_THRU_GET_NEXT_PORT) (IN EFI_ATA_PASS_THRU_PROTOCOL *This, IN OUT UINT16 *Port);
typedef EFI_STATUS(EFIAPI *EFI_ATA_PASS_THRU_GET_NEXT_DEVICE) (IN EFI_ATA_PASS_THRU_PROTOCOL *This, IN UINT16 Port, IN OUT UINT16 *PortMultiplierPort);
typedef EFI_STATUS(EFIAPI *EFI_ATA_PASS_THRU_BUILD_DEVICE_PATH) (IN EFI_ATA_PASS_THRU_PROTOCOL *This, IN UINT16 Port, IN UINT16 PortMultiplierPort, IN OUT EFI_DEVICE_PATH_PROTOCOL **DevicePath);
typedef EFI_STATUS(EFIAPI *EFI_ATA_PASS_THRU_GET_DEVICE) (IN EFI_ATA_PASS_THRU_PROTOCOL *This, IN EFI_DEVICE_PATH_PROTOCOL *DevicePath, OUT UINT16 *Port, OUT UINT16 *PortMultiplierPort);
typedef EFI_STATUS(EFIAPI *EFI_ATA_PASS_THRU_RESET_PORT) (IN EFI_ATA_PASS_THRU_PROTOCOL *This, IN UINT16 Port);
typedef EFI_STATUS(EFIAPI *EFI_ATA_PASS_THRU_RESET_DEVICE) (IN EFI_ATA_PASS_THRU_PROTOCOL *This, IN UINT16 Port, IN UINT16 PortMultiplierPort);


struct EFI_ATA_PASS_THRU_PROTOCOL {
	EFI_ATA_PASS_THRU_MODE *Mode;
	EFI_ATA_PASS_THRU_PASSTHRU PassThru;
	EFI_ATA_PASS_THRU_GET_NEXT_PORT GetNextPort;
	EFI_ATA_PASS_THRU_GET_NEXT_DEVICE GetNextDevice;
	EFI_ATA_PASS_THRU_BUILD_DEVICE_PATH BuildDevicePath;
	EFI_ATA_PASS_THRU_GET_DEVICE GetDevice;
	EFI_ATA_PASS_THRU_RESET_PORT ResetPort;
	EFI_ATA_PASS_THRU_RESET_DEVICE ResetDevice;
};

#define EFI_STORAGE_SECURITY_COMMAND_PROTOCOL_GUID \
 {0xc88b0b6d, 0x0dfc, 0x49a7,\
 {0x9c, 0xb4, 0x49, 0x7, 0x4b, 0x4c, 0x3a, 0x78}}

typedef EFI_STATUS(EFIAPI *EFI_STORAGE_SECURITY_RECEIVE_DATA) (IN EFI_STORAGE_SECURITY_COMMAND_PROTOCOL *This, IN UINT32 MediaId, IN UINT64 Timeout, IN UINT8 SecurityProtocol, IN UINT16 SecurityProtocolSpecificData, IN UINTN PayloadBufferSize, OUT VOID *PayloadBuffer, OUT UINTN *PayloadTransferSize);
typedef EFI_STATUS(EFIAPI *EFI_STORAGE_SECURITY_SEND_DATA) (IN EFI_STORAGE_SECURITY_COMMAND_PROTOCOL *This, IN UINT32 MediaId, IN UINT64 Timeout, IN UINT8 SecurityProtocolId, IN UINT16 SecurityProtocolSpecificData, IN UINTN PayloadBufferSize, IN VOID *PayloadBuffer);


struct EFI_STORAGE_SECURITY_COMMAND_PROTOCOL {
	EFI_STORAGE_SECURITY_RECEIVE_DATA ReceiveData;
	EFI_STORAGE_SECURITY_SEND_DATA SendData;
};

#define EFI_NVM_EXPRESS_PASS_THRU_PROTOCOL_GUID \
 { 0x52c78312, 0x8edc, 0x4233,\
 { 0x98, 0xf2, 0x1a, 0x1a, 0xa5, 0xe3, 0x88, 0xa5 } };

#define EFI_NVM_EXPRESS_PASS_THRU_ATTRIBUTES_PHYSICAL 0x0001
#define EFI_NVM_EXPRESS_PASS_THRU_ATTRIBUTES_LOGICAL 0x0002
#define EFI_NVM_EXPRESS_PASS_THRU_ATTRIBUTES_NONBLOCKIO 0x0004
#define EFI_NVM_EXPRESS_PASS_THRU_ATTRIBUTES_CMD_SET_NVM 0x0008
#define CDW2_VALID0x01
#define CDW3_VALID0x02
#define CDW10_VALID0x04
#define CDW11_VALID0x08
#define CDW12_VALID0x10
#define CDW13_VALID0x20
#define CDW14_VALID0x40
#define CDW15_VALID0x80
#define NORMAL_CMD 0x00
#define FUSED_FIRST_CMD 0x01
#define FUSED_SECOND_CMD 0x02

struct EFI_NVM_EXPRESS_PASS_THRU_MODE {
	UINT32 Attributes;
	UINT32 IoAlign;
	UINT32 NvmeVersion;
};

struct NVME_CDW0 {
	UINT32 OpCode : 8;
	UINT32 FusedOperation : 2;
	UINT32 Reserved : 22;
};

struct EFI_NVM_EXPRESS_COMMAND {
	NVME_CDW0 Cdw0;
	UINT8 Flags;
	UINT32 Nsid;
	UINT32 Cdw2;
	UINT32 Cdw3;
	UINT32 Cdw10;
	UINT32 Cdw11;
	UINT32 Cdw12;
	UINT32 Cdw13;
	UINT32 Cdw14;
	UINT32 Cdw15;
};

struct EFI_NVM_EXPRESS_COMPLETION {
	UINT32 DW0;
	UINT32 DW1;
	UINT32 DW2;
	UINT32 DW3;
};

 struct EFI_NVM_EXPRESS_PASS_THRU_COMMAND_PACKET {
	UINT64 CommandTimeout;
	VOID *TransferBuffer OPTIONAL;
	UINT32 TransferLength OPTIONAL;
	VOID *MetaDataBuffer OPTIONAL;
	UINT32 MetadataLength OPTIONAL;
	UINT8 QueueType;
	EFI_NVM_EXPRESS_COMMAND *NvmeCmd;
	EFI_NVM_EXPRESS_COMPLETION *NvmeCompletion;
};

typedef EFI_STATUS(EFIAPI *EFI_NVM_EXPRESS_PASS_THRU_PASSTHRU) (IN EFI_NVM_EXPRESS_PASS_THRU_PROTOCOL *This, IN UINT32 NamespaceId, IN OUT EFI_NVM_EXPRESS_PASS_THRU_COMMAND_PACKET *Packet, IN EFI_EVENT Event OPTIONAL);
typedef EFI_STATUS(EFIAPI *EFI_NVM_EXPRESS_PASS_THRU_GET_NEXT_NAMESPACE) (IN EFI_NVM_EXPRESS_PASS_THRU_PROTOCOL *This, IN OUT UINT32 *NamespaceId);
typedef EFI_STATUS(EFIAPI *EFI_NVM_EXPRESS_PASS_THRU_BUILD_DEVICE_PATH) (IN EFI_NVM_EXPRESS_PASS_THRU_PROTOCOL *This, IN UINT32 NamespaceId, IN OUT EFI_DEVICE_PATH_PROTOCOL **DevicePath);
typedef EFI_STATUS(EFIAPI *EFI_NVM_EXPRESS_PASS_THRU_GET_NAMESPACE) (IN EFI_NVM_EXPRESS_PASS_THRU_PROTOCOL *This, IN EFI_DEVICE_PATH_PROTOCOL *DevicePath, OUT UINT32 *NamespaceId);

 struct EFI_NVM_EXPRESS_PASS_THRU_PROTOCOL {
	EFI_NVM_EXPRESS_PASS_THRU_MODE *Mode;
	EFI_NVM_EXPRESS_PASS_THRU_PASSTHRU PassThru;
	EFI_NVM_EXPRESS_PASS_THRU_GET_NEXT_NAMESPACE GetNextNamespace;
	EFI_NVM_EXPRESS_PASS_THRU_BUILD_DEVICE_PATH BuildDevicePath;
	EFI_NVM_EXPRESS_PASS_THRU_GET_NAMESPACE GetNamespace;
};

#define EFI_SD_MMC_PASS_THRU_PROTOCOL_GUID { 0x716ef0d9, 0xff83, 0x4f69, { 0x81, 0xe9, 0x51, 0x8b, 0xd3, 0x9a, 0x8e, 0x70 } }

struct EFI_SD_MMC_COMMAND_BLOCK {
	UINT16 CommandIndex;
	UINT32 CommandArgument;
	UINT32 CommandType; 
	UINT32 ResponseType;
};

 struct EFI_SD_MMC_STATUS_BLOCK {
	UINT32 Resp0;
	UINT32 Resp1;
	UINT32 Resp2;
	UINT32 Resp3;
};

typedef enum {
	SdMmcCommandTypeBc, 
	SdMmcCommandTypeBcr,
	SdMmcCommandTypeAc, 
	SdMmcCommandTypeAdtc
} EFI_SD_MMC_COMMAND_TYPE;

typedef enum {
	SdMmcResponceTypeR1,
	SdMmcResponceTypeR1b,
	SdMmcResponceTypeR2,
	SdMmcResponceTypeR3,
	SdMmcResponceTypeR4,
	SdMmcResponceTypeR5,
	SdMmcResponceTypeR5b,
	SdMmcResponceTypeR6,
	SdMmcResponceTypeR7
} EFI_SD_MMC_RESPONSE_TYPE;

 struct EFI_SD_MMC_PASS_THRU_COMMAND_PACKET {
	EFI_SD_MMC_COMMAND_BLOCK *SdMmcCmdBlk;
	EFI_SD_MMC_STATUS_BLOCK *SdMmcStatusBlk;
	UINT64 Timeout;
	VOID *InDataBuffer;
	VOID *OutDataBuffer;
	UINT32 InTransferLength;
	UINT32 OutTransferLength;
	EFI_STATUS TransactionStatus;
};

typedef EFI_STATUS(EFIAPI *EFI_SD_MMC_PASS_THRU_PASSTHRU) (IN EFI_SD_MMC_PASS_THRU_PROTOCOL *This, IN UINT8 Slot, IN OUT EFI_SD_MMC_PASS_THRU_COMMAND_PACKET *Packet, IN EFI_EVENT Event OPTIONAL);
typedef EFI_STATUS(EFIAPI *EFI_SD_MMC_PASS_THRU_GET_NEXT_SLOT) (IN EFI_SD_MMC_PASS_THRU_PROTOCOL *This, IN OUT UINT8 *Slot);
typedef EFI_STATUS(EFIAPI *EFI_SD_MMC_PASS_THRU_BUILD_DEVICE_PATH) (IN EFI_SD_MMC_PASS_THRU_PROTOCOL *This, IN UINT8 Slot, IN OUT EFI_DEVICE_PATH_PROTOCOL **DevicePath);
typedef EFI_STATUS(EFIAPI *EFI_SD_MMC_PASS_THRU_GET_SLOT_NUMBER) (IN EFI_SD_MMC_PASS_THRU_PROTOCOL *This, IN EFI_DEVICE_PATH_PROTOCOL *DevicePath, OUT UINT8 *Slot);
typedef EFI_STATUS(EFIAPI *EFI_SD_MMC_PASS_THRU_RESET_DEVICE) (IN EFI_SD_MMC_PASS_THRU_PROTOCOL *This, IN UINT8 Slot);

struct EFI_SD_MMC_PASS_THRU_PROTOCOL {
	UINTN IoAlign;
	EFI_SD_MMC_PASS_THRU_PASSTHRU PassThru;
	EFI_SD_MMC_PASS_THRU_GET_NEXT_SLOT GetNextSlot;
	EFI_SD_MMC_PASS_THRU_BUILD_DEVICE_PATH BuildDevicePath;
	EFI_SD_MMC_PASS_THRU_GET_SLOT_NUMBER GetSlotNumber;
	EFI_SD_MMC_PASS_THRU_RESET_DEVICE ResetDevice;
};

#define EFI_RAM_DISK_PROTOCOL_GUID \
 { 0xab38a0df, 0x6873, 0x44a9, \
 { 0x87, 0xe6, 0xd4, 0xeb, 0x56, 0x14, 0x84, 0x49 }}

typedef EFI_STATUS(EFIAPI *EFI_RAM_DISK_REGISTER_RAMDISK) (IN UINT64 RamDiskBase, IN UINT64 RamDiskSize, IN EFI_GUID *RamDiskType, IN EFI_DEVICE_PATH_PROTOCOL *ParentDevicePath OPTIONAL, OUT EFI_DEVICE_PATH_PROTOCOL **DevicePath);
typedef EFI_STATUS(EFIAPI *EFI_RAM_DISK_UNREGISTER_RAMDISK) (IN EFI_DEVICE_PATH_PROTOCOL *DevicePath);


struct EFI_RAM_DISK_PROTOCOL {
	EFI_RAM_DISK_REGISTER_RAMDISK Register;
	EFI_RAM_DISK_UNREGISTER_RAMDISK Unregister;
};


#define EFI_PCI_ROOT_BRIDGE_IO_PROTOCOL_GUID \
 {0x2F707EBB,0x4A1A,0x11d4,\
 {0x9A,0x38,0x00,0x90,0x27,0x3F,0xC1,0x4D}}

#define EFI_PCI_ATTRIBUTE_ISA_MOTHERBOARD_IO 0x0001
#define EFI_PCI_ATTRIBUTE_ISA_IO 0x0002
#define EFI_PCI_ATTRIBUTE_VGA_PALETTE_IO 0x0004
#define EFI_PCI_ATTRIBUTE_VGA_MEMORY 0x0008
#define EFI_PCI_ATTRIBUTE_VGA_IO 0x0010
#define EFI_PCI_ATTRIBUTE_IDE_PRIMARY_IO 0x0020
#define EFI_PCI_ATTRIBUTE_IDE_SECONDARY_IO 0x0040
#define EFI_PCI_ATTRIBUTE_MEMORY_WRITE_COMBINE 0x0080
#define EFI_PCI_ATTRIBUTE_MEMORY_CACHED 0x0800
#define EFI_PCI_ATTRIBUTE_MEMORY_DISABLE 0x1000
#define EFI_PCI_ATTRIBUTE_DUAL_ADDRESS_CYCLE 0x8000
#define EFI_PCI_ATTRIBUTE_ISA_IO_16 0x10000
#define EFI_PCI_ATTRIBUTE_VGA_PALETTE_IO_16 0x20000
#define EFI_PCI_ATTRIBUTE_VGA_IO_16 0x40000

typedef enum {
	EfiPciWidthUint8,
	EfiPciWidthUint16,
	EfiPciWidthUint32,
	EfiPciWidthUint64,
	EfiPciWidthFifoUint8,
	EfiPciWidthFifoUint16,
	EfiPciWidthFifoUint32,
	EfiPciWidthFifoUint64,
	EfiPciWidthFillUint8,
	EfiPciWidthFillUint16,
	EfiPciWidthFillUint32,
	EfiPciWidthFillUint64,
	EfiPciWidthMaximum
} EFI_PCI_ROOT_BRIDGE_IO_PROTOCOL_WIDTH;

typedef enum {
	EfiPciOperationBusMasterRead,
	EfiPciOperationBusMasterWrite,
	EfiPciOperationBusMasterCommonBuffer,
	EfiPciOperationBusMasterRead64,
	EfiPciOperationBusMasterWrite64,
	EfiPciOperationBusMasterCommonBuffer64,
	EfiPciOperationMaximum
} EFI_PCI_ROOT_BRIDGE_IO_PROTOCOL_OPERATION;


typedef EFI_STATUS(EFIAPI *EFI_PCI_ROOT_BRIDGE_IO_PROTOCOL_IO_MEM) (IN EFI_PCI_ROOT_BRIDGE_IO_PROTOCOL *This, IN EFI_PCI_ROOT_BRIDGE_IO_PROTOCOL_WIDTH Width, IN UINT64 Address, IN UINTN Count, IN OUT VOID *Buffer);

struct EFI_PCI_ROOT_BRIDGE_IO_PROTOCOL_ACCESS {
	EFI_PCI_ROOT_BRIDGE_IO_PROTOCOL_IO_MEM Read;
	EFI_PCI_ROOT_BRIDGE_IO_PROTOCOL_IO_MEM Write;
};

typedef EFI_STATUS(EFIAPI *EFI_PCI_ROOT_BRIDGE_IO_PROTOCOL_POLL_IO_MEM) (IN EFI_PCI_ROOT_BRIDGE_IO_PROTOCOL *This, IN EFI_PCI_ROOT_BRIDGE_IO_PROTOCOL_WIDTH Width, IN UINT64 Address, IN UINT64 Mask, IN UINT64 Value, IN UINT64 Delay, OUT UINT64 *Result);
typedef EFI_STATUS(EFIAPI *EFI_PCI_ROOT_BRIDGE_IO_PROTOCOL_COPY_MEM) (IN EFI_PCI_ROOT_BRIDGE_IO_PROTOCOL *This, IN EFI_PCI_ROOT_BRIDGE_IO_PROTOCOL_WIDTH Width, IN UINT64 DestAddress, IN UINT64 SrcAddress, IN UINTN Count);
typedef EFI_STATUS(EFIAPI *EFI_PCI_ROOT_BRIDGE_IO_PROTOCOL_MAP) (IN EFI_PCI_ROOT_BRIDGE_IO_PROTOCOL *This, IN EFI_PCI_ROOT_BRIDGE_IO_PROTOCOL_OPERATION Operation, IN VOID *HostAddress, IN OUT UINTN *NumberOfBytes, OUT EFI_PHYSICAL_ADDRESS *DeviceAddress, OUT VOID **Mapping);
typedef EFI_STATUS(EFIAPI *EFI_PCI_ROOT_BRIDGE_IO_PROTOCOL_UNMAP) (IN EFI_PCI_ROOT_BRIDGE_IO_PROTOCOL *This, IN VOID *Mapping);
typedef EFI_STATUS(EFIAPI *EFI_PCI_ROOT_BRIDGE_IO_PROTOCOL_ALLOCATE_BUFFER) (IN EFI_PCI_ROOT_BRIDGE_IO_PROTOCOL *This, IN EFI_ALLOCATE_TYPE Type, IN EFI_MEMORY_TYPE MemoryType, IN UINTN Pages, OUT VOID **HostAddress, IN UINT64 Attributes);
typedef EFI_STATUS(EFIAPI *EFI_PCI_ROOT_BRIDGE_IO_PROTOCOL_FREE_BUFFER) (IN EFI_PCI_ROOT_BRIDGE_IO_PROTOCOL *This, IN UINTN Pages, IN VOID *HostAddress);
typedef EFI_STATUS(EFIAPI *EFI_PCI_ROOT_BRIDGE_IO_PROTOCOL_FLUSH) (IN EFI_PCI_ROOT_BRIDGE_IO_PROTOCOL *This);
typedef EFI_STATUS(EFIAPI *EFI_PCI_ROOT_BRIDGE_IO_PROTOCOL_GET_ATTRIBUTES) (IN EFI_PCI_ROOT_BRIDGE_IO_PROTOCOL *This, OUT UINT64 *Supports OPTIONAL, OUT UINT64 *Attributes OPTIONAL);
typedef EFI_STATUS(EFIAPI *EFI_PCI_ROOT_BRIDGE_IO_PROTOCOL_SET_ATTRIBUTES) (IN EFI_PCI_ROOT_BRIDGE_IO_PROTOCOL *This, IN UINT64 Attributes, IN OUT UINT64 *ResourceBase OPTIONAL, IN OUT UINT64 *ResourceLength OPTIONAL);
typedef EFI_STATUS(EFIAPI *EFI_PCI_ROOT_BRIDGE_IO_PROTOCOL_CONFIGURATION) (IN EFI_PCI_ROOT_BRIDGE_IO_PROTOCOL *This, OUT VOID **Resources);


struct EFI_PCI_ROOT_BRIDGE_IO_PROTOCOL {
	EFI_HANDLE ParentHandle;
	EFI_PCI_ROOT_BRIDGE_IO_PROTOCOL_POLL_IO_MEM PollMem;
	EFI_PCI_ROOT_BRIDGE_IO_PROTOCOL_POLL_IO_MEM PollIo;
	EFI_PCI_ROOT_BRIDGE_IO_PROTOCOL_ACCESS Mem;
	EFI_PCI_ROOT_BRIDGE_IO_PROTOCOL_ACCESS Io;
	EFI_PCI_ROOT_BRIDGE_IO_PROTOCOL_ACCESS Pci;
	EFI_PCI_ROOT_BRIDGE_IO_PROTOCOL_COPY_MEM CopyMem;
	EFI_PCI_ROOT_BRIDGE_IO_PROTOCOL_MAP Map;
	EFI_PCI_ROOT_BRIDGE_IO_PROTOCOL_UNMAP Unmap;
	EFI_PCI_ROOT_BRIDGE_IO_PROTOCOL_ALLOCATE_BUFFER AllocateBuffer;
	EFI_PCI_ROOT_BRIDGE_IO_PROTOCOL_FREE_BUFFER FreeBuffer;
	EFI_PCI_ROOT_BRIDGE_IO_PROTOCOL_FLUSH Flush;
	EFI_PCI_ROOT_BRIDGE_IO_PROTOCOL_GET_ATTRIBUTES GetAttributes;
	EFI_PCI_ROOT_BRIDGE_IO_PROTOCOL_SET_ATTRIBUTES SetAttributes;
	EFI_PCI_ROOT_BRIDGE_IO_PROTOCOL_CONFIGURATION Configuration;
	UINT32 SegmentNumber;
};

#define EFI_PCI_IO_PROTOCOL_GUID \
 {0x4cf5b200,0x68b8,0x4ca5,\
 {0x9e,0xec,0xb2,0x3e,0x3f,0x50,0x02,0x9a}}

#define EFI_PCI_IO_PASS_THROUGH_BAR 0xff

#define EFI_PCI_IO_ATTRIBUTE_ISA_MOTHERBOARD_IO 0x0001
#define EFI_PCI_IO_ATTRIBUTE_ISA_IO 0x0002
#define EFI_PCI_IO_ATTRIBUTE_VGA_PALETTE_IO 0x0004
#define EFI_PCI_IO_ATTRIBUTE_VGA_MEMORY 0x0008
#define EFI_PCI_IO_ATTRIBUTE_VGA_IO 0x0010
#define EFI_PCI_IO_ATTRIBUTE_IDE_PRIMARY_IO 0x0020
#define EFI_PCI_IO_ATTRIBUTE_IDE_SECONDARY_IO 0x0040
#define EFI_PCI_IO_ATTRIBUTE_MEMORY_WRITE_COMBINE 0x0080
#define EFI_PCI_IO_ATTRIBUTE_IO 0x0100
#define EFI_PCI_IO_ATTRIBUTE_MEMORY 0x0200
#define EFI_PCI_IO_ATTRIBUTE_BUS_MASTER 0x0400
#define EFI_PCI_IO_ATTRIBUTE_MEMORY_CACHED 0x0800
#define EFI_PCI_IO_ATTRIBUTE_MEMORY_DISABLE 0x1000
#define EFI_PCI_IO_ATTRIBUTE_EMBEDDED_DEVICE 0x2000
#define EFI_PCI_IO_ATTRIBUTE_EMBEDDED_ROM 0x4000
#define EFI_PCI_IO_ATTRIBUTE_DUAL_ADDRESS_CYCLE 0x8000
#define EFI_PCI_IO_ATTRIBUTE_ISA_IO_16 0x10000
#define EFI_PCI_IO_ATTRIBUTE_VGA_PALETTE_IO_16 0x20000
#define EFI_PCI_IO_ATTRIBUTE_VGA_IO_16 0x40000

typedef enum {
	EfiPciIoWidthUint8,
	EfiPciIoWidthUint16,
	EfiPciIoWidthUint32,
	EfiPciIoWidthUint64,
	EfiPciIoWidthFifoUint8,
	EfiPciIoWidthFifoUint16,
	EfiPciIoWidthFifoUint32,
	EfiPciIoWidthFifoUint64,
	EfiPciIoWidthFillUint8,
	EfiPciIoWidthFillUint16,
	EfiPciIoWidthFillUint32,
	EfiPciIoWidthFillUint64,
	EfiPciIoWidthMaximum
} EFI_PCI_IO_PROTOCOL_WIDTH;

typedef enum {
	EfiPciIoOperationBusMasterRead,
	EfiPciIoOperationBusMasterWrite,
	EfiPciIoOperationBusMasterCommonBuffer,
	EfiPciIoOperationMaximum
} EFI_PCI_IO_PROTOCOL_OPERATION;

typedef EFI_STATUS(EFIAPI *EFI_PCI_IO_PROTOCOL_IO_MEM) (IN EFI_PCI_IO_PROTOCOL *This, IN EFI_PCI_IO_PROTOCOL_WIDTH Width, IN UINT8 BarIndex, IN UINT64 Offset, IN UINTN Count, IN OUT VOID *Buffer);

struct EFI_PCI_IO_PROTOCOL_ACCESS {
	EFI_PCI_IO_PROTOCOL_IO_MEM Read;
	EFI_PCI_IO_PROTOCOL_IO_MEM Write;
};

typedef EFI_STATUS(EFIAPI *EFI_PCI_IO_PROTOCOL_CONFIG) (IN EFI_PCI_IO_PROTOCOL *This, IN EFI_PCI_IO_PROTOCOL_WIDTH Width, IN UINT32 Offset, IN UINTN Count, IN OUT VOID *Buffer);

struct EFI_PCI_IO_PROTOCOL_CONFIG_ACCESS {
	EFI_PCI_IO_PROTOCOL_CONFIG Read;
	EFI_PCI_IO_PROTOCOL_CONFIG Write;
};

typedef enum {
	EfiPciIoAttributeOperationGet,
	EfiPciIoAttributeOperationSet,
	EfiPciIoAttributeOperationEnable,
	EfiPciIoAttributeOperationDisable,
	EfiPciIoAttributeOperationSupported,
	EfiPciIoAttributeOperationMaximum
} EFI_PCI_IO_PROTOCOL_ATTRIBUTE_OPERATION;

typedef EFI_STATUS(EFIAPI *EFI_PCI_IO_PROTOCOL_POLL_IO_MEM) (IN EFI_PCI_IO_PROTOCOL *This, IN EFI_PCI_IO_PROTOCOL_WIDTH Width, IN UINT8 BarIndex, IN UINT64 Offset, IN UINT64 Mask, IN UINT64 Value, IN UINT64 Delay, OUT UINT64 *Result);
typedef EFI_STATUS(EFIAPI *EFI_PCI_IO_PROTOCOL_COPY_MEM) (IN EFI_PCI_IO_PROTOCOL *This, IN EFI_PCI_IO_PROTOCOL_WIDTH Width, IN UINT8 DestBarIndex, IN UINT64 DestOffset, IN UINT8 SrcBarIndex, IN UINT64 SrcOffset, IN UINTN Count);
typedef EFI_STATUS(EFIAPI *EFI_PCI_IO_PROTOCOL_MAP) (IN EFI_PCI_IO_PROTOCOL *This, IN EFI_PCI_IO_PROTOCOL_OPERATION Operation, IN VOID *HostAddress, IN OUT UINTN *NumberOfBytes, OUT EFI_PHYSICAL_ADDRESS *DeviceAddress, OUT VOID **Mapping);
typedef EFI_STATUS(EFIAPI *EFI_PCI_IO_PROTOCOL_UNMAP) (IN EFI_PCI_IO_PROTOCOL *This, IN VOID *Mapping);
typedef EFI_STATUS(EFIAPI *EFI_PCI_IO_PROTOCOL_ALLOCATE_BUFFER) (IN EFI_PCI_IO_PROTOCOL *This, IN EFI_ALLOCATE_TYPE Type, IN EFI_MEMORY_TYPE MemoryType, IN UINTN Pages, OUT VOID **HostAddress, IN UINT64 Attributes);
typedef EFI_STATUS(EFIAPI *EFI_PCI_IO_PROTOCOL_FREE_BUFFER) (IN EFI_PCI_IO_PROTOCOL *This, IN UINTN Pages, IN VOID *HostAddress);
typedef EFI_STATUS(EFIAPI *EFI_PCI_IO_PROTOCOL_FLUSH) (IN EFI_PCI_IO_PROTOCOL *This);
typedef EFI_STATUS(EFIAPI *EFI_PCI_IO_PROTOCOL_GET_LOCATION) (IN EFI_PCI_IO_PROTOCOL *This, OUT UINTN *SegmentNumber, OUT UINTN *BusNumber, OUT UINTN *DeviceNumber, OUT UINTN *FunctionNumber);
typedef EFI_STATUS(EFIAPI *EFI_PCI_IO_PROTOCOL_ATTRIBUTES) (IN EFI_PCI_IO_PROTOCOL *This, IN EFI_PCI_IO_PROTOCOL_ATTRIBUTE_OPERATION Operation, IN UINT64 Attributes, OUT UINT64 *Result OPTIONAL);
typedef EFI_STATUS(EFIAPI *EFI_PCI_IO_PROTOCOL_GET_BAR_ATTRIBUTES) (IN EFI_PCI_IO_PROTOCOL *This, IN UINT8 BarIndex, OUT UINT64 *Supports OPTIONAL, OUT VOID **Resources OPTIONAL);
typedef EFI_STATUS(EFIAPI *EFI_PCI_IO_PROTOCOL_SET_BAR_ATTRIBUTES) (IN EFI_PCI_IO_PROTOCOL *This, IN UINT64 Attributes, IN UINT8 BarIndex, IN OUT UINT64 *Offset, IN OUT UINT64 *Length);


struct EFI_PCI_IO_PROTOCOL {
	EFI_PCI_IO_PROTOCOL_POLL_IO_MEM PollMem;
	EFI_PCI_IO_PROTOCOL_POLL_IO_MEM PollIo;
	EFI_PCI_IO_PROTOCOL_ACCESS Mem;
	EFI_PCI_IO_PROTOCOL_ACCESS Io;
	EFI_PCI_IO_PROTOCOL_CONFIG_ACCESS Pci;
	EFI_PCI_IO_PROTOCOL_COPY_MEM CopyMem;
	EFI_PCI_IO_PROTOCOL_MAP Map;
	EFI_PCI_IO_PROTOCOL_UNMAP Unmap;
	EFI_PCI_IO_PROTOCOL_ALLOCATE_BUFFER AllocateBuffer;
	EFI_PCI_IO_PROTOCOL_FREE_BUFFER FreeBuffer;
	EFI_PCI_IO_PROTOCOL_FLUSH Flush;
	EFI_PCI_IO_PROTOCOL_GET_LOCATION GetLocation;
	EFI_PCI_IO_PROTOCOL_ATTRIBUTES Attributes;
	EFI_PCI_IO_PROTOCOL_GET_BAR_ATTRIBUTES GetBarAttributes;
	EFI_PCI_IO_PROTOCOL_SET_BAR_ATTRIBUTES SetBarAttributes;
	UINT64 RomSize;
	VOID *RomImage;
};

#define EFI_SCSI_IO_PROTOCOL_GUID \
 {0x932f47e6,0x2362,0x4002,\
 {0x80,0x3e,0x3c,0xd5,0x4b,0x13,0x8f,0x85}}

#define EFI_SCSI_IO_TYPE_DISK 0x00		
#define EFI_SCSI_IO_TYPE_TAPE 0x01		
#define EFI_SCSI_IO_TYPE_PRINTER 0x02	
#define EFI_SCSI_IO_TYPE_PROCESSOR 0x03	
#define EFI_SCSI_IO_TYPE_WORM 0x04		
#define EFI_SCSI_IO_TYPE_CDROM 0x05		
#define EFI_SCSI_IO_TYPE_SCANNER 0x06	
#define EFI_SCSI_IO_TYPE_OPTICAL 0x07	
#define EFI_SCSI_IO_TYPE_MEDIUMCHANGER 0x08
#define EFI_SCSI_IO_TYPE_COMMUNICATION 0x09
#define MFI_SCSI_IO_TYPE_A 0x0A			
#define MFI_SCSI_IO_TYPE_B 0x0B			
#define MFI_SCSI_IO_TYPE_RAID 0x0C		
#define MFI_SCSI_IO_TYPE_SES 0x0D 

#define MFI_SCSI_IO_TYPE_RBC 0x0E // Simplified direct-access

#define MFI_SCSI_IO_TYPE_OCRW 0x0F 
#define MFI_SCSI_IO_TYPE_BRIDGE 0x10
#define MFI_SCSI_IO_TYPE_OSD 0x11 
#define EFI_SCSI_IO_TYPE_RESERVED_LOW 0x12 
#define EFI_SCSI_IO_TYPE_RESERVED_HIGH 0x1E
#define EFI_SCSI_IO_TYPE_UNKNOWN 0x1F

#define EFI_SCSI_IO_DATA_DIRECTION_READ 0
#define EFI_SCSI_IO_DATA_DIRECTION_WRITE 1
#define EFI_SCSI_IO_DATA_DIRECTION_BIDIRECTIONAL 2

#define EFI_SCSI_IO_STATUS_HOST_ADAPTER_OK 0x00
#define EFI_SCSI_IO_STATUS_HOST_ADAPTER_TIMEOUT_COMMAND 0x09
#define EFI_SCSI_IO_STATUS_HOST_ADAPTER_TIMEOUT 0x0b
#define EFI_SCSI_IO_STATUS_HOST_ADAPTER_MESSAGE_REJECT 0x0d
#define EFI_SCSI_IO_STATUS_HOST_ADAPTER_BUS_RESET 0x0e
#define EFI_SCSI_IO_STATUS_HOST_ADAPTER_PARITY_ERROR 0x0f
#define EFI_SCSI_IO_STATUS_HOST_ADAPTER_REQUEST_SENSE_FAILED 0x10
#define EFI_SCSI_IO_STATUS_HOST_ADAPTER_SELECTION_TIMEOUT 0x11
#define EFI_SCSI_IO_STATUS_HOST_ADAPTER_DATA_OVERRUN_UNDERRUN 0x12
#define EFI_SCSI_IO_STATUS_HOST_ADAPTER_BUS_FREE 0x13
#define EFI_SCSI_IO_STATUS_HOST_ADAPTER_PHASE_ERROR 0x14
#define EFI_SCSI_IO_STATUS_HOST_ADAPTER_OTHER 0x7f

#define EFI_SCSI_IO_STATUS_TARGET_GOOD 0x00
#define EFI_SCSI_IO_STATUS_TARGET_CHECK_CONDITION 0x02
#define EFI_SCSI_IO_STATUS_TARGET_CONDITION_MET 0x04
#define EFI_SCSI_IO_STATUS_TARGET_BUSY 0x08
#define EFI_SCSI_IO_STATUS_TARGET_INTERMEDIATE 0x10
#define EFI_SCSI_IO_STATUS_TARGET_INTERMEDIATE_CONDITION_MET 0x14
#define EFI_SCSI_IO_STATUS_TARGET_RESERVATION_CONFLICT 0x18
#define EFI_SCSI_IO_STATUS_TARGET_COMMAND_TERMINATED 0x22
#define EFI_SCSI_IO_STATUS_TARGET_QUEUE_FULL 0x28

struct EFI_SCSI_IO_SCSI_REQUEST_PACKET {
	UINT64 Timeout;
	VOID *InDataBuffer;
	VOID *OutDataBuffer;
	VOID *SenseData;
	VOID *Cdb;
	UINT32 InTransferLength;
	UINT32 OutTransferLength;
	UINT8 CdbLength;
	UINT8 DataDirection;
	UINT8 HostAdapterStatus;
	UINT8 TargetStatus;
	UINT8 SenseDataLength;
};

typedef EFI_STATUS(EFIAPI *EFI_SCSI_IO_PROTOCOL_GET_DEVICE_TYPE) (IN EFI_SCSI_IO_PROTOCOL *This, OUT UINT8 *DeviceType);
typedef EFI_STATUS(EFIAPI *EFI_SCSI_IO_PROTOCOL_GET_DEVICE_LOCATION) (IN EFI_SCSI_IO_PROTOCOL *This, IN OUT UINT8 **Target, OUT UINT64 *Lun);
typedef EFI_STATUS(EFIAPI *EFI_SCSI_IO_PROTOCOL_RESET_BUS) (IN EFI_SCSI_IO_PROTOCOL *This);
typedef EFI_STATUS(EFIAPI *EFI_SCSI_IO_PROTOCOL_RESET_DEVICE) (IN EFI_SCSI_IO_PROTOCOL *This);
typedef EFI_STATUS(EFIAPI *EFI_SCSI_IO_PROTOCOL_EXECUTE_SCSI_COMMAND) (IN EFI_SCSI_IO_PROTOCOL *This, IN OUT EFI_SCSI_IO_SCSI_REQUEST_PACKET *Packet, IN EFI_EVENT Event OPTIONAL);

struct EFI_SCSI_IO_PROTOCOL {
	EFI_SCSI_IO_PROTOCOL_GET_DEVICE_TYPE GetDeviceType;
	EFI_SCSI_IO_PROTOCOL_GET_DEVICE_LOCATION GetDeviceLocation;
	EFI_SCSI_IO_PROTOCOL_RESET_BUS ResetBus;
	EFI_SCSI_IO_PROTOCOL_RESET_DEVICE ResetDevice;
	EFI_SCSI_IO_PROTOCOL_EXECUTE_SCSI_COMMAND ExecuteScsiCommand;
	UINT32 IoAlign;
};

#define EFI_EXT_SCSI_PASS_THRU_PROTOCOL_GUID \
 {0x143b7632, 0xb81b, 0x4cb7,\
 {0xab, 0xd3, 0xb6, 0x25, 0xa5, 0xb9, 0xbf, 0xfe}}

#define TARGET_MAX_BYTES0x10
#define EFI_EXT_SCSI_PASS_THRU_ATTRIBUTES_PHYSICAL 0x0001
#define EFI_EXT_SCSI_PASS_THRU_ATTRIBUTES_LOGICAL 0x0002
#define EFI_EXT_SCSI_PASS_THRU_ATTRIBUTES_NONBLOCKIO 0x0004

#define EFI_EXT_SCSI_DATA_DIRECTION_READ 0
#define EFI_EXT_SCSI_DATA_DIRECTION_WRITE 1
#define EFI_EXT_SCSI_DATA_DIRECTION_BIDIRECTIONAL 2

#define EFI_EXT_SCSI_STATUS_HOST_ADAPTER_OK 0x00
#define EFI_EXT_SCSI_STATUS_HOST_ADAPTER_TIMEOUT_COMMAND 0x09
#define EFI_EXT_SCSI_STATUS_HOST_ADAPTER_TIMEOUT 0x0b
#define EFI_EXT_SCSI_STATUS_HOST_ADAPTER_MESSAGE_REJECT 0x0d
#define EFI_EXT_SCSI_STATUS_HOST_ADAPTER_BUS_RESET 0x0e
#define EFI_EXT_SCSI_STATUS_HOST_ADAPTER_PARITY_ERROR 0x0f
#define EFI_EXT_SCSI_STATUS_HOST_ADAPTER_REQUEST_SENSE_FAILED 0x10
#define EFI_EXT_SCSI_STATUS_HOST_ADAPTER_SELECTION_TIMEOUT 0x11
#define EFI_EXT_SCSI_STATUS_HOST_ADAPTER_DATA_OVERRUN_UNDERRUN 0x12
#define EFI_EXT_SCSI_STATUS_HOST_ADAPTER_BUS_FREE 0x13
#define EFI_EXT_SCSI_STATUS_HOST_ADAPTER_PHASE_ERROR 0x14
#define EFI_EXT_SCSI_STATUS_HOST_ADAPTER_OTHER 0x7f

#define EFI_EXT_SCSI_STATUS_TARGET_GOOD 0x00
#define EFI_EXT_SCSI_STATUS_TARGET_CHECK_CONDITION 0x02
#define EFI_EXT_SCSI_STATUS_TARGET_CONDITION_MET 0x04
#define EFI_EXT_SCSI_STATUS_TARGET_BUSY 0x08
#define EFI_EXT_SCSI_STATUS_TARGET_INTERMEDIATE 0x10
#define EFI_EXT_SCSI_STATUS_TARGET_INTERMEDIATE_CONDITION_MET 0x14
#define EFI_EXT_SCSI_STATUS_TARGET_RESERVATION_CONFLICT 0x18
#define EFI_EXT_SCSI_STATUS_TARGET_TASK_SET_FULL 0x28
#define EFI_EXT_SCSI_STATUS_TARGET_ACA_ACTIVE 0x30
#define EFI_EXT_SCSI_STATUS_TARGET_TASK_ABORTED 0x40

struct EFI_EXT_SCSI_PASS_THRU_MODE {
	UINT32 AdapterId;
	UINT32 Attributes;
	UINT32 IoAlign;
};

struct EFI_EXT_SCSI_PASS_THRU_SCSI_REQUEST_PACKET {
	UINT64 Timeout;
	VOID *InDataBuffer;
	VOID *OutDataBuffer;
	VOID *SenseData;
	VOID *Cdb;
	UINT32 InTransferLength;
	UINT32 OutTransferLength;
	UINT8 CdbLength;
	UINT8 DataDirection;
	UINT8 HostAdapterStatus;
	UINT8 TargetStatus;
	UINT8 SenseDataLength;
};

typedef EFI_STATUS(EFIAPI *EFI_EXT_SCSI_PASS_THRU_PASSTHRU) (IN EFI_EXT_SCSI_PASS_THRU_PROTOCOL *This, IN UINT8 *Target, IN UINT64 Lun, IN OUT EFI_EXT_SCSI_PASS_THRU_SCSI_REQUEST_PACKET *Packet, IN EFI_EVENT Event OPTIONAL);
typedef EFI_STATUS(EFIAPI *EFI_EXT_SCSI_PASS_THRU_GET_NEXT_TARGET_LUN) (IN EFI_EXT_SCSI_PASS_THRU_PROTOCOL *This, IN OUT UINT8 **Target, IN OUT UINT64 *Lun);
typedef EFI_STATUS(EFIAPI *EFI_EXT_SCSI_PASS_THRU_BUILD_DEVICE_PATH) (IN EFI_EXT_SCSI_PASS_THRU_PROTOCOL *This, IN UINT8 *Target, IN UINT64 Lun, IN OUT EFI_DEVICE_PATH_PROTOCOL **DevicePath);
typedef EFI_STATUS(EFIAPI *EFI_EXT_SCSI_PASS_THRU_GET_TARGET_LUN) (IN EFI_EXT_SCSI_PASS_THRU_PROTOCOL *This, IN EFI_DEVICE_PATH_PROTOCOL *DevicePath, OUT UINT8 **Target, OUT UINT64 *Lun);
typedef EFI_STATUS(EFIAPI *EFI_EXT_SCSI_PASS_THRU_RESET_CHANNEL) (IN EFI_EXT_SCSI_PASS_THRU_PROTOCOL *This);
typedef EFI_STATUS(EFIAPI *EFI_EXT_SCSI_PASS_THRU_RESET_TARGET_LUN) (IN EFI_EXT_SCSI_PASS_THRU_PROTOCOL *This, IN UINT8 *Target, IN UINT64 Lun);
typedef EFI_STATUS(EFIAPI *EFI_EXT_SCSI_PASS_THRU_GET_NEXT_TARGET) (IN EFI_EXT_SCSI_PASS_THRU_PROTOCOL *This, IN OUT UINT8 **Target);


struct EFI_EXT_SCSI_PASS_THRU_PROTOCOL {
	EFI_EXT_SCSI_PASS_THRU_MODE *Mode;
	EFI_EXT_SCSI_PASS_THRU_PASSTHRU PassThru;
	EFI_EXT_SCSI_PASS_THRU_GET_NEXT_TARGET_LUN GetNextTargetLun;
	EFI_EXT_SCSI_PASS_THRU_BUILD_DEVICE_PATH BuildDevicePath;
	EFI_EXT_SCSI_PASS_THRU_GET_TARGET_LUN GetTargetLun;
	EFI_EXT_SCSI_PASS_THRU_RESET_CHANNEL ResetChannel;
	EFI_EXT_SCSI_PASS_THRU_RESET_TARGET_LUN ResetTargetLun;
	EFI_EXT_SCSI_PASS_THRU_GET_NEXT_TARGET GetNextTarget;
};

#define EFI_ISCSI_INITIATOR_NAME_PROTOCOL_GUID \
 {0x59324945, 0xec44, 0x4c0d, \
 {0xb1, 0xcd, 0x9d, 0xb1, 0x39, 0xdf, 0x07, 0x0c}} 

typedef EFI_STATUS(EFIAPI *EFI_ISCSI_INITIATOR_NAME_GET) (IN EFI_ISCSI_INITIATOR_NAME_PROTOCOL *This, IN OUT UINTN *BufferSize, OUT VOID *Buffer);
typedef EFI_STATUS(EFIAPI *EFI_ISCSI_INITIATOR_NAME_SET) (IN EFI_ISCSI_INITIATOR_NAME_PROTOCOL *This, IN OUT UINTN *BufferSize, IN VOID *Buffer);

struct EFI_ISCSI_INITIATOR_NAME_PROTOCOL {
	EFI_ISCSI_INITIATOR_NAME_GET Get;
	EFI_ISCSI_INITIATOR_NAME_SET Set;
};

#define EFI_USB2_HC_PROTOCOL_GUID \
 {0x3e745226,0x9818,0x45b6,\
 {0xa2,0xac,0xd7,0xcd,0x0e,0x8b,0xa2,0xbc}}

#define EFI_USB_SPEED_FULL 0x0000
#define EFI_USB_SPEED_LOW 0x0001
#define EFI_USB_SPEED_HIGH 0x0002
#define EFI_USB_SPEED_SUPER 0x0003

#define EFI_USB_HC_RESET_GLOBAL 0x0001
#define EFI_USB_HC_RESET_HOST_CONTROLLER 0x0002
#define EFI_USB_HC_RESET_GLOBAL_WITH_DEBUG 0x0004
#define EFI_USB_HC_RESET_HOST_WITH_DEBUG 0x0008

#define EFI_USB_MAX_ISO_BUFFER_NUM 7
#define EFI_USB_MAX_ISO_BUFFER_NUM1 2

#define USB_PORT_STAT_CONNECTION 0x0001
#define USB_PORT_STAT_ENABLE 0x0002
#define USB_PORT_STAT_SUSPEND 0x0004
#define USB_PORT_STAT_OVERCURRENT 0x0008
#define USB_PORT_STAT_RESET 0x0010
#define USB_PORT_STAT_POWER 0x0100
#define USB_PORT_STAT_LOW_SPEED 0x0200
#define USB_PORT_STAT_HIGH_SPEED 0x0400
#define USB_PORT_STAT_SUPER_SPEED 0x0800
#define USB_PORT_STAT_OWNER 0x2000

#define USB_PORT_STAT_C_CONNECTION 0x0001
#define USB_PORT_STAT_C_ENABLE 0x0002
#define USB_PORT_STAT_C_SUSPEND 0x0004
#define USB_PORT_STAT_C_OVERCURRENT 0x0008
#define USB_PORT_STAT_C_RESET 0x0010

typedef enum {
	EfiUsbHcStateHalt,
	EfiUsbHcStateOperational,
	EfiUsbHcStateSuspend,
	EfiUsbHcStateMaximum
} EFI_USB_HC_STATE;

struct EFI_USB2_HC_TRANSACTION_TRANSLATOR {
	UINT8 TranslatorHubAddress;
	UINT8 TranslatorPortNumber;
};

struct EFI_USB_PORT_STATUS {
	UINT16 PortStatus;
	UINT16 PortChangeStatus;
};

typedef enum {
	EfiUsbPortEnable = 1,
	EfiUsbPortSuspend = 2,
	EfiUsbPortReset = 4,
	EfiUsbPortPower = 8,
	EfiUsbPortOwner = 13,
	EfiUsbPortConnectChange = 16,
	EfiUsbPortEnableChange = 17,
	EfiUsbPortSuspendChange = 18,
	EfiUsbPortOverCurrentChange = 19,
	EfiUsbPortResetChange = 20
} EFI_USB_PORT_FEATURE;

typedef enum {
	EfiUsbDataIn,
	EfiUsbDataOut,
	EfiUsbNoData
} EFI_USB_DATA_DIRECTION;

typedef EFI_STATUS(EFIAPI * EFI_ASYNC_USB_TRANSFER_CALLBACK) (IN VOID *Data, IN UINTN DataLength, IN VOID *Context, IN UINT32 Status);

typedef EFI_STATUS(EFIAPI *EFI_USB2_HC_PROTOCOL_GET_CAPABILITY) (IN EFI_USB2_HC_PROTOCOL *This, OUT UINT8 *MaxSpeed, OUT UINT8 *PortNumber, OUT UINT8 *Is64BitCapable);
typedef EFI_STATUS(EFIAPI *EFI_USB2_HC_PROTOCOL_RESET) (IN EFI_USB2_HC_PROTOCOL *This, IN UINT16 Attributes);
typedef EFI_STATUS(EFIAPI *EFI_USB2_HC_PROTOCOL_GET_STATE) (IN EFI_USB2_HC_PROTOCOL *This, OUT EFI_USB_HC_STATE *State);
typedef EFI_STATUS(EFIAPI *EFI_USB2_HC_PROTOCOL_SET_STATE) (IN EFI_USB2_HC_PROTOCOL *This, IN EFI_USB_HC_STATE State);
typedef EFI_STATUS(EFIAPI *EFI_USB2_HC_PROTOCOL_CONTROL_TRANSFER) (IN EFI_USB2_HC_PROTOCOL *This, IN UINT8 DeviceAddress, IN UINT8 DeviceSpeed, IN UINTN MaximumPacketLength, IN EFI_USB_DEVICE_REQUEST *Request, IN EFI_USB_DATA_DIRECTION TransferDirection, IN OUT VOID *Data OPTIONAL, IN OUT UINTN *DataLength OPTIONAL, IN UINTN TimeOut, IN EFI_USB2_HC_TRANSACTION_TRANSLATOR *Translator, OUT UINT32 *TransferResult);
typedef EFI_STATUS(EFIAPI *EFI_USB2_HC_PROTOCOL_BULK_TRANSFER) (IN EFI_USB2_HC_PROTOCOL *This, IN UINT8 DeviceAddress, IN UINT8 EndPointAddress, IN UINT8 DeviceSpeed, IN UINTN MaximumPacketLength, IN UINT8 DataBuffersNumber, IN OUT VOID *Data, IN OUT UINTN *DataLength, IN OUT UINT8 *DataToggle, IN UINTN TimeOut, IN EFI_USB2_HC_TRANSACTION_TRANSLATOR *Translator, OUT UINT32 *TransferResult);
typedef EFI_STATUS(EFIAPI *EFI_USB2_HC_PROTOCOL_ASYNC_INTERRUPT_TRANSFER) (IN EFI_USB2_HC_PROTOCOL *This, IN UINT8 DeviceAddress, IN UINT8 EndPointAddress, IN UINT8 DeviceSpeed, IN UINTN MaximumPacketLength, IN BOOLEAN IsNewTransfer, IN OUT UINT8 *DataToggle, IN UINTN PollingInterval OPTIONAL, IN UINTN DataLength OPTIONAL, IN EFI_USB2_HC_TRANSACTION_TRANSLATOR *Translator OPTIONAL, IN EFI_ASYNC_USB_TRANSFER_CALLBACK CallBackFunction OPTIONAL, IN VOID *Context OPTIONAL);
typedef EFI_STATUS(EFIAPI *EFI_USB2_HC_PROTOCOL_SYNC_INTERRUPT_TRANSFER) (IN EFI_USB2_HC_PROTOCOL *This, IN UINT8 DeviceAddress, IN UINT8 EndPointAddress, IN UINT8 DeviceSpeed, IN UINTN MaximumPacketLength, IN OUT VOID *Data, IN OUT UINTN *DataLength, IN OUT UINT8 *DataToggle, IN UINTN TimeOut, IN EFI_USB2_HC_TRANSACTION_TRANSLATOR *Translator, OUT UINT32 *TransferResult);
typedef EFI_STATUS(EFIAPI *EFI_USB2_HC_PROTOCOL_ISOCHRONOUS_TRANSFER) (IN EFI_USB2_HC_PROTOCOL *This, IN UINT8 DeviceAddress, IN UINT8 EndPointAddress, IN UINT8 DeviceSpeed, IN UINTN MaximumPacketLength, IN UINT8 DataBuffersNumber, IN OUT VOID *Data, IN UINTN DataLength, IN EFI_USB2_HC_TRANSACTION_TRANSLATOR *Translator, OUT UINT32 *TransferResult);
typedef EFI_STATUS(EFIAPI *EFI_USB2_HC_PROTOCOL_ASYNC_ISOCHRONOUS_TRANSFER) (IN EFI_USB2_HC_PROTOCOL *This, IN UINT8 DeviceAddress, IN UINT8 EndPointAddress, IN UINT8 DeviceSpeed, IN UINTN MaximumPacketLength, IN UINT8 DataBuffersNumber, IN OUT VOID *Data, IN UINTN DataLength, IN EFI_USB2_HC_TRANSACTION_TRANSLATOR *Translator, IN EFI_ASYNC_USB_TRANSFER_CALLBACK IsochronousCallBack, IN VOID *Context OPTIONAL);
typedef EFI_STATUS(EFIAPI *EFI_USB2_HC_PROTOCOL_GET_ROOTHUB_PORT_STATUS) (IN EFI_USB2_HC_PROTOCOL *This, IN UINT8 PortNumber, OUT EFI_USB_PORT_STATUS *PortStatus);
typedef EFI_STATUS(EFIAPI *EFI_USB2_HC_PROTOCOL_SET_ROOTHUB_PORT_FEATURE) (IN EFI_USB2_HC_PROTOCOL *This, IN UINT8 PortNumber, IN EFI_USB_PORT_FEATURE PortFeature);
typedef EFI_STATUS(EFIAPI *EFI_USB2_HC_PROTOCOL_CLEAR_ROOTHUB_PORT_FEATURE) (IN EFI_USB2_HC_PROTOCOL *This, IN UINT8 PortNumber, IN EFI_USB_PORT_FEATURE PortFeature);

struct EFI_USB2_HC_PROTOCOL {
	EFI_USB2_HC_PROTOCOL_GET_CAPABILITY GetCapability;
	EFI_USB2_HC_PROTOCOL_RESET Reset;
	EFI_USB2_HC_PROTOCOL_GET_STATE GetState;
	EFI_USB2_HC_PROTOCOL_SET_STATE SetState;
	EFI_USB2_HC_PROTOCOL_CONTROL_TRANSFER ControlTransfer;
	EFI_USB2_HC_PROTOCOL_BULK_TRANSFER BulkTransfer;
	EFI_USB2_HC_PROTOCOL_ASYNC_INTERRUPT_TRANSFER AsyncInterruptTransfer;
	EFI_USB2_HC_PROTOCOL_SYNC_INTERRUPT_TRANSFER SyncInterruptTransfer;
	EFI_USB2_HC_PROTOCOL_ISOCHRONOUS_TRANSFER IsochronousTransfer;
	EFI_USB2_HC_PROTOCOL_ASYNC_ISOCHRONOUS_TRANSFER AsyncIsochronousTransfer;
	EFI_USB2_HC_PROTOCOL_GET_ROOTHUB_PORT_STATUS GetRootHubPortStatus;
	EFI_USB2_HC_PROTOCOL_SET_ROOTHUB_PORT_FEATURE SetRootHubPortFeature;
	EFI_USB2_HC_PROTOCOL_CLEAR_ROOTHUB_PORT_FEATURE ClearRootHubPortFeature;
	UINT16 MajorRevision;
	UINT16 MinorRevision;
};

#define EFI_USB_IO_PROTOCOL_GUID \
 {0x2B2F68D6,0x0CD2,0x44cf,\
 {0x8E,0x8B,0xBB,0xA2,0x0B,0x1B,0x5B,0x75}}

#define EFI_USB_NOERROR 0x0000
#define EFI_USB_ERR_NOTEXECUTE 0x0001
#define EFI_USB_ERR_STALL 0x0002
#define EFI_USB_ERR_BUFFER 0x0004
#define EFI_USB_ERR_BABBLE 0x0008
#define EFI_USB_ERR_NAK 0x0010
#define EFI_USB_ERR_CRC 0x0020
#define EFI_USB_ERR_TIMEOUT 0x0040
#define EFI_USB_ERR_BITSTUFF 0x0080
#define EFI_USB_ERR_SYSTEM 0x0100

struct EFI_USB_DEVICE_REQUEST {
	UINT8 RequestType;
	UINT8 Request;
	UINT16 Value;
	UINT16 Index;
	UINT16 Length;
};

struct EFI_USB_DEVICE_DESCRIPTOR {
	UINT8 Length;
	UINT8 DescriptorType;
	UINT16 BcdUSB;
	UINT8 DeviceClass;
	UINT8 DeviceSubClass;
	UINT8 DeviceProtocol;
	UINT8 MaxPacketSize0;
	UINT16 IdVendor;
	UINT16 IdProduct;
	UINT16 BcdDevice;
	UINT8 StrManufacturer;
	UINT8 StrProduct;
	UINT8 StrSerialNumber;
	UINT8 NumConfigurations;
};

struct EFI_USB_CONFIG_DESCRIPTOR {
	UINT8 Length;
	UINT8 DescriptorType;
	UINT16 TotalLength;
	UINT8 NumInterfaces;
	UINT8 ConfigurationValue;
	UINT8 Configuration;
	UINT8 Attributes;
	UINT8 MaxPower;
};

struct EFI_USB_INTERFACE_DESCRIPTOR {
	UINT8 Length;
	UINT8 DescriptorType;
	UINT8 InterfaceNumber;
	UINT8 AlternateSetting;
	UINT8 NumEndpoints;
	UINT8 InterfaceClass;
	UINT8 InterfaceSubClass;
	UINT8 InterfaceProtocol;
	UINT8 Interface;
};

struct EFI_USB_ENDPOINT_DESCRIPTOR {
	UINT8 Length;
	UINT8 DescriptorType;
	UINT8 EndpointAddress;
	UINT8 Attributes;
	UINT16 MaxPacketSize;
	UINT8 Interval;
};

typedef EFI_STATUS(EFIAPI *EFI_USB_IO_CONTROL_TRANSFER) (IN EFI_USB_IO_PROTOCOL *This, IN EFI_USB_DEVICE_REQUEST *Request, IN EFI_USB_DATA_DIRECTION Direction, IN UINT32 Timeout, IN OUT VOID *Data OPTIONAL, IN UINTN DataLength OPTIONAL, OUT UINT32 *Status);
typedef EFI_STATUS(EFIAPI *EFI_USB_IO_BULK_TRANSFER) (IN EFI_USB_IO_PROTOCOL *This, IN UINT8 DeviceEndpoint, IN OUT VOID *Data, IN OUT UINTN *DataLength, IN UINTN Timeout, OUT UINT32 *Status);
typedef EFI_STATUS(EFIAPI *EFI_USB_IO_ASYNC_INTERRUPT_TRANSFER) (IN EFI_USB_IO_PROTOCOL *This, IN UINT8 DeviceEndpoint, IN BOOLEAN IsNewTransfer, IN UINTN PollingInterval OPTIONAL, IN UINTN DataLength OPTIONAL, IN EFI_ASYNC_USB_TRANSFER_CALLBACK InterruptCallBack OPTIONAL, IN VOID *Context OPTIONAL);
typedef EFI_STATUS(EFIAPI *EFI_USB_IO_SYNC_INTERRUPT_TRANSFER) (IN EFI_USB_IO_PROTOCOL *This, IN UINT8 DeviceEndpoint, IN OUT VOID *Data, IN OUT UINTN *DataLength, IN UINTN Timeout, OUT UINT32 *Status);
typedef EFI_STATUS(EFIAPI *EFI_USB_IO_ISOCHRONOUS_TRANSFER) (IN EFI_USB_IO_PROTOCOL *This, IN UINT8 DeviceEndpoint, IN OUT VOID *Data, IN UINTN DataLength, OUT UINT32 *Status);
typedef EFI_STATUS(EFIAPI *EFI_USB_IO_ASYNC_ISOCHRONOUS_TRANSFER) (IN EFI_USB_IO_PROTOCOL *This, IN UINT8 DeviceEndpoint, IN OUT VOID *Data, IN UINTN DataLength, IN EFI_ASYNC_USB_TRANSFER_CALLBACK IsochronousCallBack, IN VOID *Context OPTIONAL);
typedef EFI_STATUS(EFIAPI *EFI_USB_IO_GET_DEVICE_DESCRIPTOR) (IN EFI_USB_IO_PROTOCOL *This, OUT EFI_USB_DEVICE_DESCRIPTOR *DeviceDescriptor);
typedef EFI_STATUS(EFIAPI *EFI_USB_IO_GET_CONFIG_DESCRIPTOR) (IN EFI_USB_IO_PROTOCOL *This, OUT EFI_USB_CONFIG_DESCRIPTOR *ConfigurationDescriptor);
typedef EFI_STATUS(EFIAPI *EFI_USB_IO_GET_INTERFACE_DESCRIPTOR) (IN EFI_USB_IO_PROTOCOL *This, OUT EFI_USB_INTERFACE_DESCRIPTOR *InterfaceDescriptor);
typedef EFI_STATUS(EFIAPI *EFI_USB_IO_GET_ENDPOINT_DESCRIPTOR) (IN EFI_USB_IO_PROTOCOL *This, IN UINT8 EndpointIndex, OUT EFI_USB_ENDPOINT_DESCRIPTOR *EndpointDescriptor);
typedef EFI_STATUS(EFIAPI *EFI_USB_IO_GET_STRING_DESCRIPTOR) (IN EFI_USB_IO_PROTOCOL *This, IN UINT16 LangID, IN UINT8 StringID, OUT CHAR16 **String);
typedef EFI_STATUS(EFIAPI *EFI_USB_IO_GET_SUPPORTED_LANGUAGES) (IN EFI_USB_IO_PROTOCOL *This, OUT UINT16 **LangIDTable, OUT UINT16 *TableSize);
typedef EFI_STATUS(EFIAPI *EFI_USB_IO_PORT_RESET) (IN EFI_USB_IO_PROTOCOL *This);

struct EFI_USB_IO_PROTOCOL {
	EFI_USB_IO_CONTROL_TRANSFER UsbControlTransfer;
	EFI_USB_IO_BULK_TRANSFER UsbBulkTransfer;
	EFI_USB_IO_ASYNC_INTERRUPT_TRANSFER UsbAsyncInterruptTransfer;
	EFI_USB_IO_SYNC_INTERRUPT_TRANSFER UsbSyncInterruptTransfer;
	EFI_USB_IO_ISOCHRONOUS_TRANSFER UsbIsochronousTransfer;
	EFI_USB_IO_ASYNC_ISOCHRONOUS_TRANSFER UsbAsyncIsochronousTransfer;
	EFI_USB_IO_GET_DEVICE_DESCRIPTOR UsbGetDeviceDescriptor;
	EFI_USB_IO_GET_CONFIG_DESCRIPTOR UsbGetConfigDescriptor;
	EFI_USB_IO_GET_INTERFACE_DESCRIPTOR UsbGetInterfaceDescriptor;
	EFI_USB_IO_GET_ENDPOINT_DESCRIPTOR UsbGetEndpointDescriptor;
	EFI_USB_IO_GET_STRING_DESCRIPTOR UsbGetStringDescriptor;
	EFI_USB_IO_GET_SUPPORTED_LANGUAGES UsbGetSupportedLanguages;
	EFI_USB_IO_PORT_RESET UsbPortReset;
};


#define EFI_USBFN_IO_PROTOCOL_GUID \
 {0x32d2963a, 0xfe5d, 0x4f30,\
 {0xb6, 0x33, 0x6e, 0x5d, 0xc5, 0x58, 0x3, 0xcc}};

#define EFI_USBFN_IO_PROTOCOL_REVISION 0x00010001

typedef enum _EFI_USBFN_PORT_TYPE {
	EfiUsbUnknownPort = 0,
	EfiUsbStandardDownstreamPort,
	EfiUsbChargingDownstreamPort,
	EfiUsbDedicatedChargingPort, 
	EfiUsbInvalidDedicatedChargingPort
} EFI_USBFN_PORT_TYPE;

typedef enum EFI_USB_ENDPOINT_TYPE {
		UsbEndpointControl = 0x00, 
			// UsbEndpointIsochronous = 0x01,
			UsbEndpointBulk = 0x02,
			// UsbEndpointInterrupt = 0x03
} EFI_USB_ENDPOINT_TYPE;

typedef enum _EFI_USBFN_DEVICE_INFO_ID	{
		EfiUsbDeviceInfoUnknown = 0, 
		EfiUsbDeviceInfoSerialNumber,
		EfiUsbDeviceInfoManufacturerName,
		EfiUsbDeviceInfoProductName
} EFI_USBFN_DEVICE_INFO_ID;

typedef enum EFI_USBFN_ENDPOINT_DIRECTION {
		EfiUsbEndpointDirectionHostOut = 0,
		EfiUsbEndpointDirectionHostIn, 
		EfiUsbEndpointDirectionDeviceTx = EfiUsbEndpointDirectionHostIn, 
		EfiUsbEndpointDirectionDeviceRx = EfiUsbEndpointDirectionHostOut
	} EFI_USBFN_ENDPOINT_DIRECTION;

struct EFI_USB_INTERFACE_INFO {
	EFI_USB_INTERFACE_DESCRIPTOR *InterfaceDescriptor;
	EFI_USB_ENDPOINT_DESCRIPTOR **EndpointDescriptorTable;
};

struct EFI_USB_CONFIG_INFO {
	EFI_USB_CONFIG_DESCRIPTOR *ConfigDescriptor;
	EFI_USB_INTERFACE_INFO **InterfaceInfoTable;
};

struct EFI_USB_DEVICE_INFO {
	EFI_USB_DEVICE_DESCRIPTOR *DeviceDescriptor;
	EFI_USB_CONFIG_INFO **ConfigInfoTable;
};

typedef enum _EFI_USBFN_MESSAGE {
	EfiUsbMsgNone = 0,
	EfiUsbMsgSetupPacket,
	EfiUsbMsgEndpointStatusChangedRx,
	EfiUsbMsgEndpointStatusChangedTx,
	EfiUsbMsgBusEventDetach,
	EfiUsbMsgBusEventAttach,
	EfiUsbMsgBusEventReset, 
	EfiUsbMsgBusEventSuspend,
	EfiUsbMsgBusEventResume,
	EfiUsbMsgBusEventSpeed
} EFI_USBFN_MESSAGE;

typedef enum EFI_USBFN_TRANSFER_STATUS {
	UsbTransferStatusUnknown = 0, 
	UsbTransferStatusComplete, 
	UsbTransferStatusAborted, 
	UsbTransferStatusActive, 
	UsbTransferStatusNone
} EFI_USBFN_TRANSFER_STATUS;

typedef enum _EFI_USB_BUS_SPEED {
	UsbBusSpeedUnknown = 0, 
	UsbBusSpeedLow, 
	UsbBusSpeedFull,
	UsbBusSpeedHigh,
	UsbBusSpeedSuper,
	UsbBusSpeedMaximum = UsbBusSpeedSuper
} EFI_USB_BUS_SPEED;

typedef enum EFI_USBFN_POLICY_TYPE {
		EfiUsbPolicyUndefined = 0, 
		EfiUsbPolicyMaxTransactionSize, 
		EfiUsbPolicyZeroLengthTerminationSupport, 
		EfiUsbPolicyZeroLengthTermination
	} EFI_USBFN_POLICY_TYPE;

struct EFI_USBFN_TRANSFER_RESULT {
		UINTN BytesTransferred; 
		EFI_USBFN_TRANSFER_STATUS TransferStatus; 
		UINT8 EndpointIndex; 
		EFI_USBFN_ENDPOINT_DIRECTION Direction; 
		VOID *Buffer; 
};

typedef union EFI_USBFN_MESSAGE_PAYLOAD {
		EFI_USB_DEVICE_REQUEST udr; 
		EFI_USBFN_TRANSFER_RESULT utr; 
		EFI_USB_BUS_SPEED ubs; 
} EFI_USBFN_MESSAGE_PAYLOAD;

typedef EFI_STATUS(EFIAPI *EFI_USBFN_IO_DETECT_PORT) (IN EFI_USBFN_IO_PROTOCOL *This, OUT EFI_USBFN_PORT_TYPE *PortType);
typedef EFI_STATUS(EFIAPI *EFI_USBFN_IO_CONFIGURE_ENABLE_ENDPOINTS) (IN EFI_USBFN_IO_PROTOCOL *This, IN EFI_USB_DEVICE_INFO *DeviceInfo);
typedef EFI_STATUS(EFIAPI *EFI_USBFN_IO_GET_ENDPOINT_MAXPACKET_SIZE) (IN EFI_USBFN_IO_PROTOCOL *This, IN EFI_USB_ENDPOINT_TYPE EndpointType, IN EFI_USB_BUS_SPEED BusSpeed, OUT UINT16 *MaxPacketSize);
typedef EFI_STATUS(EFIAPI *EFI_USBFN_IO_GET_DEVICE_INFO) (IN EFI_USBFN_IO_PROTOCOL *This, IN EFI_USBFN_DEVICE_INFO_ID Id, IN OUT UINTN *BufferSize, OUT VOID *Buffer OPTIONAL);
typedef EFI_STATUS(EFIAPI *EFI_USBFN_IO_GET_VENDOR_ID_PRODUCT_ID) (IN EFI_USBFN_IO_PROTOCOL *This, OUT UINT16 *Vid, OUT UINT16 *Pid);
typedef EFI_STATUS(EFIAPI *EFI_USBFN_IO_ABORT_TRANSFER) (IN EFI_USBFN_IO_PROTOCOL *This, IN UINT8 EndpointIndex, IN EFI_USBFN_ENDPOINT_DIRECTION Direction);
typedef EFI_STATUS(EFIAPI *EFI_USBFN_IO_GET_ENDPOINT_STALL_STATE) (IN EFI_USBFN_IO_PROTOCOL *This, IN UINT8 EndpointIndex, IN EFI_USBFN_ENDPOINT_DIRECTION Direction, IN OUT BOOLEAN *State);
typedef EFI_STATUS(EFIAPI *EFI_USBFN_IO_SET_ENDPOINT_STALL_STATE) (IN EFI_USBFN_IO_PROTOCOL *This, IN UINT8 EndpointIndex, IN EFI_USBFN_ENDPOINT_DIRECTION Direction, IN BOOLEAN State);
typedef EFI_STATUS(EFIAPI *EFI_USBFN_IO_EVENTHANDLER) (IN EFI_USBFN_IO_PROTOCOL *This, OUT EFI_USBFN_MESSAGE *Message, IN OUT UINTN *PayloadSize, OUT EFI_USBFN_MESSAGE_PAYLOAD *Payload);
typedef EFI_STATUS(EFIAPI *EFI_USBFN_IO_TRANSFER) (IN EFI_USBFN_IO_PROTOCOL *This, IN UINT8 EndpointIndex, IN EFI_USBFN_ENDPOINT_DIRECTION Direction, IN OUT UINTN *BufferSize, IN OUT VOID *Buffer);
typedef EFI_STATUS(EFIAPI *EFI_USBFN_IO_GET_MAXTRANSFER_SIZE) (IN EFI_USBFN_IO_PROTOCOL *This, OUT UINTN *MaxTransferSize);
typedef EFI_STATUS(EFIAPI *EFI_USBFN_IO_ALLOCATE_TRANSFER_BUFFER) (IN EFI_USBFN_IO_PROTOCOL *This, IN UINTN Size, OUT VOID **Buffer);
typedef EFI_STATUS(EFIAPI *EFI_USBFN_IO_FREE_TRANSFER_BUFFER) (IN EFI_USBFN_IO_PROTOCOL *This, IN VOID *Buffer);
typedef EFI_STATUS(EFIAPI *EFI_USBFN_IO_START_CONTROLLER) (IN EFI_USBFN_IO_PROTOCOL *This);
typedef EFI_STATUS(EFIAPI *EFI_USBFN_IO_STOP_CONTROLLER) (IN EFI_USBFN_IO_PROTOCOL *This);
typedef EFI_STATUS(EFIAPI *EFI_USBFN_IO_SET_ENDPOINT_POLICY) (IN EFI_USBFN_IO_PROTOCOL *This, IN UINT8 EndpointIndex,	IN EFI_USBFN_ENDPOINT_DIRECTION Direction, IN EFI_USBFN_POLICY_TYPE PolicyType, IN UINTN BufferSize, IN VOID *Buffer);
typedef EFI_STATUS(EFIAPI *EFI_USBFN_IO_GET_ENDPOINT_POLICY) (IN EFI_USBFN_IO_PROTOCOL *This, IN UINT8 EndpointIndex,	IN EFI_USBFN_ENDPOINT_DIRECTION Direction, IN EFI_USBFN_POLICY_TYPE PolicyType, IN OUT UINTN *BufferSize, IN OUT VOID *Buffer);

struct EFI_USBFN_IO_PROTOCOL {
	UINT32 Revision;
	EFI_USBFN_IO_DETECT_PORT DetectPort;
	EFI_USBFN_IO_CONFIGURE_ENABLE_ENDPOINTS ConfigureEnableEndpoints;
	EFI_USBFN_IO_GET_ENDPOINT_MAXPACKET_SIZE GetEndpointMaxPacketSize;
	EFI_USBFN_IO_GET_DEVICE_INFO GetDeviceInfo;
	EFI_USBFN_IO_GET_VENDOR_ID_PRODUCT_ID GetVendorIdProductId;
	EFI_USBFN_IO_ABORT_TRANSFER AbortTransfer;
	EFI_USBFN_IO_GET_ENDPOINT_STALL_STATE GetEndpointStallState;
	EFI_USBFN_IO_SET_ENDPOINT_STALL_STATE SetEndpointStallState;
	EFI_USBFN_IO_EVENTHANDLER EventHandler;
	EFI_USBFN_IO_TRANSFER Transfer;
	EFI_USBFN_IO_GET_MAXTRANSFER_SIZE GetMaxTransferSize;
	EFI_USBFN_IO_ALLOCATE_TRANSFER_BUFFER AllocateTransferBuffer;
	EFI_USBFN_IO_FREE_TRANSFER_BUFFER FreeTransferBuffer;
	EFI_USBFN_IO_START_CONTROLLER StartController;
	EFI_USBFN_IO_STOP_CONTROLLER StopController;
	EFI_USBFN_IO_SET_ENDPOINT_POLICY SetEndpointPolicy;
	EFI_USBFN_IO_GET_ENDPOINT_POLICY GetEndpointPolicy;
};

#define EFI_DEBUG_SUPPORT_PROTOCOL_GUID \
 {0x2755590C,0x6F3C,0x42FA,\
 {0x9E,0xA4,0xA3,0xBA,0x54,0x3C,0xDA,0x25}}

#define IMAGE_FILE_MACHINE_I386 0x014C
#define IMAGE_FILE_MACHINE_X64 0x8664
#define IMAGE_FILE_MACHINE_IA64 0x0200
#define IMAGE_FILE_MACHINE_EBC 0x0EBC
#define IMAGE_FILE_MACHINE_ARMTHUMB_MIXED 0x1C2
#define IMAGE_FILE_MACHINE_AARCH64 0xAA64

// EBC Exception types
#define EXCEPT_EBC_UNDEFINED 0
#define EXCEPT_EBC_DIVIDE_ERROR 1
#define EXCEPT_EBC_DEBUG 2
#define EXCEPT_EBC_BREAKPOINT 3
#define EXCEPT_EBC_OVERFLOW 4
#define EXCEPT_EBC_INVALID_OPCODE 5
#define EXCEPT_EBC_STACK_FAULT 6
#define EXCEPT_EBC_ALIGNMENT_CHECK 7
#define EXCEPT_EBC_INSTRUCTION_ENCODING 8
#define EXCEPT_EBC_BAD_BREAK 9
#define EXCEPT_EBC_SINGLE_STEP 10
// IA-32 Exception types
#define EXCEPT_IA32_DIVIDE_ERROR 0
#define EXCEPT_IA32_DEBUG 1
#define EXCEPT_IA32_NMI 2
#define EXCEPT_IA32_BREAKPOINT 3
#define EXCEPT_IA32_OVERFLOW 4
#define EXCEPT_IA32_BOUND 5
#define EXCEPT_IA32_INVALID_OPCODE 6
#define EXCEPT_IA32_DOUBLE_FAULT 8
#define EXCEPT_IA32_INVALID_TSS 10
#define EXCEPT_IA32_SEG_NOT_PRESENT 11
#define EXCEPT_IA32_STACK_FAULT 12
#define EXCEPT_IA32_GP_FAULT 13
#define EXCEPT_IA32_PAGE_FAULT 14
#define EXCEPT_IA32_FP_ERROR 16
#define EXCEPT_IA32_ALIGNMENT_CHECK 17
#define EXCEPT_IA32_MACHINE_CHECK 18
#define EXCEPT_IA32_SIMD 19
//
// X64 Exception types
//
#define EXCEPT_X64_DIVIDE_ERROR 0
#define EXCEPT_X64_DEBUG 1
#define EXCEPT_X64_NMI 2
#define EXCEPT_X64_BREAKPOINT 3
#define EXCEPT_X64_OVERFLOW 4
#define EXCEPT_X64_BOUND 5
#define EXCEPT_X64_INVALID_OPCODE 6
#define EXCEPT_X64_DOUBLE_FAULT 8
#define EXCEPT_X64_INVALID_TSS 10
#define EXCEPT_X64_SEG_NOT_PRESENT 11
#define EXCEPT_X64_STACK_FAULT 12
#define EXCEPT_X64_GP_FAULT 13
#define EXCEPT_X64_PAGE_FAULT 14
#define EXCEPT_X64_FP_ERROR 16
#define EXCEPT_X64_ALIGNMENT_CHECK 17
#define EXCEPT_X64_MACHINE_CHECK 18
#define EXCEPT_X64_SIMD 19
// Itanium Processor Family Exception types
#define EXCEPT_IPF_VHTP_TRANSLATION 0
#define EXCEPT_IPF_INSTRUCTION_TLB 1
#define EXCEPT_IPF_DATA_TLB 2
#define EXCEPT_IPF_ALT_INSTRUCTION_TLB 3
#define EXCEPT_IPF_ALT_DATA_TLB 4
#define EXCEPT_IPF_DATA_NESTED_TLB 5
#define EXCEPT_IPF_INSTRUCTION_KEY_MISSED 6
#define EXCEPT_IPF_DATA_KEY_MISSED 7
#define EXCEPT_IPF_DIRTY_BIT 8
#define EXCEPT_IPF_INSTRUCTION_ACCESS_BIT 9
#define EXCEPT_IPF_DATA_ACCESS_BIT 10
#define EXCEPT_IPF_BREAKPOINT 11
#define EXCEPT_IPF_EXTERNAL_INTERRUPT 12
// 13 - 19 reserved
#define EXCEPT_IPF_PAGE_NOT_PRESENT 20
#define EXCEPT_IPF_KEY_PERMISSION 21
#define EXCEPT_IPF_INSTRUCTION_ACCESS_RIGHTS 22
#define EXCEPT_IPF_DATA_ACCESS_RIGHTS 23
#define EXCEPT_IPF_GENERAL_EXCEPTION 24
#define EXCEPT_IPF_DISABLED_FP_REGISTER 25
#define EXCEPT_IPF_NAT_CONSUMPTION 26
#define EXCEPT_IPF_SPECULATION 27
// 28 reserved
#define EXCEPT_IPF_DEBUG 29
#define EXCEPT_IPF_UNALIGNED_REFERENCE 30
#define EXCEPT_IPF_UNSUPPORTED_DATA_REFERENCE 31
#define EXCEPT_IPF_FP_FAULT 32
#define EXCEPT_IPF_FP_TRAP 33
#define EXCEPT_IPF_LOWER_PRIVILEGE_TRANSFER_TRAP 34
#define EXCEPT_IPF_TAKEN_BRANCH 35
#define EXCEPT_IPF_SINGLE_STEP 36
// 37 - 44 reserved
#define EXCEPT_IPF_IA32_EXCEPTION 45
#define EXCEPT_IPF_IA32_INTERCEPT 46
#define EXCEPT_IPF_IA32_INTERRUPT 47
//
// ARM processor exception types
//
#define EXCEPT_ARM_RESET 0
#define EXCEPT_ARM_UNDEFINED_INSTRUCTION 1
#define EXCEPT_ARM_SOFTWARE_INTERRUPT 2
#define EXCEPT_ARM_PREFETCH_ABORT 3
#define EXCEPT_ARM_DATA_ABORT 4
#define EXCEPT_ARM_RESERVED 5
#define EXCEPT_ARM_IRQ 6
#define EXCEPT_ARM_FIQ 7
//
// For coding convenience, define the maximum valid ARM
// exception.
//
#define MAX_ARM_EXCEPTION EXCEPT_ARM_FIQ
///
/// AARCH64 processor exception types.
///
#define EXCEPT_AARCH64_SYNCHRONOUS_EXCEPTIONS 0
#define EXCEPT_AARCH64_IRQ 1
#define EXCEPT_AARCH64_FIQ 2
#define EXCEPT_AARCH64_SERROR 3
///
/// For coding convenience, define the maximum valid
/// AARCH64 exception.
///
#define MAX_AARCH64_EXCEPTION EXCEPT_AARCH64_SERROR

typedef enum {
	IsaIa32 = IMAGE_FILE_MACHINE_I386, 
	IsaX64 = IMAGE_FILE_MACHINE_X64, 
	IsaIpf = IMAGE_FILE_MACHINE_IA64, 
	IsaEbc = IMAGE_FILE_MACHINE_EBC, 
	IsaArm = IMAGE_FILE_MACHINE_ARMTHUMB_MIXED, 
	IsaAArch64 = IMAGE_FILE_MACHINE_AARCH64 
} EFI_INSTRUCTION_SET_ARCHITECTURE;

struct EFI_SYSTEM_CONTEXT_EBC {
	UINT64 R0, R1, R2, R3, R4, R5, R6, R7;
	UINT64 Flags;
	UINT64 ControlFlags;
	UINT64 Ip;
};

struct EFI_FX_SAVE_STATE_IA32 {
	UINT16 Fcw;
	UINT16 Fsw;
	UINT16 Ftw;
	UINT16 Opcode;
	UINT32 Eip;
	UINT16 Cs;
	UINT16 Reserved1;
	UINT32 DataOffset;
	UINT16 Ds;
	UINT8 Reserved2[10];
	UINT8 St0Mm0[10], Reserved3[6];
	UINT8 St1Mm1[10], Reserved4[6];
	UINT8 St2Mm2[10], Reserved5[6];
	UINT8 St3Mm3[10], Reserved6[6];
	UINT8 St4Mm4[10], Reserved7[6];
	UINT8 St5Mm5[10], Reserved8[6];
	UINT8 St6Mm6[10], Reserved9[6];
	UINT8 St7Mm7[10], Reserved10[6];
	UINT8 Xmm0[16];
	UINT8 Xmm1[16];
	UINT8 Xmm2[16];
	UINT8 Xmm3[16];
	UINT8 Xmm4[16];
	UINT8 Xmm5[16];
	UINT8 Xmm6[16];
	UINT8 Xmm7[16];
	UINT8 Reserved11[14 * 16];
};

struct EFI_SYSTEM_CONTEXT_IA32 {
	UINT32 ExceptionData; 
	EFI_FX_SAVE_STATE_IA32 FxSaveState;
	UINT32 Dr0, Dr1, Dr2, Dr3, Dr6, Dr7;
	UINT32 Cr0, Cr1 /* Reserved */, Cr2, Cr3, Cr4;
	UINT32 Eflags;
	UINT32 Ldtr, Tr;
	UINT32 Gdtr[2], Idtr[2];
	UINT32 Eip;
	UINT32 Gs, Fs, Es, Ds, Cs, Ss;
	UINT32 Edi, Esi, Ebp, Esp, Ebx, Edx, Ecx, Eax;
};

struct EFI_FX_SAVE_STATE_X64 {
	UINT16 Fcw;
	UINT16 Fsw;
	UINT16 Ftw;
	UINT16 Opcode;
	UINT64 Rip;
	UINT64 DataOffset;
	UINT8 Reserved1[8];
	UINT8 St0Mm0[10], Reserved2[6];
	UINT8 St1Mm1[10], Reserved3[6];
	UINT8 St2Mm2[10], Reserved4[6];
	UINT8 St3Mm3[10], Reserved5[6];
	UINT8 St4Mm4[10], Reserved6[6];
	UINT8 St5Mm5[10], Reserved7[6];
	UINT8 St6Mm6[10], Reserved8[6];
	UINT8 St7Mm7[10], Reserved9[6];
	UINT8 Xmm0[16];
	UINT8 Xmm1[16];
	UINT8 Xmm2[16];
	UINT8 Xmm3[16];
	UINT8 Xmm4[16];
	UINT8 Xmm5[16];
	UINT8 Xmm6[16];
	UINT8 Xmm7[16];
	UINT8 Reserved11[14 * 16];
};

struct EFI_SYSTEM_CONTEXT_X64 {
	UINT64 ExceptionData;
	EFI_FX_SAVE_STATE_X64 FxSaveState;
	UINT64 Dr0, Dr1, Dr2, Dr3, Dr6, Dr7;
	UINT64 Cr0, Cr1 /* Reserved */, Cr2, Cr3, Cr4, Cr8;
	UINT64 Rflags;
	UINT64 Ldtr, Tr;
	UINT64 Gdtr[2], Idtr[2];
	UINT64 Rip;
	UINT64 Gs, Fs, Es, Ds, Cs, Ss;
	UINT64 Rdi, Rsi, Rbp, Rsp, Rbx, Rdx, Rcx, Rax;
	UINT64 R8, R9, R10, R11, R12, R13, R14, R15;
};

struct EFI_SYSTEM_CONTEXT_IPF {
	UINT64 Reserved;

	UINT64 R1, R2, R3, R4, R5, R6, R7, R8, R9, R10, R11, R12, R13, R14, R15, R16, R17, R18, R19, R20, R21, R22, R23, R24, R25, R26, R27, R28, R29, R30,	R31;

	UINT64 F2[2], F3[2], F4[2], F5[2], F6[2],
		F7[2], F8[2], F9[2], F10[2], F11[2],
		F12[2], F13[2], F14[2], F15[2], F16[2],
		F17[2], F18[2], F19[2], F20[2], F21[2],
		F22[2], F23[2], F24[2], F25[2], F26[2],
		F27[2], F28[2], F29[2], F30[2], F31[2];

	UINT64 Pr;

	UINT64 B0, B1, B2, B3, B4, B5, B6, B7;

	// application registers
	UINT64 ArRsc, ArBsp, ArBspstore, ArRnat;
	UINT64 ArFcr;
	UINT64 ArEflag, ArCsd, ArSsd, ArCflg;
	UINT64 ArFsr, ArFir, ArFdr;
	UINT64 ArCcv;
	UINT64 ArUnat;
	UINT64 ArFpsr;
	UINT64 ArPfs, ArLc, ArEc;

	// control registers
	UINT64 CrDcr, CrItm, CrIva, CrPta, CrIpsr, CrIsr;
	UINT64 CrIip, CrIfa, CrItir, CrIipa, CrIfs, CrIim;
	UINT64 CrIha;

	// debug registers
	UINT64 Dbr0, Dbr1, Dbr2, Dbr3, Dbr4, Dbr5, Dbr6, Dbr7;
	UINT64 Ibr0, Ibr1, Ibr2, Ibr3, Ibr4, Ibr5, Ibr6, Ibr7;

	// virtual registers
	UINT64 IntNat;// nat bits for R1-R31

};

struct EFI_SYSTEM_CONTEXT_ARM {
	UINT32 R0;
	UINT32 R1;
	UINT32 R2;
	UINT32 R3;
	UINT32 R4;
	UINT32 R5;
	UINT32 R6;
	UINT32 R7;
	UINT32 R8;
	UINT32 R9;
	UINT32 R10;
	UINT32 R11;
	UINT32 R12;
	UINT32 SP;
	UINT32 LR;
	UINT32 PC;
	UINT32 CPSR;
	UINT32 DFSR;
	UINT32 DFAR;
	UINT32 IFSR;
};

struct EFI_SYSTEM_CONTEXT_AARCH64 {
	// General Purpose Registers
	UINT64 X0;
	UINT64 X1;
	UINT64 X2;
	UINT64 X3;
	UINT64 X4;
	UINT64 X5;
	UINT64 X6;
	UINT64 X7;
	UINT64 X8;
	UINT64 X9;
	UINT64 X10;
	UINT64 X11;
	UINT64 X12;
	UINT64 X13;
	UINT64 X14;
	UINT64 X15;
	UINT64 X16;
	UINT64 X17;
	UINT64 X18;
	UINT64 X19;
	UINT64 X20;
	UINT64 X21;
	UINT64 X22;
	UINT64 X23;
	UINT64 X24;
	UINT64 X25;
	UINT64 X26;
	UINT64 X27;
	UINT64 X28;
	UINT64 FP; // x29 - Frame Pointer
	UINT64 LR; // x30 - Link Register
	UINT64 SP; // x31 - Stack Pointer
			   // FP/SIMD Registers
	UINT64 V0[2];
	UINT64 V1[2];
	UINT64 V2[2];
	UINT64 V3[2];
	UINT64 V4[2];
	UINT64 V5[2];
	UINT64 V6[2];
	UINT64 V7[2];
	UINT64 V8[2];
	UINT64 V9[2];
	UINT64 V10[2];
	UINT64 V11[2];
	UINT64 V12[2];
	UINT64 V13[2];
	UINT64 V14[2];
	UINT64 V15[2];
	UINT64 V16[2];
	UINT64 V17[2];
	UINT64 V18[2];
	UINT64 V19[2];
	UINT64 V20[2];
	UINT64 V21[2];
	UINT64 V22[2];
	UINT64 V23[2];
	UINT64 V24[2];
	UINT64 V25[2];
	UINT64 V26[2];
	UINT64 V27[2];
	UINT64 V28[2];
	UINT64 V29[2];
	UINT64 V30[2];
	UINT64 V31[2];

	UINT64 ELR; // Exception Link Register
	UINT64 SPSR; // Saved Processor Status Register
	UINT64 FPSR; // Floating Point Status Register
	UINT64 ESR; // Exception syndrome register
	UINT64 FAR; // Fault Address Register
};

typedef union {
	EFI_SYSTEM_CONTEXT_EBC *SystemContextEbc;
	EFI_SYSTEM_CONTEXT_IA32 *SystemContextIa32;
	EFI_SYSTEM_CONTEXT_X64 *SystemContextX64;
	EFI_SYSTEM_CONTEXT_IPF *SystemContextIpf;
	EFI_SYSTEM_CONTEXT_ARM *SystemContextArm;
	EFI_SYSTEM_CONTEXT_AARCH64 *SystemContextAArch64;
} EFI_SYSTEM_CONTEXT;

typedef INTN EFI_EXCEPTION_TYPE;

typedef EFI_STATUS(EFIAPI *EFI_GET_MAXIMUM_PROCESSOR_INDEX) (IN EFI_DEBUG_SUPPORT_PROTOCOL *This, OUT UINTN *MaxProcessorIndex);
typedef VOID(EFIAPI *EFI_PERIODIC_CALLBACK) (IN OUT EFI_SYSTEM_CONTEXT SystemContext);
typedef EFI_STATUS(EFIAPI *EFI_REGISTER_PERIODIC_CALLBACK) (IN EFI_DEBUG_SUPPORT_PROTOCOL *This, IN UINTN ProcessorIndex, IN EFI_PERIODIC_CALLBACK PeriodicCallback);
typedef VOID(EFIAPI *EFI_EXCEPTION_CALLBACK) (IN EFI_EXCEPTION_TYPE ExceptionType, IN OUT EFI_SYSTEM_CONTEXT SystemContext);
typedef EFI_STATUS(EFIAPI *EFI_REGISTER_EXCEPTION_CALLBACK) (IN EFI_DEBUG_SUPPORT_PROTOCOL *This, IN UINTN ProcessorIndex, IN EFI_EXCEPTION_CALLBACK ExceptionCallback, IN EFI_EXCEPTION_TYPE ExceptionType);
typedef EFI_STATUS(EFIAPI *EFI_INVALIDATE_INSTRUCTION_CACHE) (IN EFI_DEBUG_SUPPORT_PROTOCOL *This, IN UINTN ProcessorIndex, IN VOID *Start, IN UINT64 Length);

struct EFI_DEBUG_SUPPORT_PROTOCOL {
	EFI_INSTRUCTION_SET_ARCHITECTURE Isa;
	EFI_GET_MAXIMUM_PROCESSOR_INDEX GetMaximumProcessorIndex;
	EFI_REGISTER_PERIODIC_CALLBACK RegisterPeriodicCallback;
	EFI_REGISTER_EXCEPTION_CALLBACK RegisterExceptionCallback;
	EFI_INVALIDATE_INSTRUCTION_CACHE InvalidateInstructionCache;
};

#define EFI_DEBUGPORT_PROTOCOL_GUID \
 {0xEBA4E8D2,0x3858,0x41EC,\
 {0xA2,0x81,0x26,0x47,0xBA,0x96,0x60,0xD0}}

typedef EFI_STATUS(EFIAPI *EFI_DEBUGPORT_RESET) (IN EFI_DEBUGPORT_PROTOCOL *This);
typedef EFI_STATUS(EFIAPI *EFI_DEBUGPORT_WRITE) (IN EFI_DEBUGPORT_PROTOCOL *This, IN UINT32 Timeout, IN OUT UINTN *BufferSize, IN VOID *Buffer);
typedef EFI_STATUS(EFIAPI *EFI_DEBUGPORT_READ) (IN EFI_DEBUGPORT_PROTOCOL *This, IN UINT32 Timeout, IN OUT UINTN *BufferSize, OUT VOID *Buffer);
typedef EFI_STATUS(EFIAPI *EFI_DEBUGPORT_POLL) (IN EFI_DEBUGPORT_PROTOCOL *This);

struct EFI_DEBUGPORT_PROTOCOL {
	EFI_DEBUGPORT_RESET Reset;
	EFI_DEBUGPORT_WRITE Write;
	EFI_DEBUGPORT_READ Read;
	EFI_DEBUGPORT_POLL Poll;
};

#define EFI_DEBUG_IMAGE_INFO_TABLE_GUID \
 {0x49152E77,0x1ADA,0x4764,\
 {0xB7,0xA2,0x7A,0xFE,0xFE,0xD9,0x5E,0x8B }}

#define EFI_DEBUG_IMAGE_INFO_UPDATE_IN_PROGRESS 0x01
#define EFI_DEBUG_IMAGE_INFO_TABLE_MODIFIED 0x02
#define EFI_DEBUG_IMAGE_INFO_TYPE_NORMAL 0x01

typedef union {
	UINT32 *ImageInfoType;
	EFI_DEBUG_IMAGE_INFO_NORMAL *NormalImage;
} EFI_DEBUG_IMAGE_INFO;struct EFI_DEBUG_IMAGE_INFO_NORMAL {
	UINT32 ImageInfoType;
	EFI_LOADED_IMAGE_PROTOCOL *LoadedImageProtocolInstance;
	EFI_HANDLE ImageHandle;
};
struct EFI_DEBUG_IMAGE_INFO_TABLE_HEADER {
	volatile UINT32 UpdateStatus;
	UINT32 TableSize;
	EFI_DEBUG_IMAGE_INFO *EfiDebugImageInfoTable;
};

#define EFI_DECOMPRESS_PROTOCOL_GUID \
 {0xd8117cfe,0x94a6,0x11d4,\
 {0x9a,0x3a,0x00,0x90,0x27,0x3f,0xc1,0x4d}}

typedef EFI_STATUS(EFIAPI *EFI_DECOMPRESS_GET_INFO) (IN EFI_DECOMPRESS_PROTOCOL *This, IN VOID *Source, IN UINT32 SourceSize, OUT UINT32 *DestinationSize, OUT UINT32 *ScratchSize);
typedef EFI_STATUS(EFIAPI *EFI_DECOMPRESS_DECOMPRESS) (IN EFI_DECOMPRESS_PROTOCOL *This, IN VOID *Source, IN UINT32 SourceSize, IN OUT VOID *Destination, IN UINT32 DestinationSize, IN OUT VOID *Scratch, IN UINT32 ScratchSize);

struct EFI_DECOMPRESS_PROTOCOL {
	EFI_DECOMPRESS_GET_INFO GetInfo;
	EFI_DECOMPRESS_DECOMPRESS Decompress;
};

#define EFI_ACPI_TABLE_PROTOCOL_GUID \
 {0xffe06bdd, 0x6107, 0x46a6,\
 {0x7b, 0xb2, 0x5a, 0x9c, 0x7e, 0xc5, 0x27, 0x5c}}

typedef EFI_STATUS(EFIAPI *EFI_ACPI_TABLE_INSTALL_ACPI_TABLE) (IN EFI_ACPI_TABLE_PROTOCOL *This, IN VOID *AcpiTableBuffer, IN UINTN AcpiTableBufferSize, OUT UINTN *TableKey);
typedef EFI_STATUS(EFIAPI *EFI_ACPI_TABLE_UNINSTALL_ACPI_TABLE) (IN EFI_ACPI_TABLE_PROTOCOL *This, IN UINTN TableKey);

struct EFI_ACPI_TABLE_PROTOCOL {
	EFI_ACPI_TABLE_INSTALL_ACPI_TABLE InstallAcpiTable;
	EFI_ACPI_TABLE_UNINSTALL_ACPI_TABLE UninstallAcpiTable;
};
#define EFI_UNICODE_COLLATION_PROTOCOL2_GUID \
 {0xa4c751fc, 0x23ae, 0x4c3e, \
 {0x92, 0xe9, 0x49, 0x64, 0xcf, 0x63, 0xf3, 0x49}}

typedef INTN(EFIAPI *EFI_UNICODE_COLLATION_STRICOLL) (IN EFI_UNICODE_COLLATION_PROTOCOL *This, IN CHAR16 *s1, IN CHAR16 *s2);
typedef BOOLEAN(EFIAPI *EFI_UNICODE_COLLATION_METAIMATCH) (IN EFI_UNICODE_COLLATION_PROTOCOL *This, IN CHAR16 *String, IN CHAR16 *Pattern);
typedef VOID(EFIAPI *EFI_UNICODE_COLLATION_STRLWR) (IN EFI_UNICODE_COLLATION_PROTOCOL *This, IN OUT CHAR16 *String);
typedef VOID(EFIAPI *EFI_UNICODE_COLLATION_STRUPR) (IN EFI_UNICODE_COLLATION_PROTOCOL *This, IN OUT CHAR16 *String);
typedef VOID(EFIAPI *EFI_UNICODE_COLLATION_FATTOSTR) (IN EFI_UNICODE_COLLATION_PROTOCOL *This, IN UINTN FatSize, IN CHAR8 *Fat, OUT CHAR16 *String);
typedef BOOLEAN(EFIAPI *EFI_UNICODE_COLLATION_STRTOFAT) (IN EFI_UNICODE_COLLATION_PROTOCOL *This, IN CHAR16 *String, IN UINTN FatSize, OUT CHAR8 *Fat);

struct EFI_UNICODE_COLLATION_PROTOCOL {
	EFI_UNICODE_COLLATION_STRICOLL StriColl;
	EFI_UNICODE_COLLATION_METAIMATCH MetaiMatch;
	EFI_UNICODE_COLLATION_STRLWR StrLwr;
	EFI_UNICODE_COLLATION_STRUPR StrUpr;
	EFI_UNICODE_COLLATION_FATTOSTR FatToStr;
	EFI_UNICODE_COLLATION_STRTOFAT StrToFat;
	CHAR8 *SupportedLanguages;
};

#define EFI_REGULAR_EXPRESSION_PROTOCOL_GUID \
 { 0xB3F79D9A, 0x436C, 0xDC11,\
 { 0xB0, 0x52, 0xCD, 0x85, 0xDF, 0x52, 0x4C, 0xE6 } }

#define EFI_REGEX_SYNTAX_TYPE_POSIX_EXTENDED_GUID \
{ 0x5F05B20F, 0x4A56, 0xC231, \
{ 0xFA, 0x0B, 0xA7, 0xB1, 0xF1, 0x10, 0x04, 0x1D } }

#define EFI_REGEX_SYNTAX_TYPE_PERL_GUID \
{ 0x63E60A51, 0x497D, 0xD427, \
{ 0xC4, 0xA5, 0xB8, 0xAB, 0xDC, 0x3A, 0xAE, 0xB6 } }

#define EFI_REGEX_SYNTAX_TYPE_ECMA_262_GUID \
{0x9A473A4A, 0x4CEB, 0xB95A, 0x41, \
{ 0x5E, 0x5B, 0xA0, 0xBC, 0x63, 0x9B, 0x2E } }

typedef EFI_GUID EFI_REGEX_SYNTAX_TYPE;

struct EFI_REGEX_CAPTURE {
	CONST CHAR16 *CapturePtr;
	UINTN Length;
};

typedef EFI_STATUS(EFIAPI *EFI_REGULAR_EXPRESSION_MATCH) (IN EFI_REGULAR_EXPRESSION_PROTOCOL *This, IN CHAR16 *String, IN CHAR16 *Pattern, IN EFI_REGEX_SYNTAX_TYPE *SyntaxType OPTIONAL, OUT BOOLEAN *Result, OUT EFI_REGEX_CAPTURE **Captures OPTIONAL, OUT UINTN *CapturesCount);
typedef EFI_STATUS(EFIAPI *EFI_REGULAR_EXPRESSION_GET_INFO) (IN EFI_REGULAR_EXPRESSION_PROTOCOL *This, IN OUT UINTN *RegExSyntaxTypeListSize, OUT EFI_REGEX_SYNTAX_TYPE *RegExSyntaxTypeList);


struct EFI_REGULAR_EXPRESSION_PROTOCOL {
	EFI_REGULAR_EXPRESSION_MATCH MatchString;
	EFI_REGULAR_EXPRESSION_GET_INFO GetInfo;
};

#define EFI_EBC_PROTOCOL_GUID \
 {0x13ac6dd1,0x73d0,0x11d4,\
 {0xb0,0x6b,0x00,0xaa,0x00,0xbd,0x6d,0xe7}}

typedef EFI_STATUS(EFIAPI *EFI_EBC_CREATE_THUNK) (IN EFI_EBC_PROTOCOL *This, IN EFI_HANDLE ImageHandle, IN VOID *EbcEntryPoint, OUT VOID **Thunk);
typedef EFI_STATUS(EFIAPI *EFI_EBC_UNLOAD_IMAGE) (IN EFI_EBC_PROTOCOL *This, IN EFI_HANDLE ImageHandle);
typedef EFI_STATUS(EFIAPI *EBC_ICACHE_FLUSH) (IN EFI_PHYSICAL_ADDRESS Start, IN UINT64 Length);
typedef EFI_STATUS(EFIAPI *EFI_EBC_REGISTER_ICACHE_FLUSH) (IN EFI_EBC_PROTOCOL *This, IN EBC_ICACHE_FLUSH Flush);
typedef EFI_STATUS(*EFI_EBC_GET_VERSION) (IN EFI_EBC_PROTOCOL *This, OUT UINT64 *Version);

struct EFI_EBC_PROTOCOL {
	EFI_EBC_CREATE_THUNK CreateThunk;
	EFI_EBC_UNLOAD_IMAGE UnloadImage;
	EFI_EBC_REGISTER_ICACHE_FLUSH RegisterICacheFlush;
	EFI_EBC_GET_VERSION GetVersion;
};

#define EFI_FIRMWARE_MANAGEMENT_PROTOCOL_GUID \
 { 0x86c77a67, 0xb97, 0x4633, \
 {0xa1, 0x87, 0x49, 0x10, 0x4d, 0x06, 0x85, 0xc7 }}

#define IMAGE_COMPATIBILITY_CHECK_SUPPORTED 0x0000000000000001
#define EFI_FIRMWARE_IMAGE_DESCRIPTOR_VERSION 3
#define IMAGE_ATTRIBUTE_IMAGE_UPDATABLE 0x0000000000000001
#define IMAGE_ATTRIBUTE_RESET_REQUIRED 0x0000000000000002
#define IMAGE_ATTRIBUTE_AUTHENTICATION_REQUIRED 0x0000000000000004
#define IMAGE_ATTRIBUTE_IN_USE 0x0000000000000008
#define IMAGE_ATTRIBUTE_UEFI_IMAGE 0x0000000000000010

#define IMAGE_UPDATABLE_VALID 0x0000000000000001
#define IMAGE_UPDATABLE_INVALID 0x0000000000000002
#define IMAGE_UPDATABLE_INVALID_TYPE 0x0000000000000004
#define IMAGE_UPDATABLE_INVALID_OLD 0x0000000000000008
#define IMAGE_UPDATABLE_VALID_WITH_VENDOR_CODE 0x0000000000000010

#define PACKAGE_ATTRIBUTE_VERSION_UPDATABLE 0x0000000000000001
#define PACKAGE_ATTRIBUTE_RESET_REQUIRED 0x0000000000000002
#define PACKAGE_ATTRIBUTE_AUTHENTICATION_REQUIRED 0x0000000000000004

struct EFI_FIRMWARE_IMAGE_AUTHENTICATION {
	UINT64 MonotonicCount;
	WIN_CERTIFICATE_UEFI_GUID AuthInfo;
};

struct EFI_FIRMWARE_IMAGE_DESCRIPTOR {
	UINT8 ImageIndex;
	EFI_GUID ImageTypeId;
	UINT64 ImageId;
	CHAR16 *ImageIdName;
	UINT32 Version;
	CHAR16 *VersionName;
	UINTN Size;
	UINT64 AttributesSupported;
	UINT64 AttributesSetting;
	UINT64 Compatibilities;
	UINT32 LowestSupportedImageVersion; 
	UINT32 LastAttemptVersion; 
	UINT32 LastAttemptStatus; 
	UINT64 HardwareInstance; 
};



typedef EFI_STATUS(EFIAPI *EFI_FIRMWARE_MANAGEMENT_PROTOCOL_GET_IMAGE_INFO) (IN EFI_FIRMWARE_MANAGEMENT_PROTOCOL *This, IN OUT UINTN *ImageInfoSize, IN OUT EFI_FIRMWARE_IMAGE_DESCRIPTOR *ImageInfo, OUT UINT32 *DescriptorVersion, OUT UINT8 *DescriptorCount, OUT UINTN *DescriptorSize, OUT UINT32 *PackageVersion, OUT CHAR16 **PackageVersionName);
typedef EFI_STATUS(EFIAPI *EFI_FIRMWARE_MANAGEMENT_PROTOCOL_GET_IMAGE) (IN EFI_FIRMWARE_MANAGEMENT_PROTOCOL *This, IN UINT8 ImageIndex, IN OUT VOID *Image, IN OUT UINTN *ImageSize);typedef EFI_STATUS(EFIAPI *EFI_FIRMWARE_MANAGEMENT_UPDATE_IMAGE_PROGRESS) (IN UINTN Completion);typedef EFI_STATUS(EFIAPI *EFI_FIRMWARE_MANAGEMENT_PROTOCOL_SET_IMAGE) (IN EFI_FIRMWARE_MANAGEMENT_PROTOCOL *This, IN UINT8 ImageIndex, IN CONST VOID *Image, IN UINTN ImageSize, IN CONST VOID *VendorCode, IN EFI_FIRMWARE_MANAGEMENT_UPDATE_IMAGE_PROGRESS Progress, OUT CHAR16 **AbortReason);typedef EFI_STATUS(EFIAPI *EFI_FIRMWARE_MANAGEMENT_PROTOCOL_CHECK_IMAGE) (IN EFI_FIRMWARE_MANAGEMENT_PROTOCOL *This, IN UINT8 ImageIndex, IN CONST VOID *Image, IN UINTN ImageSize, OUT UINT32 *ImageUpdatable);typedef EFI_STATUS(EFIAPI *EFI_FIRMWARE_MANAGEMENT_PROTOCOL_GET_PACKAGE_INFO) (IN EFI_FIRMWARE_MANAGEMENT_PROTOCOL *This, OUT UINT32 *PackageVersion, OUT CHAR16 **PackageVersionName, OUT UINT32 *PackageVersionNameMaxLen, OUT UINT64 *AttributesSupported, OUT UINT64 *AttributesSetting);typedef EFI_STATUS(EFIAPI *EFI_FIRMWARE_MANAGEMENT_PROTOCOL_SET_PACKAGE_INFO) (IN EFI_FIRMWARE_MANAGEMENT_PROTOCOL *This, IN CONST VOID *Image, IN UINTN ImageSize, IN CONST VOID *VendorCode, IN UINT32 PackageVersion, IN CONST CHAR16 *PackageVersionName);
struct EFI_FIRMWARE_MANAGEMENT_PROTOCOL {
	EFI_FIRMWARE_MANAGEMENT_PROTOCOL_GET_IMAGE_INFO GetImageInfo;
	EFI_FIRMWARE_MANAGEMENT_PROTOCOL_GET_IMAGE GetImage;
	EFI_FIRMWARE_MANAGEMENT_PROTOCOL_SET_IMAGE SetImage;
	EFI_FIRMWARE_MANAGEMENT_PROTOCOL_CHECK_IMAGE CheckImage;
	EFI_FIRMWARE_MANAGEMENT_PROTOCOL_GET_PACKAGE_INFO GetPackageInfo;
	EFI_FIRMWARE_MANAGEMENT_PROTOCOL_SET_PACKAGE_INFO SetPackageInfo;
};

#define EFI_FIRMWARE_MANAGEMENT_CAPSULE_ID_GUID \
{0x6dcbd5ed, 0xe82d, 0x4c44, \
{0xbd, 0xa1, 0x71, 0x94, 0x19, 0x9a, 0xd9, 0x2a }}

struct EFI_FIRMWARE_MANAGEMENT_CAPSULE_HEADER {
	UINT32 Version;
	UINT16 EmbeddedDriverCount;
	UINT16 PayloadItemCount;
	// UINT64 ItemOffsetList[];
};

struct EFI_FIRMWARE_MANAGEMENT_CAPSULE_IMAGE_HEADER {
	UINT32 Version;
	EFI_GUID UpdateImageTypeId;
	UINT8 UpdateImageIndex;
	UINT8 reserved_bytes[3];
	UINT32 UpdateImageSize;
	UINT32 UpdateVendorCodeSize;
	UINT64 UpdateHardwareInstance;
};

#define EFI_SYSTEM_RESOURCE_TABLE_GUID \
{ 0xb122a263, 0x3661, 0x4f68,\
{ 0x99, 0x29, 0x78, 0xf8, 0xb0, 0xd6, 0x21, 0x80 }}


#define EFI_SYSTEM_RESOURCE_TABLE_FIRMWARE_RESOURCE_VERSION 1

#define ESRT_FW_TYPE_UNKNOWN 0x00000000
#define ESRT_FW_TYPE_SYSTEMFIRMWARE 0x00000001
#define ESRT_FW_TYPE_DEVICEFIRMWARE 0x00000002
#define ESRT_FW_TYPE_UEFIDRIVER 0x00000003

#define LAST_ATTEMPT_STATUS_SUCCESS 0x00000000
#define LAST_ATTEMPT_STATUS_ERROR_UNSUCCESSFUL 0x00000001
#define LAST_ATTEMPT_STATUS_ERROR_INSUFFICIENT_RESOURCES 0x00000002
#define LAST_ATTEMPT_STATUS_ERROR_INCORRECT_VERSION 0x00000003
#define LAST_ATTEMPT_STATUS_ERROR_INVALID_FORMAT 0x00000004
#define LAST_ATTEMPT_STATUS_ERROR_AUTH_ERROR 0x00000005
#define LAST_ATTEMPT_STATUS_ERROR_PWR_EVT_AC 0x00000006
#define LAST_ATTEMPT_STATUS_ERROR_PWR_EVT_BATT 0x00000007

struct EFI_SYSTEM_RESOURCE_TABLE {
	UINT32 FwResourceCount;
	UINT32 FwResourceCountMax;
	UINT64 FwResourceVersion;
	//EFI_SYSTEM_RESOURCE_ENTRY Entries[];
};

struct EFI_SYSTEM_RESOURCE_ENTRY {
	EFI_GUID FwClass;
	UINT32 FwType;
	UINT32 FwVersion;
	UINT32 LowestSupportedFwVersion;
	UINT32 CapsuleFlags;
	UINT32 LastAttemptVersion;
	UINT32 LastAttemptStatus;
};

#define EFI_SIMPLE_NETWORK_PROTOCOL_GUID \
 {0xA19832B9,0xAC25,0x11D3, \
 {0x9A,0x2D,0x00,0x90,0x27,0x3f,0xc1,0x4d}}

#define EFI_SIMPLE_NETWORK_PROTOCOL_REVISION 0x00010000

#define MAX_MCAST_FILTER_CNT 16

#define EFI_SIMPLE_NETWORK_RECEIVE_UNICAST 0x01
#define EFI_SIMPLE_NETWORK_RECEIVE_MULTICAST 0x02
#define EFI_SIMPLE_NETWORK_RECEIVE_BROADCAST 0x04
#define EFI_SIMPLE_NETWORK_RECEIVE_PROMISCUOUS 0x08
#define EFI_SIMPLE_NETWORK_RECEIVE_PROMISCUOUS_MULTICAST 0x10

#define EFI_SIMPLE_NETWORK_RECEIVE_INTERRUPT 0x01
#define EFI_SIMPLE_NETWORK_TRANSMIT_INTERRUPT 0x02
#define EFI_SIMPLE_NETWORK_COMMAND_INTERRUPT 0x04
#define EFI_SIMPLE_NETWORK_SOFTWARE_INTERRUPT 0x08

typedef enum {
	EfiSimpleNetworkStopped,
	EfiSimpleNetworkStarted,
	EfiSimpleNetworkInitialized,
	EfiSimpleNetworkMaxState
} EFI_SIMPLE_NETWORK_STATE;

struct EFI_MAC_ADDRESS {
	UINT8 Addr[32];
};

struct EFI_SIMPLE_NETWORK_MODE {
	UINT32 State;
	UINT32 HwAddressSize;
	UINT32 MediaHeaderSize;
	UINT32 MaxPacketSize;
	UINT32 NvRamSize;
	UINT32 NvRamAccessSize;
	UINT32 ReceiveFilterMask;
	UINT32 ReceiveFilterSetting;
	UINT32 MaxMCastFilterCount;
	UINT32 MCastFilterCount;
	EFI_MAC_ADDRESS* MCastFilter;
	EFI_MAC_ADDRESS CurrentAddress;
	EFI_MAC_ADDRESS BroadcastAddress;
	EFI_MAC_ADDRESS PermanentAddress;
	UINT8 IfType;
	BOOLEAN MacAddressChangeable;
	BOOLEAN MultipleTxSupported;
	BOOLEAN MediaPresentSupported;
	BOOLEAN MediaPresent;
};

struct EFI_NETWORK_STATISTICS {
	UINT64 RxTotalFrames;
	UINT64 RxGoodFrames;
	UINT64 RxUndersizeFrames;
	UINT64 RxOversizeFrames;
	UINT64 RxDroppedFrames;
	UINT64 RxUnicastFrames;
	UINT64 RxBroadcastFrames;
	UINT64 RxMulticastFrames;
	UINT64 RxCrcErrorFrames;
	UINT64 RxTotalBytes;
	UINT64 TxTotalFrames;
	UINT64 TxGoodFrames;
	UINT64 TxUndersizeFrames;
	UINT64 TxOversizeFrames;
	UINT64 TxDroppedFrames;
	UINT64 TxUnicastFrames;
	UINT64 TxBroadcastFrames;
	UINT64 TxMulticastFrames;
	UINT64 TxCrcErrorFrames;
	UINT64 TxTotalBytes;
	UINT64 Collisions;
	UINT64 UnsupportedProtocol;
	UINT64 RxDuplicatedFrames;
	UINT64 RxDecryptErrorFrames;
	UINT64 TxErrorFrames;
	UINT64 TxRetryFrames;
};

struct EFI_IPv4_ADDRESS {
	UINT8 Addr[4];
};

struct EFI_IPv6_ADDRESS {
	UINT8 Addr[16];
};

typedef union {
	UINT32 Addr[4];
	EFI_IPv4_ADDRESS v4;
	EFI_IPv6_ADDRESS v6;
} EFI_IP_ADDRESS;

typedef EFI_STATUS(EFIAPI *EFI_SIMPLE_NETWORK_START) (IN EFI_SIMPLE_NETWORK_PROTOCOL *This);
typedef EFI_STATUS(EFIAPI *EFI_SIMPLE_NETWORK_STOP) (IN EFI_SIMPLE_NETWORK_PROTOCOL *This);
typedef EFI_STATUS(EFIAPI *EFI_SIMPLE_NETWORK_INITIALIZE) (IN EFI_SIMPLE_NETWORK_PROTOCOL *This, IN UINTN ExtraRxBufferSize OPTIONAL, IN UINTN ExtraTxBufferSize OPTIONAL);
typedef EFI_STATUS(EFIAPI *EFI_SIMPLE_NETWORK_RESET) (IN EFI_SIMPLE_NETWORK_PROTOCOL *This, IN BOOLEAN ExtendedVerification);
typedef EFI_STATUS(EFIAPI *EFI_SIMPLE_NETWORK_SHUTDOWN) (IN EFI_SIMPLE_NETWORK_PROTOCOL *This);
typedef EFI_STATUS(EFIAPI *EFI_SIMPLE_NETWORK_RECEIVE_FILTERS) (IN EFI_SIMPLE_NETWORK_PROTOCOL *This, IN UINT32 Enable, IN UINT32 Disable, IN BOOLEAN ResetMCastFilter, IN UINTN MCastFilterCnt OPTIONAL, IN EFI_MAC_ADDRESS *MCastFilter OPTIONAL);
typedef EFI_STATUS(EFIAPI *EFI_SIMPLE_NETWORK_STATION_ADDRESS) (IN EFI_SIMPLE_NETWORK_PROTOCOL *This, IN BOOLEAN Reset, IN EFI_MAC_ADDRESS *New OPTIONAL);
typedef EFI_STATUS(EFIAPI *EFI_SIMPLE_NETWORK_STATISTICS) (IN EFI_SIMPLE_NETWORK_PROTOCOL *This, IN BOOLEAN Reset, IN OUT UINTN *StatisticsSize OPTIONAL, OUT EFI_NETWORK_STATISTICS *StatisticsTable OPTIONAL);
typedef EFI_STATUS(EFIAPI *EFI_SIMPLE_NETWORK_MCAST_IP_TO_MAC) (IN EFI_SIMPLE_NETWORK_PROTOCOL *This, IN BOOLEAN IPv6, IN EFI_IP_ADDRESS *IP, OUT EFI_MAC_ADDRESS *MAC);
typedef EFI_STATUS(EFIAPI *EFI_SIMPLE_NETWORK_NVDATA) (IN EFI_SIMPLE_NETWORK_PROTOCOL *This, IN BOOLEAN ReadWrite, IN UINTN Offset, IN UINTN BufferSize, IN OUT VOID *Buffer);
typedef EFI_STATUS(EFIAPI *EFI_SIMPLE_NETWORK_GET_STATUS) (IN EFI_SIMPLE_NETWORK_PROTOCOL *This, OUT UINT32 *InterruptStatus OPTIONAL, OUT VOID **TxBuf OPTIONAL);
typedef EFI_STATUS(EFIAPI *EFI_SIMPLE_NETWORK_TRANSMIT) (IN EFI_SIMPLE_NETWORK_PROTOCOL *This, IN UINTN HeaderSize, IN UINTN BufferSize, IN VOID *Buffer, IN EFI_MAC_ADDRESS *SrcAddr OPTIONAL, IN EFI_MAC_ADDRESS *DestAddr OPTIONAL, IN UINT16 *Protocol OPTIONAL);
typedef EFI_STATUS(EFIAPI *EFI_SIMPLE_NETWORK_RECEIVE) (IN EFI_SIMPLE_NETWORK_PROTOCOL *This, OUT UINTN *HeaderSize OPTIONAL, IN OUT UINTN *BufferSize, OUT VOID *Buffer, OUT EFI_MAC_ADDRESS *SrcAddr OPTIONAL, OUT EFI_MAC_ADDRESS *DestAddr OPTIONAL, OUT UINT16 *Protocol OPTIONAL);


struct EFI_SIMPLE_NETWORK_PROTOCOL {
	UINT64 Revision;
	EFI_SIMPLE_NETWORK_START Start;
	EFI_SIMPLE_NETWORK_STOP Stop;
	EFI_SIMPLE_NETWORK_INITIALIZE Initialize;
	EFI_SIMPLE_NETWORK_RESET Reset;
	EFI_SIMPLE_NETWORK_SHUTDOWN Shutdown;
	EFI_SIMPLE_NETWORK_RECEIVE_FILTERS ReceiveFilters;
	EFI_SIMPLE_NETWORK_STATION_ADDRESS StationAddress;
	EFI_SIMPLE_NETWORK_STATISTICS Statistics;
	EFI_SIMPLE_NETWORK_MCAST_IP_TO_MAC MCastIpToMac;
	EFI_SIMPLE_NETWORK_NVDATA NvData;
	EFI_SIMPLE_NETWORK_GET_STATUS GetStatus;
	EFI_SIMPLE_NETWORK_TRANSMIT Transmit;
	EFI_SIMPLE_NETWORK_RECEIVE Receive;
	EFI_EVENT WaitForPacket;
	EFI_SIMPLE_NETWORK_MODE *Mode;
};

#define EFI_NETWORK_INTERFACE_IDENTIFIER_PROTOCOL_GUID_31 \
{0x1ACED566, 0x76ED, 0x4218, \
{0xBC, 0x81, 0x76, 0x7F, 0x1F, 0x97, 0x7A, 0x89

#define EFI_NETWORK_INTERFACE_IDENTIFIER_PROTOCOL_REVISION 0x00020000

typedef enum {
	EfiNetworkInterfaceUndi = 1
} EFI_NETWORK_INTERFACE_TYPE;

struct EFI_NETWORK_INTERFACE_IDENTIFIER_PROTOCOL {
	UINT64 Revision;
	UINT64 Id;
	UINT64 ImageAddr;
	UINT32 ImageSize;
	CHAR8 StringId[4];
	UINT8 Type;
	UINT8 MajorVer;
	UINT8 MinorVer;
	BOOLEAN Ipv6Supported;
	UINT16 IfNum;
};

#define EFI_PXE_BASE_CODE_PROTOCOL_GUID \
{0x03C4E603,0xAC28,0x11d3, \
{0x9A,0x2D,0x00,0x90,0x27,0x3F,0xC1,0x4D}}

#define EFI_PXE_BASE_CODE_PROTOCOL_REVISION 0x00010000

#define EFI_PXE_BASE_CODE_MAX_ARP_ENTRIES 8
#define EFI_PXE_BASE_CODE_MAX_ROUTE_ENTRIES 8

#define EFI_PXE_BASE_CODE_MAX_IPCNT 8

#define EFI_PXE_BASE_CODE_IP_FILTER_STATION_IP 0x0001
#define EFI_PXE_BASE_CODE_IP_FILTER_BROADCAST 0x0002
#define EFI_PXE_BASE_CODE_IP_FILTER_PROMISCUOUS 0x0004
#define EFI_PXE_BASE_CODE_IP_FILTER_PROMISCUOUS_MULTICAST 0x0008

#define EFI_PXE_BASE_CODE_UDP_OPFLAGS_ANY_SRC_IP 0x0001
#define EFI_PXE_BASE_CODE_UDP_OPFLAGS_ANY_SRC_PORT 0x0002
#define EFI_PXE_BASE_CODE_UDP_OPFLAGS_ANY_DEST_IP 0x0004
#define EFI_PXE_BASE_CODE_UDP_OPFLAGS_ANY_DEST_PORT 0x0008
#define EFI_PXE_BASE_CODE_UDP_OPFLAGS_USE_FILTER 0x0010
#define EFI_PXE_BASE_CODE_UDP_OPFLAGS_MAY_FRAGMENT 0x0020
#define DEFAULT_TTL 16
#define DEFAULT_ToS 0

#define EFI_PXE_BASE_CODE_BOOT_TYPE_BOOTSTRAP 0
#define EFI_PXE_BASE_CODE_BOOT_TYPE_MS_WINNT_RIS 1
#define EFI_PXE_BASE_CODE_BOOT_TYPE_INTEL_LCM 2
#define EFI_PXE_BASE_CODE_BOOT_TYPE_DOSUNDI 3
#define EFI_PXE_BASE_CODE_BOOT_TYPE_NEC_ESMPRO 4
#define EFI_PXE_BASE_CODE_BOOT_TYPE_IBM_WSoD 5
#define EFI_PXE_BASE_CODE_BOOT_TYPE_IBM_LCCM 6
#define EFI_PXE_BASE_CODE_BOOT_TYPE_CA_UNICENTER_TNG 7
#define EFI_PXE_BASE_CODE_BOOT_TYPE_HP_OPENVIEW 8
#define EFI_PXE_BASE_CODE_BOOT_TYPE_ALTIRIS_9 9
#define EFI_PXE_BASE_CODE_BOOT_TYPE_ALTIRIS_10 10
#define EFI_PXE_BASE_CODE_BOOT_TYPE_ALTIRIS_11 11
#define EFI_PXE_BASE_CODE_BOOT_TYPE_NOT_USED_12 12
#define EFI_PXE_BASE_CODE_BOOT_TYPE_REDHAT_INSTALL 13
#define EFI_PXE_BASE_CODE_BOOT_TYPE_REDHAT_BOOT 14
#define EFI_PXE_BASE_CODE_BOOT_TYPE_REMBO 15
#define EFI_PXE_BASE_CODE_BOOT_TYPE_BEOBOOT 16
//
// Values 17 through 32767 are reserved.
// Values 32768 through 65279 are for vendor use.
// Values 65280 through 65534 are reserved.
//
#define EFI_PXE_BASE_CODE_BOOT_TYPE_PXETEST 65535
#define EFI_PXE_BASE_CODE_BOOT_LAYER_MASK 0x7FFF
#define EFI_PXE_BASE_CODE_BOOT_LAYER_INITIAL 0x0000

#define DUID_UUID 4 

typedef UINT16 EFI_PXE_BASE_CODE_UDP_PORT;typedef enum {
	EFI_PXE_BASE_CODE_TFTP_FIRST,
	EFI_PXE_BASE_CODE_TFTP_GET_FILE_SIZE,
	EFI_PXE_BASE_CODE_TFTP_READ_FILE,
	EFI_PXE_BASE_CODE_TFTP_WRITE_FILE,
	EFI_PXE_BASE_CODE_TFTP_READ_DIRECTORY,
	EFI_PXE_BASE_CODE_MTFTP_GET_FILE_SIZE,
	EFI_PXE_BASE_CODE_MTFTP_READ_FILE,
	EFI_PXE_BASE_CODE_MTFTP_READ_DIRECTORY,
	EFI_PXE_BASE_CODE_MTFTP_LAST
} EFI_PXE_BASE_CODE_TFTP_OPCODE;

struct EFI_PXE_BASE_CODE_DHCPV6_PACKET {
	UINT32 MessageType : 8;
	UINT32 TransactionId : 24;
	UINT8 DhcpOptions[1024];
};

struct EFI_PXE_BASE_CODE_DHCPV4_PACKET {
	UINT8 BootpOpcode;
	UINT8 BootpHwType;
	UINT8 BootpHwAddrLen;
	UINT8 BootpGateHops;
	UINT32 BootpIdent;
	UINT16 BootpSeconds;
	UINT16 BootpFlags;
	UINT8 BootpCiAddr[4];
	UINT8 BootpYiAddr[4];
	UINT8 BootpSiAddr[4];
	UINT8 BootpGiAddr[4];
	UINT8 BootpHwAddr[16];
	UINT8 BootpSrvName[64];
	UINT8 BootpBootFile[128];
	UINT32 DhcpMagik;
	UINT8 DhcpOptions[56];
};

typedef union {
	UINT8 Raw[1472];
	EFI_PXE_BASE_CODE_DHCPV4_PACKET Dhcpv4;
	EFI_PXE_BASE_CODE_DHCPV6_PACKET Dhcpv6;
} EFI_PXE_BASE_CODE_PACKET;

struct EFI_PXE_BASE_CODE_IP_FILTER {
	UINT8 Filters;
	UINT8 IpCnt;
	UINT16 reserved;
	EFI_IP_ADDRESS* IpList;
};

struct EFI_PXE_BASE_CODE_ICMP_ERROR {
	UINT8 Type;
	UINT8 Code;
	UINT16 Checksum;
	union {
		UINT32 reserved;
		UINT32 Mtu;
		UINT32 Pointer;
		struct {
			UINT16 Identifier;
			UINT16 Sequence;
		} Echo;
	} u;
	UINT8 Data[494];
};

struct EFI_PXE_BASE_CODE_TFTP_ERROR {
	UINT8 ErrorCode;
	CHAR8 ErrorString[127];
};

struct EFI_PXE_BASE_CODE_ARP_ENTRY {
	EFI_IP_ADDRESS IpAddr;
	EFI_MAC_ADDRESS MacAddr;
};

struct EFI_PXE_BASE_CODE_ROUTE_ENTRY {
	EFI_IP_ADDRESS IpAddr;
	EFI_IP_ADDRESS SubnetMask;
	EFI_IP_ADDRESS GwAddr;
};

struct EFI_PXE_BASE_CODE_MODE {
	BOOLEAN Started;
	BOOLEAN Ipv6Available;
	BOOLEAN Ipv6Supported;
	BOOLEAN UsingIpv6;
	BOOLEAN BisSupported;
	BOOLEAN BisDetected;
	BOOLEAN AutoArp;
	BOOLEAN SendGUID;
	BOOLEAN DhcpDiscoverValid;
	BOOLEAN DhcpAckReceivd;
	BOOLEAN ProxyOfferReceived;
	BOOLEAN PxeDiscoverValid;
	BOOLEAN PxeReplyReceived;
	BOOLEAN PxeBisReplyReceived;
	BOOLEAN IcmpErrorReceived;
	BOOLEAN TftpErrorReceived;
	BOOLEAN MakeCallbacks;
	UINT8 TTL;
	UINT8 ToS;
	EFI_IP_ADDRESS StationIp;
	EFI_IP_ADDRESS SubnetMask;
	EFI_PXE_BASE_CODE_PACKET DhcpDiscover;
	EFI_PXE_BASE_CODE_PACKET DhcpAck;
	EFI_PXE_BASE_CODE_PACKET ProxyOffer;
	EFI_PXE_BASE_CODE_PACKET PxeDiscover;
	EFI_PXE_BASE_CODE_PACKET PxeReply;
	EFI_PXE_BASE_CODE_PACKET PxeBisReply;
	EFI_PXE_BASE_CODE_IP_FILTER IpFilter;
	UINT32 ArpCacheEntries;
	EFI_PXE_BASE_CODE_ARP_ENTRY* ArpCache;
	UINT32 RouteTableEntries;
	EFI_PXE_BASE_CODE_ROUTE_ENTRY* RouteTable;
	EFI_PXE_BASE_CODE_ICMP_ERROR IcmpError;
	EFI_PXE_BASE_CODE_TFTP_ERROR TftpError;
};

struct EFI_PXE_BASE_CODE_DISCOVER_INFO {
	BOOLEAN UseMCast;
	BOOLEAN UseBCast;
	BOOLEAN UseUCast;
	BOOLEAN MustUseList;
	EFI_IP_ADDRESS ServerMCastIp;
	UINT16 IpCnt;
	EFI_PXE_BASE_CODE_SRVLIST* SrvList;
};

struct EFI_PXE_BASE_CODE_SRVLIST {
	UINT16 Type;
	BOOLEAN AcceptAnyResponse;
	UINT8 reserved;
	EFI_IP_ADDRESS IpAddr;
};

struct EFI_PXE_BASE_CODE_MTFTP_INFO {
	EFI_IP_ADDRESS MCastIp;
	EFI_PXE_BASE_CODE_UDP_PORT CPort;
	EFI_PXE_BASE_CODE_UDP_PORT SPort;
	UINT16 ListenTimeout;
	UINT16 TransmitTimeout;
};

typedef EFI_STATUS(EFIAPI *EFI_PXE_BASE_CODE_START) (IN EFI_PXE_BASE_CODE_PROTOCOL *This, IN BOOLEAN UseIpv6);
typedef EFI_STATUS(EFIAPI *EFI_PXE_BASE_CODE_STOP) (IN EFI_PXE_BASE_CODE_PROTOCOL *This);typedef EFI_STATUS(EFIAPI *EFI_PXE_BASE_CODE_DHCP) (IN EFI_PXE_BASE_CODE_PROTOCOL *This, IN BOOLEAN SortOffers);typedef EFI_STATUS(EFIAPI *EFI_PXE_BASE_CODE_DISCOVER) (IN EFI_PXE_BASE_CODE_PROTOCOL *This, IN UINT16 Type, IN UINT16 *Layer, IN BOOLEAN UseBis, IN EFI_PXE_BASE_CODE_DISCOVER_INFO *Info OPTIONAL);typedef EFI_STATUS(EFIAPI *EFI_PXE_BASE_CODE_MTFTP) (IN EFI_PXE_BASE_CODE_PROTOCOL *This, IN EFI_PXE_BASE_CODE_TFTP_OPCODE Operation, IN OUT VOID *BufferPtr OPTIONAL, IN BOOLEAN Overwrite, IN OUT UINT64 *BufferSize, IN UINTN *BlockSize OPTIONAL, IN EFI_IP_ADDRESS *ServerIp, IN CHAR8 *Filename OPTIONAL, IN EFI_PXE_BASE_CODE_MTFTP_INFO *Info OPTIONAL, IN BOOLEAN DontUseBuffer);typedef EFI_STATUS(EFIAPI *EFI_PXE_BASE_CODE_UDP_WRITE) (IN EFI_PXE_BASE_CODE_PROTOCOL *This, IN UINT16 OpFlags, IN EFI_IP_ADDRESS *DestIp, IN EFI_PXE_BASE_CODE_UDP_PORT *DestPort, IN EFI_IP_ADDRESS *GatewayIp OPTIONAL, IN EFI_IP_ADDRESS *SrcIp OPTIONAL, IN OUT EFI_PXE_BASE_CODE_UDP_PORT *SrcPort OPTIONAL, IN UINTN *HeaderSize OPTIONAL, IN VOID *HeaderPtr OPTIONAL, IN UINTN *BufferSize, IN VOID *BufferPtr);typedef EFI_STATUS(EFIAPI *EFI_PXE_BASE_CODE_UDP_READ) (IN EFI_PXE_BASE_CODE_PROTOCOL *This, IN UINT16 OpFlags, IN OUT EFI_IP_ADDRESS *DestIp OPTIONAL, IN OUT EFI_PXE_BASE_CODE_UDP_PORT *DestPort OPTIONAL, IN OUT EFI_IP_ADDRESS *SrcIp OPTIONAL, IN OUT EFI_PXE_BASE_CODE_UDP_PORT *SrcPort OPTIONAL, IN UINTN *HeaderSize OPTIONAL, IN VOID *HeaderPtr OPTIONAL, IN OUT UINTN *BufferSize, IN VOID *BufferPtr);typedef EFI_STATUS(EFIAPI *EFI_PXE_BASE_CODE_SET_IP_FILTER) (IN EFI_PXE_BASE_CODE_PROTOCOL *This, IN EFI_PXE_BASE_CODE_IP_FILTER *NewFilter);
typedef EFI_STATUS(EFIAPI *EFI_PXE_BASE_CODE_ARP) (IN EFI_PXE_BASE_CODE_PROTOCOL *This, IN EFI_IP_ADDRESS *IpAddr, IN EFI_MAC_ADDRESS *MacAddr OPTIONAL);
typedef EFI_STATUS(EFIAPI *EFI_PXE_BASE_CODE_SET_PARAMETERS) (IN EFI_PXE_BASE_CODE_PROTOCOL *This, IN BOOLEAN *NewAutoArp OPTIONAL, IN BOOLEAN *NewSendGUID OPTIONAL, IN UINT8 *NewTTL OPTIONAL, IN UINT8 *NewToS OPTIONAL, IN BOOLEAN *NewMakeCallback OPTIONAL);
typedef EFI_STATUS(EFIAPI *EFI_PXE_BASE_CODE_SET_STATION_IP) (IN EFI_PXE_BASE_CODE_PROTOCOL *This, IN EFI_IP_ADDRESS *NewStationIp OPTIONAL, IN EFI_IP_ADDRESS *NewSubnetMask OPTIONAL);
typedef EFI_STATUS(EFIAPI *EFI_PXE_BASE_CODE_SET_PACKETS) (IN EFI_PXE_BASE_CODE_PROTOCOL *This, IN BOOLEAN *NewDhcpDiscoverValid OPTIONAL, IN BOOLEAN *NewDhcpAckReceived OPTIONAL, IN BOOLEAN *NewProxyOfferReceived OPTIONAL, IN BOOLEAN *NewPxeDiscoverValid OPTIONAL, IN BOOLEAN *NewPxeReplyReceived OPTIONAL, IN BOOLEAN *NewPxeBisReplyReceived OPTIONAL, IN EFI_PXE_BASE_CODE_PACKET *NewDhcpDiscover OPTIONAL, IN EFI_PXE_BASE_CODE_PACKET *NewDhcpAck OPTIONAL, IN EFI_PXE_BASE_CODE_PACKET *NewProxyOffer OPTIONAL, IN EFI_PXE_BASE_CODE_PACKET *NewPxeDiscover OPTIONAL, IN EFI_PXE_BASE_CODE_PACKET *NewPxeReply OPTIONAL, IN EFI_PXE_BASE_CODE_PACKET *NewPxeBisReply OPTIONAL);



struct EFI_PXE_BASE_CODE_PROTOCOL {
	UINT64 Revision;
	EFI_PXE_BASE_CODE_START Start;
	EFI_PXE_BASE_CODE_STOP Stop;
	EFI_PXE_BASE_CODE_DHCP Dhcp;
	EFI_PXE_BASE_CODE_DISCOVER Discover;
	EFI_PXE_BASE_CODE_MTFTP Mtftp;
	EFI_PXE_BASE_CODE_UDP_WRITE UdpWrite;
	EFI_PXE_BASE_CODE_UDP_READ UdpRead;
	EFI_PXE_BASE_CODE_SET_IP_FILTER SetIpFilter;
	EFI_PXE_BASE_CODE_ARP Arp;
	EFI_PXE_BASE_CODE_SET_PARAMETERS SetParameters;
	EFI_PXE_BASE_CODE_SET_STATION_IP SetStationIp;
	EFI_PXE_BASE_CODE_SET_PACKETS SetPackets;
	EFI_PXE_BASE_CODE_MODE *Mode;
};


#define EFI_PXE_BASE_CODE_CALLBACK_PROTOCOL_GUID \
 {0x245DCA21,0xFB7B,0x11d3, \
 {0x8F,0x01,0x00,0xA0, 0xC9,0x69,0x72,0x3B}}

#define EFI_PXE_BASE_CODE_CALLBACK_PROTOCOL_REVISION 0x00010000

typedef enum {
	EFI_PXE_BASE_CODE_CALLBACK_STATUS_FIRST,
	EFI_PXE_BASE_CODE_CALLBACK_STATUS_CONTINUE,
	EFI_PXE_BASE_CODE_CALLBACK_STATUS_ABORT,
	EFI_PXE_BASE_CODE_CALLBACK_STATUS_LAST
} EFI_PXE_BASE_CODE_CALLBACK_STATUS;

typedef enum {
	EFI_PXE_BASE_CODE_FUNCTION_FIRST,
	EFI_PXE_BASE_CODE_FUNCTION_DHCP,
	EFI_PXE_BASE_CODE_FUNCTION_DISCOVER,
	EFI_PXE_BASE_CODE_FUNCTION_MTFTP,
	EFI_PXE_BASE_CODE_FUNCTION_UDP_WRITE,
	EFI_PXE_BASE_CODE_FUNCTION_UDP_READ,
	EFI_PXE_BASE_CODE_FUNCTION_ARP,
	EFI_PXE_BASE_CODE_FUNCTION_IGMP,
	EFI_PXE_BASE_CODE_PXE_FUNCTION_LAST
} EFI_PXE_BASE_CODE_FUNCTION;

typedef EFI_PXE_BASE_CODE_CALLBACK_STATUS(EFIAPI *EFI_PXE_CALLBACK) (IN EFI_PXE_BASE_CODE_CALLBACK_PROTOCOL *This, IN EFI_PXE_BASE_CODE_FUNCTION Function, IN BOOLEAN Received, IN UINT32 PacketLen, IN EFI_PXE_BASE_CODE_PACKET *Packet OPTIONAL);

struct EFI_PXE_BASE_CODE_CALLBACK_PROTOCOL {
	UINT64 Revision;
	EFI_PXE_CALLBACK Callback;
};

#define EFI_BIS_PROTOCOL_GUID \
{0x0b64aab0,0x5429,0x11d4, \
{0x98,0x16,0x00,0xa0,0xc9,0x1f,0xad,0xcf}}

#define BIS_VERSION_1 1
#define BIS_CURRENT_VERSION_MAJOR BIS_VERSION_1

#define BIS_GET_SIGINFO_COUNT(BisDataPtr) ((BisDataPtr)->Length/sizeof(EFI_BIS_SIGNATURE_INFO))
#define BIS_GET_SIGINFO_ARRAY(BisDataPtr) ((EFI_BIS_SIGNATURE_INFO*)(BisDataPtr)->Data)

#define BIS_ALG_DSA (41) 
#define BIS_ALG_RSA_MD5 (42) 

#define BIS_CERT_ID_DSA BIS_ALG_DSA 
#define BIS_CERT_ID_RSA_MD5 BIS_ALG_RSA_MD5

#define BIS_CERT_ID_MASK (0xFF7F7FFF)

#define BOOT_OBJECT_AUTHORIZATION_PARMSET_GUID \
 {0xedd35e31,0x7b9,0x11d2,{0x83,0xa3,0x0,0xa0,0xc9,0x1f,0xad,0xcf}}

typedef VOID *BIS_APPLICATION_HANDLE;
typedef UINT32 BIS_CERT_ID;
typedef UINT16 BIS_ALG_ID;

struct EFI_BIS_VERSION {
	UINT32 Major;
	UINT32 Minor;
};

struct EFI_BIS_DATA {
	UINT32 Length;
	UINT8 *Data;
};

struct EFI_BIS_SIGNATURE_INFO {
	BIS_CERT_ID CertificateID;
	BIS_ALG_ID AlgorithmID;
	UINT16 KeyLength;
};



typedef EFI_STATUS(EFIAPI *EFI_BIS_INITIALIZE)(IN EFI_BIS_PROTOCOL *This, OUT BIS_APPLICATION_HANDLE *AppHandle, IN OUT EFI_BIS_VERSION *InterfaceVersion, IN EFI_BIS_DATA *TargetAddress);
typedef EFI_STATUS(EFIAPI *EFI_BIS_SHUTDOWN)(IN BIS_APPLICATION_HANDLE AppHandle);
typedef EFI_STATUS(EFIAPI *EFI_BIS_FREE)(IN BIS_APPLICATION_HANDLE AppHandle, IN EFI_BIS_DATA *ToFree);
typedef EFI_STATUS(EFIAPI *EFI_BIS_GET_BOOT_OBJECT_AUTHORIZATION_CERTIFICATE)(IN BIS_APPLICATION_HANDLE AppHandle, OUT EFI_BIS_DATA **Certificate);
typedef EFI_STATUS(EFIAPI *EFI_BIS_GET_BOOT_OBJECT_AUTHORIZATION_CHECKFLAG)(IN BIS_APPLICATION_HANDLE AppHandle, OUT BOOLEAN *CheckIsRequired);
typedef EFI_STATUS(EFIAPI *EFI_BIS_GET_BOOT_OBJECT_AUTHORIZATION_UPDATE_TOKEN)(IN BIS_APPLICATION_HANDLE AppHandle, OUT EFI_BIS_DATA **UpdateToken);
typedef EFI_STATUS(EFIAPI *EFI_BIS_GET_SIGNATURE_INFO)(IN BIS_APPLICATION_HANDLE AppHandle, OUT EFI_BIS_DATA **SignatureInfo);
typedef EFI_STATUS(EFIAPI *EFI_BIS_UPDATE_BOOT_OBJECT_AUTHORIZATION)(IN BIS_APPLICATION_HANDLE AppHandle, IN EFI_BIS_DATA *RequestCredential, OUT EFI_BIS_DATA **NewUpdateToken);
typedef EFI_STATUS(EFIAPI *EFI_BIS_VERIFY_BOOT_OBJECT)(IN BIS_APPLICATION_HANDLE AppHandle, IN EFI_BIS_DATA *Credentials, IN EFI_BIS_DATA *DataObject, OUT BOOLEAN *IsVerified);
typedef EFI_STATUS(EFIAPI *EFI_BIS_VERIFY_OBJECT_WITH_CREDENTIAL)(IN BIS_APPLICATION_HANDLE AppHandle, IN EFI_BIS_DATA *Credentials, IN EFI_BIS_DATA *DataObject, IN EFI_BIS_DATA *SectionName, IN EFI_BIS_DATA *AuthorityCertificate, OUT BOOLEAN *IsVerified);


struct EFI_BIS_PROTOCOL {
	EFI_BIS_INITIALIZE Initialize;
	EFI_BIS_SHUTDOWN Shutdown;
	EFI_BIS_FREE Free;
	EFI_BIS_GET_BOOT_OBJECT_AUTHORIZATION_CERTIFICATE GetBootObjectAuthorizationCertificate;
	EFI_BIS_GET_BOOT_OBJECT_AUTHORIZATION_CHECKFLAG	GetBootObjectAuthorizationCheckFlag;
	EFI_BIS_GET_BOOT_OBJECT_AUTHORIZATION_UPDATE_TOKEN GetBootObjectAuthorizationUpdateToken;
	EFI_BIS_GET_SIGNATURE_INFO GetSignatureInfo;
	EFI_BIS_UPDATE_BOOT_OBJECT_AUTHORIZATION UpdateBootObjectAuthorization;
	EFI_BIS_VERIFY_BOOT_OBJECT VerifyBootObject;
	EFI_BIS_VERIFY_OBJECT_WITH_CREDENTIAL VerifyObjectWithCredential;
};

#define EFI_MANAGED_NETWORK_SERVICE_BINDING_PROTOCOL_GUID \
 {0xf36ff770,0xa7e1,0x42cf, \
 {0x9ed2,0x56,0xf0,0xf2,0x71,0xf4,0x4c}}

#define EFI_MANAGED_NETWORK_PROTOCOL_GUID\
 {0x7ab33a91, 0xace5, 0x4326,\
 {0xb5, 0x72, 0xe7, 0xee, 0x33, 0xd3, 0x9f, 0x16}}

struct EFI_MANAGED_NETWORK_CONFIG_DATA {
	UINT32 ReceivedQueueTimeoutValue;
	UINT32 TransmitQueueTimeoutValue;
	UINT16 ProtocolTypeFilter;
	BOOLEAN EnableUnicastReceive;
	BOOLEAN EnableMulticastReceive;
	BOOLEAN EnableBroadcastReceive;
	BOOLEAN EnablePromiscuousReceive;
	BOOLEAN FlushQueuesOnReset;
	BOOLEAN EnableReceiveTimestamps;
	BOOLEAN DisableBackgroundPolling;
};

struct EFI_MANAGED_NETWORK_RECEIVE_DATA {
	EFI_TIME Timestamp;
	EFI_EVENT RecycleEvent;
	UINT32 PacketLength;
	UINT32 HeaderLength;
	UINT32 AddressLength;
	UINT32 DataLength;
	BOOLEAN BroadcastFlag;
	BOOLEAN MulticastFlag;
	BOOLEAN PromiscuousFlag;
	UINT16 ProtocolType;
	VOID *DestinationAddress;
	VOID *SourceAddress;
	VOID *MediaHeader;
	VOID *PacketData;
};

struct EFI_MANAGED_NETWORK_FRAGMENT_DATA {
	UINT32 FragmentLength;
	VOID *FragmentBuffer;
};

struct EFI_MANAGED_NETWORK_TRANSMIT_DATA {
	EFI_MAC_ADDRESS *DestinationAddress OPTIONAL;
	EFI_MAC_ADDRESS *SourceAddress OPTIONAL;
	UINT16 ProtocolType OPTIONAL;
	UINT32 DataLength;
	UINT16 HeaderLength OPTIONAL;
	UINT16 FragmentCount;
	EFI_MANAGED_NETWORK_FRAGMENT_DATA FragmentTable[1];
};

struct EFI_MANAGED_NETWORK_COMPLETION_TOKEN {
	EFI_EVENT Event;
	EFI_STATUS Status;
	union {
		EFI_MANAGED_NETWORK_RECEIVE_DATA *RxData;
		EFI_MANAGED_NETWORK_TRANSMIT_DATA *TxData;
	} Packet;
};

typedef EFI_STATUS(EFIAPI *EFI_MANAGED_NETWORK_GET_MODE_DATA) (IN EFI_MANAGED_NETWORK_PROTOCOL *This, OUT EFI_MANAGED_NETWORK_CONFIG_DATA *MnpConfigData OPTIONAL, OUT EFI_SIMPLE_NETWORK_MODE *SnpModeData OPTIONAL);
typedef EFI_STATUS(EFIAPI *EFI_MANAGED_NETWORK_CONFIGURE) (IN EFI_MANAGED_NETWORK_PROTOCOL *This, IN EFI_MANAGED_NETWORK_CONFIG_DATA *MnpConfigData OPTIONAL);
typedef EFI_STATUS(EFIAPI *EFI_MANAGED_NETWORK_MCAST_IP_TO_MAC) (IN EFI_MANAGED_NETWORK_PROTOCOL *This, IN BOOLEAN Ipv6Flag, IN EFI_IP_ADDRESS *IpAddress, OUT EFI_MAC_ADDRESS *MacAddress);
typedef EFI_STATUS(EFIAPI *EFI_MANAGED_NETWORK_GROUPS) (IN EFI_MANAGED_NETWORK_PROTOCOL *This, IN BOOLEAN JoinFlag, IN EFI_MAC_ADDRESS *MacAddress OPTIONAL);
typedef EFI_STATUS(EFIAPI *EFI_MANAGED_NETWORK_TRANSMIT) (IN EFI_MANAGED_NETWORK_PROTOCOL *This, IN EFI_MANAGED_NETWORK_COMPLETION_TOKEN *Token);
typedef EFI_STATUS(EFIAPI *EFI_MANAGED_NETWORK_RECEIVE) (IN EFI_MANAGED_NETWORK_PROTOCOL *This, IN EFI_MANAGED_NETWORK_COMPLETION_TOKEN *Token);
typedef EFI_STATUS(EFIAPI *EFI_MANAGED_NETWORK_CANCEL)(IN EFI_MANAGED_NETWORK_PROTOCOL *This, IN EFI_MANAGED_NETWORK_COMPLETION_TOKEN *Token OPTIONAL);
typedef EFI_STATUS(EFIAPI *EFI_MANAGED_NETWORK_POLL) (IN EFI_MANAGED_NETWORK_PROTOCOL *This);


struct EFI_MANAGED_NETWORK_PROTOCOL {
	EFI_MANAGED_NETWORK_GET_MODE_DATA GetModeData;
	EFI_MANAGED_NETWORK_CONFIGURE Configure;
	EFI_MANAGED_NETWORK_MCAST_IP_TO_MAC McastIpToMac;
	EFI_MANAGED_NETWORK_GROUPS Groups;
	EFI_MANAGED_NETWORK_TRANSMIT Transmit;
	EFI_MANAGED_NETWORK_RECEIVE Receive;
	EFI_MANAGED_NETWORK_CANCEL Cancel;
	EFI_MANAGED_NETWORK_POLL Poll;
};

#define EFI_VLAN_CONFIG_PROTOCOL_GUID \
 {0x9e23d768, 0xd2f3, 0x4366, \
 {0x9f, 0xc3, 0x3a, 0x7a, 0xba, 0x86, 0x43, 0x74}}

struct EFI_VLAN_FIND_DATA {
	UINT16 VlanId;
	UINT8 Priority;
};

typedef EFI_STATUS(EFIAPI * EFI_VLAN_CONFIG_SET) (IN EFI_VLAN_CONFIG_PROTOCOL This, IN UINT16 VlanId, IN UINT8 Priority);
typedef EFI_STATUS(EFIAPI *EFI_VLAN_CONFIG_FIND) (IN EFI_VLAN_CONFIG_PROTOCOL *This, IN UINT16 *VlanId OPTIONAL, OUT UINT16 *NumberOfVlan, OUT EFI_VLAN_FIND_DATA **Entries);
typedef EFI_STATUS(EFIAPI * EFI_VLAN_CONFIG_REMOVE) (IN EFI_VLAN_CONFIG_PROTOCOL *This, IN UINT16 VlanId);

struct EFI_VLAN_CONFIG_PROTOCOL {
	EFI_VLAN_CONFIG_SET Set;
	EFI_VLAN_CONFIG_FIND Find;
	EFI_VLAN_CONFIG_REMOVE Remove;
};
#define EFI_EAP_PROTOCOL_GUID \
 { 0x5d9f96db, 0xe731, 0x4caa, \
 {0xa0, 0x0d, 0x72, 0xe1, 0x87, 0xcd, 0x77, 0x62 }}

#define EFI_EAP_TYPE_TLS 13 // REQUIRED - RFC 5216 

typedef VOID* EFI_PORT_HANDLE;

typedef EFI_STATUS(EFIAPI *EFI_EAP_BUILD_RESPONSE_PACKET) (IN EFI_PORT_HANDLE PortNumber, IN UINT8 *RequestBuffer, IN UINTN RequestSize, IN UINT8 *Buffer, IN OUT UINTN *BufferSize);
typedef EFI_STATUS(EFIAPI *EFI_EAP_SET_DESIRED_AUTHENTICATION_METHOD) (IN struct _EFI_EAP_PROTOCOL *This, IN UINT8 EapAuthType);
typedef EFI_STATUS(EFIAPI *EFI_EAP_REGISTER_AUTHENTICATION_METHOD) (IN struct _EFI_EAP_PROTOCOL *This, IN UINT8 EapAuthType, IN EFI_EAP_BUILD_RESPONSE_PACKET Handler);

struct EFI_EAP_PROTOCOL {
	EFI_EAP_SET_DESIRED_AUTHENTICATION_METHOD SetDesiredAuthMethod;
	EFI_EAP_REGISTER_AUTHENTICATION_METHOD RegisterAuthMethod;
};

#define EFI_EAP_MANAGEMENT_PROTOCOL_GUID \
 { 0xbb62e663, 0x625d, 0x40b2, \
 { 0xa0, 0x88, 0xbb, 0xe8, 0x36, 0x23, 0xa2, 0x45 }

#define PAE_SUPPORT_AUTHENTICATOR 0x01
#define PAE_SUPPORT_SUPPLICANT 0x02

#define AUTH_PERIOD_FIELD_VALID 0x01
#define HELD_PERIOD_FIELD_VALID 0x02
#define START_PERIOD_FIELD_VALID 0x04
#define MAX_START_FIELD_VALID 0x08

typedef enum _EFI_EAPOL_SUPPLICANT_PAE_STATE {
	Logoff,
	Disconnected,
	Connecting,
	Acquired,
	Authenticating,
	Held,
	Authenticated,
	MaxSupplicantPaeState
} EFI_EAPOL_SUPPLICANT_PAE_STATE;

struct EFI_EAPOL_PORT_INFO {
	EFI_PORT_HANDLE PortNumber;
	UINT8 ProtocolVersion;
	UINT8 PaeCapabilities;
};

struct EFI_EAPOL_SUPPLICANT_PAE_CONFIGURATION {
	UINT8 ValidFieldMask;
	UINTN AuthPeriod;
	UINTN HeldPeriod;
	UINTN StartPeriod;
	UINTN MaxStart;
};

struct EFI_EAPOL_SUPPLICANT_PAE_STATISTICS {
	UINTN EapolFramesReceived;
	UINTN EapolFramesTransmitted;
	UINTN EapolStartFramesTransmitted;
	UINTN EapolLogoffFramesTransmitted;
	UINTN EapRespIdFramesTransmitted;
	UINTN EapResponseFramesTransmitted;
	UINTN EapReqIdFramesReceived;
	UINTN EapRequestFramesReceived;
	UINTN InvalidEapolFramesReceived;
	UINTN EapLengthErrorFramesReceived;
	UINTN LastEapolFrameVersion;
	UINTN LastEapolFrameSource;
};

typedef EFI_STATUS(EFIAPI *EFI_EAP_GET_SYSTEM_CONFIGURATION) (IN EFI_EAP_MANAGEMENT_PROTOCOL *This, OUT BOOLEAN *SystemAuthControl, OUT EFI_EAPOL_PORT_INFO *PortInfo OPTIONAL);
typedef EFI_STATUS(EFIAPI *EFI_EAP_SET_SYSTEM_CONFIGURATION) (IN EFI_EAP_MANAGEMENT_PROTOCOL *This, IN BOOLEAN SystemAuthControl);
typedef EFI_STATUS(EFIAPI *EFI_EAP_INITIALIZE_PORT) (IN EFI_EAP_MANAGEMENT_PROTOCOL *This);
typedef EFI_STATUS(EFIAPI *EFI_EAP_USER_LOGON) (IN EFI_EAP_MANAGEMENT_PROTOCOL *This);
typedef EFI_STATUS(EFIAPI *EFI_EAP_USER_LOGOFF) (IN EFI_EAP_MANAGEMENT_PROTOCOL *This);
typedef EFI_STATUS(EFIAPI *EFI_EAP_GET_SUPPLICANT_STATUS) (IN EFI_EAP_MANAGEMENT_PROTOCOL *This, OUT EFI_EAPOL_SUPPLICANT_PAE_STATE *CurrentState, IN OUT EFI_EAPOL_SUPPLICANT_PAE_CONFIGURATION *Configuration	OPTIONAL);
typedef EFI_STATUS(EFIAPI *EFI_EAP_SET_SUPPLICANT_CONFIGURATION) (IN EFI_EAP_MANAGEMENT_PROTOCOL *This, IN EFI_EAPOL_SUPPLICANT_PAE_CONFIGURATION *Configuration);
typedef EFI_STATUS(EFIAPI *EFI_EAP_GET_SUPPLICANT_STATISTICS) (IN EFI_EAP_MANAGEMENT_PROTOCOL *This, OUT EFI_EAPOL_SUPPLICANT_PAE_STATISTICS *Statistics);

struct EFI_EAP_MANAGEMENT_PROTOCOL {
	EFI_EAP_GET_SYSTEM_CONFIGURATION GetSystemConfiguration;
	EFI_EAP_SET_SYSTEM_CONFIGURATION SetSystemConfiguration;
	EFI_EAP_INITIALIZE_PORT InitializePort;
	EFI_EAP_USER_LOGON UserLogon;
	EFI_EAP_USER_LOGOFF UserLogoff;
	EFI_EAP_GET_SUPPLICANT_STATUS GetSupplicantStatus;
	EFI_EAP_SET_SUPPLICANT_CONFIGURATION SetSupplicantConfiguration;
	EFI_EAP_GET_SUPPLICANT_STATISTICS GetSupplicantStatistics;
};

#define EFI_EAP_MANAGEMENT2_PROTOCOL_GUID \
 { 0x5e93c847, 0x456d, 0x40b3, \
 { 0xa6, 0xb4, 0x78, 0xb0, 0xc9, 0xcf, 0x7f, 0x20 }}

typedef EFI_STATUS(EFIAPI *EFI_EAP_GET_KEY)(IN EFI_EAP_MANAGEMENT2_PROTOCOL *This, IN OUT UINT8 *Msk, IN OUT UINTN *MskSize, IN OUT UINT8 *Emsk, IN OUT UINT8 *EmskSize);

struct EFI_EAP_MANAGEMENT2_PROTOCOL {
	EFI_EAP_GET_SYSTEM_CONFIGURATION GetSystemConfiguration;
	EFI_EAP_SET_SYSTEM_CONFIGURATION SetSystemConfiguration;
	EFI_EAP_INITIALIZE_PORT InitializePort;
	EFI_EAP_USER_LOGON UserLogon;
	EFI_EAP_USER_LOGOFF UserLogoff;
	EFI_EAP_GET_SUPPLICANT_STATUS GetSupplicantStatus;
	EFI_EAP_SET_SUPPLICANT_CONFIGURATION SetSupplicantConfiguration;
	EFI_EAP_GET_SUPPLICANT_STATISTICS GetSupplicantStatistics;
	// Same as EFI_EAP_MANAGEMENT_PROTOCOL
	EFI_EAP_GET_KEY GetKey;
};

#define EFI_EAP_CONFIGURATION_PROTOCOL_GUID \
 { 0xe5b58dbb, 0x7688, 0x44b4, \
 { 0x97, 0xbf, 0x5f, 0x1d, 0x4b, 0x7c, 0xc8, 0xdb }}

#define EFI_EAP_TYPE_ATTRIBUTE 0
#define EFI_EAP_TYPE_IDENTITY 1
#define EFI_EAP_TYPE_NOTIFICATION 2
#define EFI_EAP_TYPE_NAK 3
#define EFI_EAP_TYPE_MD5CHALLENGE 4
#define EFI_EAP_TYPE_OTP 5
#define EFI_EAP_TYPE_GTC 6
#define EFI_EAP_TYPE_EAPTLS 13
#define EFI_EAP_TYPE_EAPSIM 18
#define EFI_EAP_TYPE_TTLS 21
#define EFI_EAP_TYPE_PEAP 25
#define EFI_EAP_TYPE_MSCHAPV2 26
#define EFI_EAP_TYPE_EAP_EXTENSION 33

typedef UINT8 EFI_EAP_TYPE;

typedef enum {
	// EFI_EAP_TYPE_ATTRIBUTE
	EfiEapConfigEapAuthMethod,
	EfiEapConfigEapSupportedAuthMethod,
	// EapTypeIdentity
	EfiEapConfigIdentityString,
	// EapTypeEAPTLS/EapTypePEAP
	EfiEapConfigEapTlsCACert,
	EfiEapConfigEapTlsClientCert,
	EfiEapConfigEapTlsClientPrivateKeyFile,
	EfiEapConfigEapTlsClientPrivateKeyFilePassword, \
	// ASCII format, Volatile
	EfiEapConfigEapTlsCipherSuite,
	EfiEapConfigEapTlsSupportedCipherSuite,
	// EapTypeMSChapV2
	EfiEapConfigEapMSChapV2Password, // UNICODE format, Volatile
									 // EapTypePEAP
	EfiEapConfigEap2ndAuthMethod,
	// More...
} EFI_EAP_CONFIG_DATA_TYPE;

typedef EFI_STATUS(EFIAPI *EFI_EAP_CONFIGURATION_SET_DATA)(IN EFI_EAP_CONFIGURATION_PROTOCOL *This, IN EFI_EAP_TYPE EapType, IN EFI_EAP_CONFIG_DATA_TYPE DataType, IN VOID *Data, IN UINTN DataSize);
typedef EFI_STATUS(EFIAPI *EFI_EAP_CONFIGURATION_GET_DATA)(IN EFI_EAP_CONFIGURATION_PROTOCOL *This, IN EFI_EAP_TYPE EapType, IN EFI_EAP_CONFIG_DATA_TYPE DataType, IN OUT VOID *Data, IN OUT UINTN *DataSize);

struct EFI_EAP_CONFIGURATION_PROTOCOL {
	EFI_EAP_CONFIGURATION_SET_DATA SetData;
	EFI_EAP_CONFIGURATION_GET_DATA GetData;
};

#define EFI_WIRELESS_MAC_CONNECTION_PROTOCOL_GUID \
 { 0xda55bc9, 0x45f8, 0x4bb4, \
 { 0x87, 0x19, 0x52, 0x24, 0xf1, 0x8a, 0x4d, 0x45 }}

typedef enum {
	IeeeInfrastructureBSS,
	IeeeIndependentBSS,
	IeeeMeshBSS,
	IeeeAnyBss
} EFI_80211_BSS_TYPE;typedef enum {
	IeeePrivate = 0,
	IeeePrivatewithGuest = 1,
	IeeeChargeablePublic = 2,
	IeeeFreePublic = 3,
	IeeePersonal = 4,
	IeeeEmergencyServOnly = 5,
	IeeeTestOrExp = 14,
	IeeeWildcard = 15
} EFI_80211_ACC_NET_TYPE;typedef enum {
	ScanSuccess,
	ScanNotSupported
} EFI_80211_SCAN_RESULT_CODE;typedef enum {
	AssociateSuccess,
	AssociateRefusedReasonUnspecified,
	AssociateRefusedCapsMismatch,
	AssociateRefusedExtReason,
	AssociateRefusedAPOutOfMemory,
	AssociateRefusedBasicRatesMismatch,
	AssociateRejectedEmergencyServicesNotSupported,
	AssociateRefusedTemporarily
} EFI_80211_ASSOCIATE_RESULT_CODE;typedef enum {
	Ieee80211UnspecifiedReason = 1,
	Ieee80211PreviousAuthenticateInvalid = 2,
	Ieee80211DeauthenticatedSinceLeaving = 3,
	Ieee80211DisassociatedDueToInactive = 4,
	Ieee80211DisassociatedSinceApUnable = 5,
	Ieee80211Class2FrameNonauthenticated = 6,
	Ieee80211Class3FrameNonassociated = 7,
	Ieee80211DisassociatedSinceLeaving = 8,
	// ...
} EFI_80211_REASON_CODE;typedef enum {
	DisassociateSuccess,
	DisassociateInvalidParameters
} EFI_80211_DISASSOCIATE_RESULT_CODE;typedef enum {
	OpenSystem,
	SharedKey,
	FastBSSTransition,
	SAE
} EFI_80211_AUTHENTICATION_TYPE;typedef enum {
	AuthenticateSuccess,
	AuthenticateRefused,
	AuthenticateAnticLoggingTokenRequired,
	AuthenticateFiniteCyclicGroupNotSupported,
	AuthenticationRejected,
	AuthenticateInvalidParameter
} EFI_80211_AUTHENTICATE_RESULT_CODE;
struct EFI_80211_ELEMENT_HEADER {
	UINT8 ElementID;
	UINT8 Length;
};

struct EFI_80211_ELEMENT_REQ {
	EFI_80211_ELEMENT_HEADER Hdr;
	UINT8 RequestIDs[1];
};

struct EFI_80211_ELEMENT_SSID {
	EFI_80211_ELEMENT_HEADER Hdr;
	UINT8 SSId[32];
};

struct EFI_80211_MAC_ADDRESS {
	UINT8 Addr[6];
};

struct EFI_80211_SCAN_DATA {
	EFI_80211_BSS_TYPE BSSType;
	EFI_80211_MAC_ADDRESS BSSId;
	UINT8 SSIdLen;
	UINT8 *SSId;
	BOOLEAN PassiveMode;
	UINT32 ProbeDelay;
	UINT32 *ChannelList;
	UINT32 MinChannelTime;
	UINT32 MaxChannelTime;
	EFI_80211_ELEMENT_REQ *RequestInformation;
	EFI_80211_ELEMENT_SSID *SSIDList;
	EFI_80211_ACC_NET_TYPE AccessNetworkType;
	UINT8 *VendorSpecificInfo;
};

struct EFI_80211_COUNTRY_TRIPLET_SUBBAND {
	UINT8 FirstChannelNum;
	UINT8 NumOfChannels;
	UINT8 MaxTxPowerLevel;
};

struct EFI_80211_COUNTRY_TRIPLET_OPERATE {
	UINT8 OperatingExtId;
	UINT8 OperatingClass;
	UINT8 CoverageClass;
};

typedef union {
	EFI_80211_COUNTRY_TRIPLET_SUBBAND Subband;
	EFI_80211_COUNTRY_TRIPLET_OPERATE Operating;
} EFI_80211_COUNTRY_TRIPLET;

struct EFI_80211_ELEMENT_COUNTRY {
	EFI_80211_ELEMENT_HEADER Hdr;
	UINT8 CountryStr[3];
	EFI_80211_COUNTRY_TRIPLET CountryTriplet[1];
};

struct EFI_80211_ELEMENT_DATA_RSN {
	UINT16 Version;
	UINT32 GroupDataCipherSuite;
	//UINT16 PairwiseCipherSuiteCount;
	//UINT32 PairwiseCipherSuiteList[PairwiseCipherSuiteCount];
	//UINT16 AKMSuiteCount;
	//UINT32 AKMSuiteList[AKMSuiteCount];
	//UINT16 RSNCapabilities;
	//UINT16 PMKIDCount;
	//UINT8 PMKIDList[PMKIDCount][16];
	//UINT32 GroupManagementCipherSuite;
};

struct EFI_80211_ELEMENT_RSN {
	EFI_80211_ELEMENT_HEADER Hdr;
	EFI_80211_ELEMENT_DATA_RSN *Data;
};

struct EFI_80211_SUBELEMENT_INFO {
	UINT8 SubElementID;
	UINT8 Length;
	UINT8 Data[1];
};

struct EFI_80211_ELEMENT_EXT_CAP {
	EFI_80211_ELEMENT_HEADER Hdr;
	UINT8 Capabilities[1];
};

struct EFI_80211_BSS_DESCRIPTION {
	EFI_80211_MAC_ADDRESS BSSId;
	UINT8 *SSId;
	UINT8 SSIdLen;
	EFI_80211_BSS_TYPE BSSType;
	UINT16 BeaconPeriod;
	UINT64 Timestamp;
	UINT16 CapabilityInfo;
	UINT8 *BSSBasicRateSet;
	UINT8 *OperationalRateSet;
	EFI_80211_ELEMENT_COUNTRY *Country;
	EFI_80211_ELEMENT_RSN RSN;
	UINT8 RSSI;
	UINT8 RCPIMeasurement;
	UINT8 RSNIMeasurement;
	UINT8 *RequestedElements;
	UINT8 *BSSMembershipSelectorSet;
	EFI_80211_ELEMENT_EXT_CAP *ExtCapElement;
};

struct EFI_80211_MULTIPLE_BSSID {
	EFI_80211_ELEMENT_HEADER Hdr;
	UINT8 Indicator;
	EFI_80211_SUBELEMENT_INFO SubElement[1];
};

struct EFI_80211_BSS_DESP_PILOT {
	EFI_80211_MAC_ADDRESS BSSId;
	EFI_80211_BSS_TYPE BSSType;
	UINT8 ConCapInfo;
	UINT8 ConCountryStr[2];
	UINT8 OperatingClass;
	UINT8 Channel;
	UINT8 Interval;
	EFI_80211_MULTIPLE_BSSID *MultipleBSSID;
	UINT8 RCPIMeasurement;
	UINT8 RSNIMeasurement;
};

struct EFI_80211_SCAN_RESULT {
	UINTN NumOfBSSDesp;
	EFI_80211_BSS_DESCRIPTION **BSSDespSet;
	UINTN NumofBSSDespFromPilot;
	EFI_80211_BSS_DESP_PILOT **BSSDespFromPilotSet;
	UINT8 *VendorSpecificInfo;
};

struct EFI_80211_SCAN_DATA_TOKEN {
	EFI_EVENT Event;
	EFI_STATUS Status;
	EFI_80211_SCAN_DATA *Data;
	EFI_80211_SCAN_RESULT_CODE ResultCode;
	EFI_80211_SCAN_RESULT *Result;
};

struct EFI_80211_ELEMENT_SUPP_CHANNEL_TUPLE {
	UINT8 FirstChannelNumber;
	UINT8 NumberOfChannels;
};

struct EFI_80211_ELEMENT_SUPP_CHANNEL {
	EFI_80211_ELEMENT_HEADER Hdr;
	EFI_80211_ELEMENT_SUPP_CHANNEL_TUPLE Subband[1];
};

struct EFI_80211_ASSOCIATE_DATA {
	EFI_80211_MAC_ADDRESS BSSId;
	UINT16 CapabilityInfo;
	UINT32 FailureTimeout;
	UINT32 ListenInterval;
	EFI_80211_ELEMENT_SUPP_CHANNEL *Channels;
	EFI_80211_ELEMENT_RSN RSN;
	EFI_80211_ELEMENT_EXT_CAP *ExtCapElement;
	UINT8 *VendorSpecificInfo;
};

struct EFI_80211_ELEMENT_TIMEOUT_VAL {
	EFI_80211_ELEMENT_HEADER Hdr;
	UINT8 Type;
	UINT32 Value;
};

struct EFI_80211_ASSOCIATE_RESULT {
	EFI_80211_MAC_ADDRESS BSSId;
	UINT16 CapabilityInfo;
	UINT16 AssociationID;
	UINT8 RCPIValue;
	UINT8 RSNIValue;
	EFI_80211_ELEMENT_EXT_CAP *ExtCapElement;
	EFI_80211_ELEMENT_TIMEOUT_VAL TimeoutInterval;
	UINT8 *VendorSpecificInfo;
};

struct EFI_80211_ASSOCIATE_DATA_TOKEN {
	EFI_EVENT Event;
	EFI_STATUS Status;
	EFI_80211_ASSOCIATE_DATA *Data;
	EFI_80211_ASSOCIATE_RESULT_CODE ResultCode;
	EFI_80211_ASSOCIATE_RESULT *Result;
};

struct EFI_80211_DISASSOCIATE_DATA {
	EFI_80211_MAC_ADDRESS BSSId;
	EFI_80211_REASON_CODE ReasonCode;
	UINT8 *VendorSpecificInfo;
};

struct EFI_80211_DISASSOCIATE_DATA_TOKEN {
	EFI_EVENT Event;
	EFI_STATUS Status;
	EFI_80211_DISASSOCIATE_DATA *Data;
	EFI_80211_DISASSOCIATE_RESULT_CODE ResultCode;
};

struct EFI_80211_AUTHENTICATE_DATA {
	EFI_80211_MAC_ADDRESS BSSId;
	EFI_80211_AUTHENTICATION_TYPE AuthType;
	UINT32 FailureTimeout;
	UINT8 *FTContent;
	UINT8 *SAEContent;
	UINT8 *VendorSpecificInfo;
};

struct EFI_80211_AUTHENTICATE_RESULT {
	EFI_80211_MAC_ADDRESS BSSId;
	UINT8 *FTContent;
	UINT8 *SAEContent;
	UINT8 *VendorSpecificInfo;
};

struct EFI_80211_AUTHENTICATE_DATA_TOKEN {
	EFI_EVENT Event;
	EFI_STATUS Status;
	EFI_80211_AUTHENTICATE_DATA *Data;
	EFI_80211_AUTHENTICATE_RESULT_CODE ResultCode;
	EFI_80211_AUTHENTICATE_RESULT *Result;
};

struct EFI_80211_DEAUTHENTICATE_DATA {
	EFI_80211_MAC_ADDRESS BSSId;
	EFI_80211_REASON_CODE ReasonCode;
	UINT8 *VendorSpecificInfo;
};

struct EFI_80211_DEAUTHENTICATE_DATA_TOKEN {
	EFI_EVENT Event;
	EFI_STATUS Status;
	EFI_80211_DEAUTHENTICATE_DATA *Data;
};

typedef EFI_STATUS(EFIAPI *EFI_WIRELESS_MAC_CONNECTION_SCAN)(IN EFI_WIRELESS_MAC_CONNECTION_PROTOCOL *This, IN EFI_80211_SCAN_DATA_TOKEN *Data);
typedef EFI_STATUS(EFIAPI *EFI_WIRELESS_MAC_CONNECTION_ASSOCIATE)(IN EFI_WIRELESS_MAC_CONNECTION_PROTOCOL *This, IN EFI_80211_ASSOCIATE_DATA_TOKEN *Data);
typedef EFI_STATUS(EFIAPI *EFI_WIRELESS_MAC_CONNECTION_DISASSOCIATE)(IN EFI_WIRELESS_MAC_CONNECTION_PROTOCOL *This, IN EFI_80211_DISASSOCIATE_DATA_TOKEN *Data);
typedef EFI_STATUS(EFIAPI *EFI_WIRELESS_MAC_CONNECTION_AUTHENTICATE)(IN EFI_WIRELESS_MAC_CONNECTION_PROTOCOL *This, IN EFI_80211_AUTHENTICATE_DATA_TOKEN *Data);
typedef EFI_STATUS(EFIAPI *EFI_WIRELESS_MAC_CONNECTION_DEAUTHENTICATE)(IN EFI_WIRELESS_MAC_CONNECTION_PROTOCOL *This, IN EFI_80211_DEAUTHENTICATE_DATA_TOKEN *Data);

struct EFI_WIRELESS_MAC_CONNECTION_PROTOCOL {
	EFI_WIRELESS_MAC_CONNECTION_SCAN Scan;
	EFI_WIRELESS_MAC_CONNECTION_ASSOCIATE Associate;
	EFI_WIRELESS_MAC_CONNECTION_DISASSOCIATE Disassociate;
	EFI_WIRELESS_MAC_CONNECTION_AUTHENTICATE Authenticate;
	EFI_WIRELESS_MAC_CONNECTION_DEAUTHENTICATE Deauthenticate;
};

#define EFI_WIRELESS_MAC_CONNECTION_II_PROTOCOL_GUID \
 { 0x1b0fb9bf, 0x699d, 0x4fdd, \
 { 0xa7, 0xc3, 0x25, 0x46, 0x68, 0x1b, 0xf6, 0x3b }}

typedef enum {
	ConnectSuccess,
	ConnectRefused,
	ConnectFailed,
	ConnectFailureTimeout,
	ConnectFailedReasonUnspecified
} EFI_80211_CONNECT_NETWORK_RESULT_CODE;

struct EFI_80211_SSID {
	UINT8 SSIdLen;
	UINT8* SSId;
};

struct EFI_80211_SUITE_SELECTOR {
	UINT8 Oui[3];
	UINT8 SuiteType;
};

struct EFI_80211_AKM_SUITE_SELECTOR {
	UINT16 AKMSuiteCount;
	EFI_80211_SUITE_SELECTOR AKMSuiteList[1];
};

struct EFI_80211_CIPHER_SUITE_SELECTOR {
	UINT16 CipherSuiteCount;
	EFI_80211_SUITE_SELECTOR CipherSuiteList[1];
};

struct EFI_80211_NETWORK {
	EFI_80211_BSS_TYPE BSSType;
	EFI_80211_SSID SSId;
	EFI_80211_AKM_SUITE_SELECTOR *AKMSuite;
	EFI_80211_CIPHER_SUITE_SELECTOR *CipherSuite;
};

struct EFI_80211_NETWORK_DESCRIPTION {
	EFI_80211_NETWORK Network;
	UINT8 NetworkQuality;
};

struct EFI_80211_GET_NETWORKS_RESULT {
	UINT8 NumOfNetworkDesc;
	EFI_80211_NETWORK_DESCRIPTION **NetworkDesc;
};

struct EFI_80211_GET_NETWORKS_DATA {
	UINT32 NumOfSSID;
	EFI_80211_SSID SSIDList[1];
};

struct EFI_80211_GET_NETWORKS_TOKEN {
	EFI_EVENT Event;
	EFI_STATUS Status;
	EFI_80211_GET_NETWORKS_DATA *Data;
	EFI_80211_GET_NETWORKS_RESULT *Result;
};

struct EFI_80211_CONNECT_NETWORK_DATA {
	EFI_80211_NETWORK *Network;
	UINT32 FailureTimeout;
};

struct EFI_80211_CONNECT_NETWORK_TOKEN {
	EFI_EVENT Event;
	EFI_STATUS Status;
	EFI_80211_CONNECT_NETWORK_DATA *Data;
	EFI_80211_CONNECT_NETWORK_RESULT_CODE ResultCode;
};

struct EFI_80211_DISCONNECT_NETWORK_TOKEN {
	EFI_EVENT Event;
	EFI_STATUS Status;
};

typedef EFI_STATUS(EFIAPI *EFI_WIRELESS_MAC_CONNECTION_II_GET_NETWORKS)(IN EFI_WIRELESS_MAC_CONNECTION_II_PROTOCOL *This, IN EFI_80211_GET_NETWORKS_TOKEN *Token);
typedef EFI_STATUS(EFIAPI *EFI_WIRELESS_MAC_CONNECTION_II_CONNECT_NETWORK)(IN EFI_WIRELESS_MAC_CONNECTION_II_PROTOCOL *This, IN EFI_80211_CONNECT_NETWORK_TOKEN *Token);
typedef EFI_STATUS(EFIAPI *EFI_WIRELESS_MAC_CONNECTION_II_DISCONNECT_NETWORK)(IN EFI_WIRELESS_MAC_CONNECTION_II_PROTOCOL *This, IN EFI_80211_DISCONNECT_NETWORK_TOKEN *Token);

struct EFI_WIRELESS_MAC_CONNECTION_II_PROTOCOL {
	EFI_WIRELESS_MAC_CONNECTION_II_GET_NETWORKS GetNetworks;
	EFI_WIRELESS_MAC_CONNECTION_II_CONNECT_NETWORK ConnectNetwork;
	EFI_WIRELESS_MAC_CONNECTION_II_DISCONNECT_NETWORK DisconnectNetwork;
};

#define EFI_SUPPLICANT_SERVICE_BINDING_PROTOCOL_GUID \
 { 0x45bcd98e, 0x59ad, 0x4174, \
 { 0x95, 0x46, 0x34, 0x4a, 0x7, 0x48, 0x58, 0x98 }}

#define EFI_SUPPLICANT_PROTOCOL_GUID \
 { 0x54fcc43e, 0xaa89, 0x4333, \
 { 0x9a, 0x85, 0xcd, 0xea, 0x24, 0x5, 0x1e, 0x9e }}

#define EFI_MAX_KEY_LEN 64

typedef enum {
	EfiSupplicantEncrypt,
	EfiSupplicantDecrypt,
} EFI_SUPPLICANT_CRYPT_MODE;

typedef enum {
	//
	// Session Configuration
	//
	EfiSupplicant80211AKMSuite,
	EfiSupplicant80211GroupDataCipherSuite,
	EfiSupplicant80211PairwiseCipherSuite,
	EfiSupplicant80211PskPassword,
	EfiSupplicant80211TargetSSIDName,
	EfiSupplicant80211StationMac,
	EfiSupplicant80211TargetSSIDMac,
	//
	// Session Information
	//
	EfiSupplicant80211PTK,
	EfiSupplicant80211GTK,
	EfiSupplicantState,
	EfiSupplicant80211LinkState,
	EfiSupplicantKeyRefresh,
	//
	// Session Configuration
	//
	EfiSupplicant80211SupportedAKMSuites,
	EfiSupplicant80211SupportedSoftwareCipherSuites,
	EfiSupplicant80211SupportedHardwareCipherSuites,
	//
	// Session Information
	//
	EfiSupplicant80211IGTK,
	EfiSupplicantDataTypeMaximum
} EFI_SUPPLICANT_DATA_TYPE;

typedef enum {
	Ieee80211UnauthenticatedUnassociated,
	Ieee80211AuthenticatedUnassociated,
	Ieee80211PendingRSNAuthentication,
	Ieee80211AuthenticatedAssociated
} EFI_80211_LINK_STATE;

typedef enum {
	Group,
	Pairwise,
	PeerKey,
	IGTK
} EFI_SUPPLICANT_KEY_TYPE;

typedef enum {
	Receive,
	Transmit,
	Both
} EFI_SUPPLICANT_KEY_DIRECTION;

struct EFI_SUPPLICANT_FRAGMENT_DATA {
	UINT32 FragmentLength;
	VOID *FragmentBuffer;
};

struct EFI_SUPPLICANT_KEY_REFRESH {
	BOOLEAN GTKRefresh;
};

struct EFI_SUPPLICANT_KEY {
	UINT8* Key;
	UINT8 KeyLen;
	UINT8 KeyId;
	EFI_SUPPLICANT_KEY_TYPE KeyType;
	EFI_80211_MAC_ADDRESS Addr;
	UINT8 Rsc[8];
	UINT8 RscLen;
	BOOLEAN IsAuthenticator;
	EFI_80211_SUITE_SELECTOR CipherSuite;
	EFI_SUPPLICANT_KEY_DIRECTION Direction;
};

struct EFI_SUPPLICANT_GTK_LIST {
	UINT8 GTKCount;
	EFI_SUPPLICANT_KEY GTKList[1];
};

typedef EFI_STATUS(EFIAPI *EFI_SUPPLICANT_BUILD_RESPONSE_PACKET)(IN EFI_SUPPLICANT_PROTOCOL *This, IN UINT8 *RequestBuffer OPTIONAL, IN UINTN RequestBufferSize OPTIONAL, OUT UINT8 *Buffer, IN OUT UINTN *BufferSize);
typedef EFI_STATUS(EFIAPI *EFI_SUPPLICANT_PROCESS_PACKET)(IN EFI_SUPPLICANT_PROTOCOL *This, IN OUT EFI_SUPPLICANT_FRAGMENT_DATA **FragmentTable, IN UINT32 *FragmentCount, IN EFI_SUPPLICANT_CRYPT_MODE CryptMode);
typedef EFI_STATUS(EFIAPI *EFI_SUPPLICANT_SET_DATA)(IN EFI_SUPPLICANT_PROTOCOL *This, IN EFI_SUPPLICANT_DATA_TYPE DataType, IN VOID *Data, IN UINTN DataSize);
typedef EFI_STATUS(EFIAPI *EFI_SUPPLICANT_GET_DATA)(IN EFI_SUPPLICANT_PROTOCOL *This, IN EFI_SUPPLICANT_DATA_TYPE DataType, OUT UINT8 *Data OPTIONAL, IN OUT UINTN *DataSize);

struct EFI_SUPPLICANT_PROTOCOL {
	EFI_SUPPLICANT_BUILD_RESPONSE_PACKET BuildResponsePacket;
	EFI_SUPPLICANT_PROCESS_PACKET ProcessPacket;
	EFI_SUPPLICANT_SET_DATA SetData;
	EFI_SUPPLICANT_GET_DATA GetData;
};
#define EFI_BLUETOOTH_HC_PROTOCOL_GUID \
 { 0xb3930571, 0xbeba, 0x4fc5, \
 { 0x92, 0x3, 0x94, 0x27, 0x24, 0x2e, 0x6a, 0x43 }}

typedef EFI_STATUS(EFIAPI *EFI_BLUETOOTH_HC_SEND_COMMAND)(IN EFI_BLUETOOTH_HC_PROTOCOL *This, IN OUT UINTN *BufferSize, IN VOID *Buffer, IN UINTN Timeout);
typedef EFI_STATUS(EFIAPI *EFI_BLUETOOTH_HC_RECEIVE_EVENT)(IN EFI_BLUETOOTH_HC_PROTOCOL *This, IN OUT UINTN *BufferSize, OUT VOID *Buffer, IN UINTN Timeout);
typedef EFI_STATUS(EFIAPI *EFI_BLUETOOTH_HC_ASYNC_FUNC_CALLBACK) (IN VOID *Data, IN UINTN DataLength, IN VOID *Context);
typedef EFI_STATUS(EFIAPI *EFI_BLUETOOTH_HC_ASYNC_RECEIVE_EVENT) (IN EFI_BLUETOOTH_HC_PROTOCOL *This, IN BOOLEAN IsNewTransfer, IN UINTN PollingInterval, IN UINTN DataLength, IN EFI_BLUETOOTH_HC_ASYNC_FUNC_CALLBACK Callback, IN VOID *Context);
typedef EFI_STATUS(EFIAPI *EFI_BLUETOOTH_HC_SEND_ACL_DATA)(IN EFI_BLUETOOTH_HC_PROTOCOL *This, IN OUT UINTN *BufferSize, IN VOID *Buffer, IN UINTN Timeout);
typedef EFI_STATUS(EFIAPI *EFI_BLUETOOTH_HC_RECEIVE_ACL_DATA)(IN EFI_BLUETOOTH_HC_PROTOCOL *This, IN OUT UINTN *BufferSize, OUT VOID *Buffer, IN UINTN Timeout);
typedef EFI_STATUS(EFIAPI *EFI_BLUETOOTH_HC_ASYNC_RECEIVE_ACL_DATA) (IN EFI_BLUETOOTH_HC_PROTOCOL *This, IN BOOLEAN IsNewTransfer, IN UINTN PollingInterval, IN UINTN DataLength, IN EFI_BLUETOOTH_HC_ASYNC_FUNC_CALLBACK Callback, IN VOID *Context);
typedef EFI_STATUS(EFIAPI *EFI_BLUETOOTH_HC_SEND_SCO_DATA)(IN EFI_BLUETOOTH_HC_PROTOCOL *This, IN OUT UINTN *BufferSize, IN VOID *Buffer, IN UINTN Timeout);
typedef EFI_STATUS(EFIAPI *EFI_BLUETOOTH_HC_RECEIVE_SCO_DATA)(IN EFI_BLUETOOTH_HC_PROTOCOL *This, IN OUT UINTN *BufferSize, OUT VOID *Buffer, IN UINTN Timeout);
typedef EFI_STATUS(EFIAPI *EFI_BLUETOOTH_HC_ASYNC_RECEIVE_SCO_DATA) (IN EFI_BLUETOOTH_HC_PROTOCOL *This, IN BOOLEAN IsNewTransfer, IN UINTN PollingInterval, IN UINTN DataLength, IN EFI_BLUETOOTH_HC_ASYNC_FUNC_CALLBACK Callback, IN VOID *Context);

struct EFI_BLUETOOTH_HC_PROTOCOL {
	EFI_BLUETOOTH_HC_SEND_COMMAND SendCommand;
	EFI_BLUETOOTH_HC_RECEIVE_EVENT ReceiveEvent;
	EFI_BLUETOOTH_HC_ASYNC_RECEIVE_EVENT AsyncReceiveEvent;
	EFI_BLUETOOTH_HC_SEND_ACL_DATA SendACLData;
	EFI_BLUETOOTH_HC_RECEIVE_ACL_DATA ReceiveACLData;
	EFI_BLUETOOTH_HC_ASYNC_RECEIVE_ACL_DATA	AsyncReceiveACLData;
	EFI_BLUETOOTH_HC_SEND_SCO_DATA SendSCOData;
	EFI_BLUETOOTH_HC_RECEIVE_SCO_DATA ReceiveSCOData;
	EFI_BLUETOOTH_HC_ASYNC_RECEIVE_SCO_DATA AsyncReceiveSCOData;
};

#define EFI_BLUETOOTH_IO_SERVICE_BINDING_PROTOCOL_GUID \
 { 0x388278d3, 0x7b85, 0x42f0, \
 { 0xab, 0xa9, 0xfb, 0x4b, 0xfd, 0x69, 0xf5, 0xab }

#define EFI_BLUETOOTH_IO_PROTOCOL_GUID \
 { 0x467313de, 0x4e30, 0x43f1, \
 { 0x94, 0x3e, 0x32, 0x3f, 0x89, 0x84, 0x5d, 0xb5 }}

struct BLUETOOTH_ADDRESS {
	UINT8 Address[6];
};

struct BLUETOOTH_CLASS_OF_DEVICE {
	UINT8 FormatType : 2;
	UINT8 MinorDeviceClass : 6;
	UINT16 MajorDeviceClass : 5;
	UINT16 MajorServiceClass : 11;
};

struct EFI_BLUETOOTH_DEVICE_INFO {
	UINT32 Version;
	BLUETOOTH_ADDRESS BD_ADDR;
	UINT8 PageScanRepetitionMode;
	BLUETOOTH_CLASS_OF_DEVICE ClassOfDevice;
	UINT16 ClockOffset;
	UINT8 RSSI;
	UINT8 ExtendedInquiryResponse[240];
};

typedef EFI_STATUS(EFIAPI *EFI_BLUETOOTH_IO_GET_DEVICE_INFO)(IN EFI_BLUETOOTH_IO_PROTOCOL *This, OUT UINTN *DeviceInfoSize, OUT VOID **DeviceInfo);
typedef EFI_STATUS(EFIAPI *EFI_BLUETOOTH_IO_GET_SDP_INFO)(IN EFI_BLUETOOTH_IO_PROTOCOL *This, OUT UINTN *SdpInfoSize, OUT VOID **SdpInfo);
typedef EFI_STATUS(EFIAPI *EFI_BLUETOOTH_IO_L2CAP_RAW_SEND)(IN EFI_BLUETOOTH_IO_PROTOCOL *This, IN OUT UINTN *BufferSize, IN VOID *Buffer, IN UINTN Timeout);
typedef EFI_STATUS(EFIAPI *EFI_BLUETOOTH_IO_L2CAP_RAW_RECEIVE)(IN EFI_BLUETOOTH_IO_PROTOCOL *This, IN OUT UINTN *BufferSize, OUT VOID *Buffer, IN UINTN Timeout);
typedef EFI_STATUS(EFIAPI *EFI_BLUETOOTH_IO_ASYNC_FUNC_CALLBACK) (IN UINT16 ChannelID, IN VOID *Data, IN UINTN DataLength, IN VOID *Context);
typedef EFI_STATUS(EFIAPI *EFI_BLUETOOTH_IO_L2CAP_RAW_ASYNC_RECEIVE)(IN EFI_BLUETOOTH_IO_PROTOCOL *This, IN BOOLEAN IsNewTransfer, IN UINTN PollingInterval, IN UINTN DataLength, IN EFI_BLUETOOTH_IO_ASYNC_FUNC_CALLBACK Callback, IN VOID *Context);
typedef EFI_STATUS(EFIAPI *EFI_BLUETOOTH_IO_L2CAP_SEND)(IN EFI_BLUETOOTH_IO_PROTOCOL *This, IN EFI_HANDLE Handle, IN OUT UINTN *BufferSize, IN VOID *Buffer, IN UINTN Timeout);
typedef EFI_STATUS(EFIAPI *EFI_BLUETOOTH_IO_L2CAP_RECEIVE)(IN EFI_BLUETOOTH_IO_PROTOCOL *This, IN EFI_HANDLE Handle, OUT UINTN *BufferSize, OUT VOID **Buffer, IN UINTN Timeout);
typedef EFI_STATUS(EFIAPI *EFI_BLUETOOTH_IO_CHANNEL_SERVICE_CALLBACK) (IN VOID *Data, IN UINTN DataLength, IN VOID *Context);
typedef EFI_STATUS(EFIAPI *EFI_BLUETOOTH_IO_L2CAP_ASYNC_RECEIVE)(IN EFI_BLUETOOTH_IO_PROTOCOL *This, IN EFI_HANDLE Handle, IN EFI_BLUETOOTH_IO_CHANNEL_SERVICE_CALLBACK Callback, IN VOID *Context);
typedef EFI_STATUS(EFIAPI *EFI_BLUETOOTH_IO_L2CAP_CONNECT)(IN EFI_BLUETOOTH_IO_PROTOCOL *This, OUT EFI_HANDLE *Handle, IN UINT16 Psm, IN UINT16 Mtu, IN EFI_BLUETOOTH_IO_CHANNEL_SERVICE_CALLBACK Callback, IN VOID *Context);
typedef EFI_STATUS(EFIAPI *EFI_BLUETOOTH_IO_L2CAP_REGISTER_SERVICE)(IN EFI_BLUETOOTH_IO_PROTOCOL *This, OUT EFI_HANDLE *Handle, IN UINT16 Psm, IN UINT16 Mtu, IN EFI_BLUETOOTH_IO_CHANNEL_SERVICE_CALLBACK Callback, IN VOID *Context);
typedef EFI_STATUS(EFIAPI *EFI_BLUETOOTH_IO_L2CAP_DISCONNECT)(IN EFI_BLUETOOTH_IO_PROTOCOL *This, IN EFI_HANDLE Handle);

struct EFI_BLUETOOTH_IO_PROTOCOL {
	EFI_BLUETOOTH_IO_GET_DEVICE_INFO GetDeviceInfo;
	EFI_BLUETOOTH_IO_GET_SDP_INFO GetSdpInfo;
	EFI_BLUETOOTH_IO_L2CAP_RAW_SEND L2CapRawSend;
	EFI_BLUETOOTH_IO_L2CAP_RAW_RECEIVE L2CapRawReceive;
	EFI_BLUETOOTH_IO_L2CAP_RAW_ASYNC_RECEIVE L2CapRawAsyncReceive;
	EFI_BLUETOOTH_IO_L2CAP_SEND L2CapSend;
	EFI_BLUETOOTH_IO_L2CAP_RECEIVE L2CapReceive;
	EFI_BLUETOOTH_IO_L2CAP_ASYNC_RECEIVE L2CapAsyncReceive;
	EFI_BLUETOOTH_IO_L2CAP_CONNECT L2CapConnect;
	EFI_BLUETOOTH_IO_L2CAP_DISCONNECT L2CapDisconnect;
	EFI_BLUETOOTH_IO_L2CAP_REGISTER_SERVICE L2CapRegisterService;
};

#define EFI_BLUETOOTH_CONFIG_PROTOCOL_GUID \
 { 0x62960cf3, 0x40ff, 0x4263,\
 { 0xa7, 0x7c, 0xdf, 0xde, 0xbd, 0x19, 0x1b, 0x4b }}

#define BLUETOOTH_HCI_COMMAND_LOCAL_READABLE_NAME_MAX_SIZE 248

#define EFI_BLUETOOTH_CONFIG_REMOTE_DEVICE_STATE_CONNECTED 0x1
#define EFI_BLUETOOTH_CONFIG_REMOTE_DEVICE_STATE_PAIRED 0x2
#define BLUETOOTH_HCI_LINK_KEY_SIZE 16

typedef UINT32 EFI_BLUETOOTH_CONFIG_REMOTE_DEVICE_STATE_TYPE;

typedef enum {
	EfiBluetoothConfigDataTypeDeviceName,
	EfiBluetoothConfigDataTypeClassOfDevice,
	EfiBluetoothConfigDataTypeRemoteDeviceState,
	EfiBluetoothConfigDataTypeSdpInfo,
	EfiBluetoothConfigDataTypeBDADDR,
	EfiBluetoothConfigDataTypeDiscoverable,
	EfiBluetoothConfigDataTypeControllerStoredPairedDeviceList,
	EfiBluetoothConfigDataTypeAvailableDeviceList,
	EfiBluetoothConfigDataTypeMax,
} EFI_BLUETOOTH_CONFIG_DATA_TYPE;

typedef enum {
	EfiBluetoothCallbackTypeUserPasskeyNotification,
	EfiBluetoothCallbackTypeUserConfirmationRequest,
	EfiBluetoothCallbackTypeOOBDataRequest,
	EfiBluetoothCallbackTypePinCodeRequest,
	EfiBluetoothCallbackTypeMax,
} EFI_BLUETOOTH_PIN_CALLBACK_TYPE;

typedef enum {
	EfiBluetoothConnCallbackTypeDisconnected,
	EfiBluetoothConnCallbackTypeConnected,
	EfiBluetoothConnCallbackTypeAuthenticated,
	EfiBluetoothConnCallbackTypeEncrypted,
} EFI_BLUETOOTH_CONNECT_COMPLETE_CALLBACK_TYPE;

struct EFI_BLUETOOTH_SCAN_CALLBACK_INFORMATION {
	BLUETOOTH_ADDRESS BDAddr;
	UINT8 RemoteDeviceState;
	BLUETOOTH_CLASS_OF_DEVICE ClassOfDevice;
	UINT8 RemoteDeviceName[BLUETOOTH_HCI_COMMAND_LOCAL_READABLE_NAME_MAX_SIZE];
};

typedef EFI_STATUS(EFIAPI *EFI_BLUETOOTH_CONFIG_INIT)(IN EFI_BLUETOOTH_CONFIG_PROTOCOL *This);
typedef EFI_STATUS(EFIAPI *EFI_BLUETOOTH_CONFIG_SCAN_CALLBACK_FUNCTION) (IN EFI_BLUETOOTH_CONFIG_PROTOCOL *This, IN VOID *Context, IN EFI_BLUETOOTH_SCAN_CALLBACK_INFORMATION *CallbackInfo);
typedef EFI_STATUS(EFIAPI *EFI_BLUETOOTH_CONFIG_SCAN)(IN EFI_BLUETOOTH_CONFIG_PROTOCOL *This, IN BOOLEAN ReScan, IN UINT8 ScanType, IN EFI_BLUETOOTH_CONFIG_SCAN_CALLBACK_FUNCTION Callback, IN VOID *Context);
typedef EFI_STATUS(EFIAPI *EFI_BLUETOOTH_CONFIG_CONNECT)(IN EFI_BLUETOOTH_CONFIG_PROTOCOL *This, IN BLUETOOTH_ADDRESS *BD_ADDR);
typedef EFI_STATUS(EFIAPI *EFI_BLUETOOTH_CONFIG_DISCONNECT)(IN EFI_BLUETOOTH_CONFIG_PROTOCOL *This, IN BLUETOOTH_ADDRESS *BD_ADDR, IN UINT8 Reason);
typedef EFI_STATUS(EFIAPI *EFI_BLUETOOTH_CONFIG_GET_DATA) (IN EFI_BLUETOOTH_CONFIG_PROTOCOL *This, IN EFI_BLUETOOTH_CONFIG_DATA_TYPE DataType, IN OUT UINTN *DataSize, IN OUT VOID *Data);
typedef EFI_STATUS(EFIAPI *EFI_BLUETOOTH_CONFIG_SET_DATA) (IN EFI_BLUETOOTH_CONFIG_PROTOCOL *This, IN EFI_BLUETOOTH_CONFIG_DATA_TYPE DataType, IN UINTN DataSize, IN VOID *Data);
typedef EFI_STATUS(EFIAPI *EFI_BLUETOOTH_CONFIG_GET_REMOTE_DATA) (IN EFI_BLUETOOTH_CONFIG_PROTOCOL *This, IN EFI_BLUETOOTH_CONFIG_DATA_TYPE DataType, IN BLUETOOTH_ADDRESS BDAddr, IN OUT UINTN *DataSize, IN OUT VOID *Data);
typedef EFI_STATUS(EFIAPI *EFI_BLUETOOTH_CONFIG_REGISTER_PIN_CALLBACK_FUNCTION) (IN EFI_BLUETOOTH_CONFIG_PROTOCOL *This, IN VOID *Context, IN EFI_BLUETOOTH_PIN_CALLBACK_TYPE CallbackType, IN VOID *InputBuffer, IN UINTN InputBufferSize, OUT VOID **OutputBuffer, OUT UINTN *OutputBufferSize);
typedef EFI_STATUS(EFIAPI *EFI_BLUETOOTH_CONFIG_REGISTER_PIN_CALLBACK) (IN EFI_BLUETOOTH_CONFIG_PROTOCOL *This, IN EFI_BLUETOOTH_CONFIG_REGISTER_PIN_CALLBACK_FUNCTION	Callback, IN VOID *Context);
typedef EFI_STATUS(EFIAPI *EFI_BLUETOOTH_CONFIG_REGISTER_GET_LINK_KEY_CALLBACK_FUNCTION) (IN EFI_BLUETOOTH_CONFIG_PROTOCOL *This, IN VOID *Context, IN BLUETOOTH_ADDRESS *BDAddr, OUT UINT8*	LinkKey);
typedef EFI_STATUS(EFIAPI *EFI_BLUETOOTH_CONFIG_REGISTER_GET_LINK_KEY_CALLBACK) (IN EFI_BLUETOOTH_CONFIG_PROTOCOL *This, IN	EFI_BLUETOOTH_CONFIG_REGISTER_GET_LINK_KEY_CALLBACK_FUNCTION Callback, IN VOID	*Context);
typedef EFI_STATUS(EFIAPI *EFI_BLUETOOTH_CONFIG_REGISTER_SET_LINK_KEY_CALLBACK_FUNCTION) (IN EFI_BLUETOOTH_CONFIG_PROTOCOL *This, IN VOID *Context, IN BLUETOOTH_ADDRESS *BDAddr, IN UINT8* LinkKey);
typedef EFI_STATUS(EFIAPI *EFI_BLUETOOTH_CONFIG_REGISTER_SET_LINK_KEY_CALLBACK) (IN EFI_BLUETOOTH_CONFIG_PROTOCOL *This, IN EFI_BLUETOOTH_CONFIG_REGISTER_SET_LINK_KEY_CALLBACK_FUNCTION Callback, IN VOID *Context);
typedef EFI_STATUS(EFIAPI *EFI_BLUETOOTH_CONFIG_REGISTER_CONNECT_COMPLETE_CALLBACK_FUNCTION) (IN EFI_BLUETOOTH_CONFIG_PROTOCOL *This, IN VOID *Context, IN EFI_BLUETOOTH_CONNECT_COMPLETE_CALLBACK_TYPE CallbackType, IN BLUETOOTH_ADDRESS BDAddr, IN VOID *InputBuffer, IN UINTN InputBufferSize);
typedef EFI_STATUS(EFIAPI *EFI_BLUETOOTH_CONFIG_REGISTER_CONNECT_COMPLETE_CALLBACK) (IN EFI_BLUETOOTH_CONFIG_PROTOCOL *This, IN EFI_BLUETOOTH_CONFIG_REGISTER_CONNECT_COMPLETE_CALLBACK_FUNCTION Callback, IN VOID *Context);


struct EFI_BLUETOOTH_CONFIG_PROTOCOL {
	EFI_BLUETOOTH_CONFIG_INIT Init;
	EFI_BLUETOOTH_CONFIG_SCAN Scan;
	EFI_BLUETOOTH_CONFIG_CONNECT Connect;
	EFI_BLUETOOTH_CONFIG_DISCONNECT Disconnect;
	EFI_BLUETOOTH_CONFIG_GET_DATA GetData;
	EFI_BLUETOOTH_CONFIG_SET_DATA SetData;
	EFI_BLUETOOTH_CONFIG_GET_REMOTE_DATA GetRemoteData;
	EFI_BLUETOOTH_CONFIG_REGISTER_PIN_CALLBACK RegisterPinCallback;
	EFI_BLUETOOTH_CONFIG_REGISTER_GET_LINK_KEY_CALLBACK RegisterGetLinkKeyCallback;
	EFI_BLUETOOTH_CONFIG_REGISTER_SET_LINK_KEY_CALLBACK RegisterSetLinkKeyCallback;
	EFI_BLUETOOTH_CONFIG_REGISTER_CONNECT_COMPLETE_CALLBACK RegisterLinkConnectCompleteCallback;

};

#define EFI_TCP4_SERVICE_BINDING_PROTOCOL_GUID \
 {0x00720665,0x67EB,0x4a99,\
 {0xBA,0xF7,0xD3,0xC3,0x3A,0x1C,0x7C,0xC9}}

#define EFI_TCP4_PROTOCOL_GUID \
 {0x65530BC7,0xA359,0x410f,\
 {0xB0,0x10,0x5A,0xAD,0xC7,0xEC,0x2B,0x62}}

#define EFI_CONNECTION_FIN (104)
#define EFI_CONNECTION_RESET (105)
#define EFI_CONNECTION_REFUSED (106)

typedef enum {
	Tcp4StateClosed = 0,
	Tcp4StateListen = 1,
	Tcp4StateSynSent = 2,
	Tcp4StateSynReceived = 3,
	Tcp4StateEstablished = 4,
	Tcp4StateFinWait1 = 5,
	Tcp4StateFinWait2 = 6,
	Tcp4StateClosing = 7,
	Tcp4StateTimeWait = 8,
	Tcp4StateCloseWait = 9,
	Tcp4StateLastAck = 10
} EFI_TCP4_CONNECTION_STATE;

struct EFI_TCP4_ACCESS_POINT {
	BOOLEAN UseDefaultAddress;
	EFI_IPv4_ADDRESS StationAddress;
	EFI_IPv4_ADDRESS SubnetMask;
	UINT16 StationPort;
	EFI_IPv4_ADDRESS RemoteAddress;
	UINT16 RemotePort;
	BOOLEAN ActiveFlag;
};

struct EFI_TCP4_OPTION {
	UINT32 ReceiveBufferSize;
	UINT32 SendBufferSize;
	UINT32 MaxSynBackLog;
	UINT32 ConnectionTimeout;
	UINT32 DataRetries;
	UINT32 FinTimeout;
	UINT32 TimeWaitTimeout;
	UINT32 KeepAliveProbes;
	UINT32 KeepAliveTime;
	UINT32 KeepAliveInterval;
	BOOLEAN EnableNagle;
	BOOLEAN EnableTimeStamp;
	BOOLEAN EnableWindowScaling;
	BOOLEAN EnableSelectiveAck;
	BOOLEAN EnablePathMtuDiscovery;
};

struct EFI_TCP4_CONFIG_DATA {
	// Receiving Filters
	// I/O parameters
	UINT8 TypeOfService;
	UINT8 TimeToLive;
	// Access Point
	EFI_TCP4_ACCESS_POINT AccessPoint;
	// TCP Control Options
	EFI_TCP4_OPTION * ControlOption;

};

struct EFI_TCP4_COMPLETION_TOKEN {
	EFI_EVENT Event;
	EFI_STATUS Status;
};

struct EFI_TCP4_CONNECTION_TOKEN {
	EFI_TCP4_COMPLETION_TOKEN CompletionToken;
};

struct EFI_TCP4_LISTEN_TOKEN {
	EFI_TCP4_COMPLETION_TOKEN CompletionToken;
	EFI_HANDLE NewChildHandle;
};

struct EFI_TCP4_FRAGMENT_DATA {
	UINT32 FragmentLength;
	VOID *FragmentBuffer;
};

struct EFI_TCP4_RECEIVE_DATA {
	BOOLEAN UrgentFlag;
	UINT32 DataLength;
	UINT32 FragmentCount;
	EFI_TCP4_FRAGMENT_DATA FragmentTable[1];
};

struct EFI_TCP4_TRANSMIT_DATA {
	BOOLEAN Push;
	BOOLEAN Urgent;
	UINT32 DataLength;
	UINT32 FragmentCount;
	EFI_TCP4_FRAGMENT_DATA FragmentTable[1];
};

struct EFI_TCP4_IO_TOKEN {
	EFI_TCP4_COMPLETION_TOKEN CompletionToken;
	union {
		EFI_TCP4_RECEIVE_DATA *RxData;
		EFI_TCP4_TRANSMIT_DATA *TxData;
	} Packet;
};

struct EFI_TCP4_CLOSE_TOKEN {
	EFI_TCP4_COMPLETION_TOKEN CompletionToken;
	BOOLEAN AbortOnClose;
};

struct EFI_IP4_CONFIG_DATA {
	UINT8                   DefaultProtocol;
	BOOLEAN                 AcceptAnyProtocol;
	BOOLEAN                 AcceptIcmpErrors;
	BOOLEAN                 AcceptBroadcast;
	BOOLEAN                 AcceptPromiscuous;
	BOOLEAN                 UseDefaultAddress;
	EFI_IPv4_ADDRESS        StationAddress;
	EFI_IPv4_ADDRESS        SubnetMask;
	UINT8                   TypeOfService;
	UINT8                   TimeToLive;
	BOOLEAN                 DoNotFragment;
	BOOLEAN                 RawData;
	UINT32                  ReceiveTimeout;
	UINT32                  TransmitTimeout;
};

struct EFI_IP4_ICMP_TYPE {
   UINT8 Type;
   UINT8 Code;

};

struct EFI_IP4_ROUTE_TABLE {
	EFI_IPv4_ADDRESS SubnetAddress;
	EFI_IPv4_ADDRESS SubnetMask;
	EFI_IPv4_ADDRESS GatewayAddress;
};

struct EFI_IP4_MODE_DATA {
	BOOLEAN                 IsStarted;
	UINT32                  MaxPacketSize;
	EFI_IP4_CONFIG_DATA     ConfigData;
	BOOLEAN                 IsConfigured;
	UINT32                  GroupCount;
	EFI_IPv4_ADDRESS        *GroupTable;
	UINT32                  RouteCount;
	EFI_IP4_ROUTE_TABLE     *RouteTable;
	UINT32                  IcmpTypeCount;
	EFI_IP4_ICMP_TYPE       *IcmpTypeList;	
};

typedef EFI_STATUS(EFIAPI *EFI_TCP4_GET_MODE_DATA) (IN EFI_TCP4_PROTOCOL *This, OUT EFI_TCP4_CONNECTION_STATE *Tcp4State OPTIONAL, OUT EFI_TCP4_CONFIG_DATA *Tcp4ConfigData OPTIONAL, OUT EFI_IP4_MODE_DATA *Ip4ModeData OPTIONAL, OUT EFI_MANAGED_NETWORK_CONFIG_DATA *MnpConfigData OPTIONAL, OUT EFI_SIMPLE_NETWORK_MODE *SnpModeData OPTIONAL);
typedef EFI_STATUS(EFIAPI *EFI_TCP4_CONFIGURE) (IN EFI_TCP4_PROTOCOL *This, IN EFI_TCP4_CONFIG_DATA *TcpConfigData OPTIONAL);
typedef EFI_STATUS(EFIAPI *EFI_TCP4_ROUTES) (IN EFI_TCP4_PROTOCOL *This, IN BOOLEAN DeleteRoute, IN EFI_IPv4_ADDRESS *SubnetAddress, IN EFI_IPv4_ADDRESS *SubnetMask, IN EFI_IPv4_ADDRESS *GatewayAddress);
typedef EFI_STATUS(EFIAPI *EFI_TCP4_CONNECT) (IN EFI_TCP4_PROTOCOL *This, IN EFI_TCP4_CONNECTION_TOKEN *ConnectionToken);
typedef EFI_STATUS(EFIAPI *EFI_TCP4_ACCEPT) (IN EFI_TCP4_PROTOCOL *This, IN EFI_TCP4_LISTEN_TOKEN *ListenToken);
typedef EFI_STATUS(EFIAPI *EFI_TCP4_TRANSMIT) (IN EFI_TCP4_PROTOCOL *This, IN EFI_TCP4_IO_TOKEN *Token);
typedef EFI_STATUS(EFIAPI *EFI_TCP4_RECEIVE) (IN EFI_TCP4_PROTOCOL *This, IN EFI_TCP4_IO_TOKEN *Token);
typedef EFI_STATUS(EFIAPI *EFI_TCP4_CLOSE)(IN EFI_TCP4_PROTOCOL *This, IN EFI_TCP4_CLOSE_TOKEN *CloseToken);
typedef EFI_STATUS(EFIAPI *EFI_TCP4_CANCEL)(IN EFI_TCP4_PROTOCOL *This, IN EFI_TCP4_COMPLETION_TOKEN *Token OPTIONAL);
typedef EFI_STATUS(EFIAPI *EFI_TCP4_POLL) (IN EFI_TCP4_PROTOCOL *This);

struct EFI_TCP4_PROTOCOL {
	EFI_TCP4_GET_MODE_DATA GetModeData;
	EFI_TCP4_CONFIGURE Configure;
	EFI_TCP4_ROUTES Routes;
	EFI_TCP4_CONNECT Connect;
	EFI_TCP4_ACCEPT Accept;
	EFI_TCP4_TRANSMIT Transmit;
	EFI_TCP4_RECEIVE Receive;
	EFI_TCP4_CLOSE Close;
	EFI_TCP4_CANCEL Cancel;
	EFI_TCP4_POLL Poll;
};

#define EFI_TCP6_SERVICE_BINDING_PROTOCOL_GUID \
 {0xec20eb79,0x6c1a,0x4664,\
 {0x9a,0x0d,0xd2,0xe4,0xcc,0x16,0xd6, 0x64}}

#define EFI_TCP6_PROTOCOL_GUID \
 {0x46e44855,0xbd60,0x4ab7,\
 {0xab,0x0d,0xa6,0x79,0xb9,0x44,0x7d,0x77}}


#define ICMP_V6_DEST_UNREACHABLE                 0x1
#define ICMP_V6_PACKET_TOO_BIG                   0x2
#define ICMP_V6_TIME_EXCEEDED                    0x3
#define ICMP_V6_PARAMETER_PROBLEM                0x4

#define ICMP_V6_ECHO_REQUEST                     0x80
#define ICMP_V6_ECHO_REPLY                       0x81
#define ICMP_V6_LISTENER_QUERY                   0x82
#define ICMP_V6_LISTENER_REPORT                  0x83
#define ICMP_V6_LISTENER_DONE                    0x84
#define ICMP_V6_ROUTER_SOLICIT                   0x85
#define ICMP_V6_ROUTER_ADVERTISE                 0x86
#define ICMP_V6_NEIGHBOR_SOLICIT                 0x87
#define ICMP_V6_NEIGHBOR_ADVERTISE               0x88
#define ICMP_V6_REDIRECT                         0x89
#define ICMP_V6_LISTENER_REPORT_2                0x8F

#define ICMP_V6_NO_ROUTE_TO_DEST                 0x0
#define ICMP_V6_COMM_PROHIBITED                  0x1
#define ICMP_V6_BEYOND_SCOPE                     0x2
#define ICMP_V6_ADDR_UNREACHABLE                 0x3
#define ICMP_V6_PORT_UNREACHABLE                 0x4
#define ICMP_V6_SOURCE_ADDR_FAILED               0x5
#define ICMP_V6_ROUTE_REJECTED                   0x6

#define ICMP_V6_TIMEOUT_HOP_LIMIT                0x0
#define ICMP_V6_TIMEOUT_REASSEMBLE               0x1

#define ICMP_V6_ERRONEOUS_HEADER                 0x0
#define ICMP_V6_UNRECOGNIZE_NEXT_HDR             0x1
#define ICMP_V6_UNRECOGNIZE_OPTION               0x2

typedef enum {
	Tcp6StateClosed = 0,
	Tcp6StateListen = 1,
	Tcp6StateSynSent = 2,
	Tcp6StateSynReceived = 3,
	Tcp6StateEstablished = 4,
	Tcp6StateFinWait1 = 5,
	Tcp6StateFinWait2 = 6,
	Tcp6StateClosing = 7,
	Tcp6StateTimeWait = 8,
	Tcp6StateCloseWait = 9,
	Tcp6StateLastAck = 10
} EFI_TCP6_CONNECTION_STATE;

typedef enum {
	EfiNeighborInComplete,
	EfiNeighborReachable,
	EfiNeighborStale,
	EfiNeighborDelay,
	EfiNeighborProbe
} EFI_IP6_NEIGHBOR_STATE;

struct EFI_TCP6_ACCESS_POINT {
	EFI_IPv6_ADDRESS StationAddress;
	UINT16 StationPort;
	EFI_IPv6_ADDRESS RemoteAddress;
	UINT16 RemotePort;
	BOOLEAN ActiveFlag;
};

struct EFI_TCP6_OPTION {
	UINT32 ReceiveBufferSize;
	UINT32 SendBufferSize;
	UINT32 MaxSynBackLog;
	UINT32 ConnectionTimeout;
	UINT32 DataRetries;
	UINT32 FinTimeout;
	UINT32 TimeWaitTimeout;
	UINT32 KeepAliveProbes;
	UINT32 KeepAliveTime;
	UINT32 KeepAliveInterval;
	BOOLEAN EnableNagle;
	BOOLEAN EnableTimeStamp;
	BOOLEAN EnableWindowScaling;
	BOOLEAN EnableSelectiveAck;
	BOOLEAN EnablePathMtuDiscovery;
};

struct EFI_TCP6_CONFIG_DATA {
	UINT8 TrafficClass;
	UINT8 HopLimit;
	EFI_TCP6_ACCESS_POINT AccessPoint;
	EFI_TCP6_OPTION *ControlOption;
};

struct EFI_TCP6_COMPLETION_TOKEN {
	EFI_EVENT Event;
	EFI_STATUS Status;
};

struct EFI_TCP6_CONNECTION_TOKEN {
	EFI_TCP6_COMPLETION_TOKEN CompletionToken;
};

struct EFI_TCP6_LISTEN_TOKEN {
	EFI_TCP6_COMPLETION_TOKEN CompletionToken;
	EFI_HANDLE NewChildHandle;
};

struct EFI_TCP6_FRAGMENT_DATA {
	UINT32 FragmentLength;
	VOID *FragmentBuffer;
};

struct EFI_TCP6_RECEIVE_DATA {
	BOOLEAN UrgentFlag;
	UINT32 DataLength;
	UINT32 FragmentCount;
	EFI_TCP6_FRAGMENT_DATA FragmentTable[1];
};

struct EFI_TCP6_TRANSMIT_DATA {
	BOOLEAN Push;
	BOOLEAN Urgent;
	UINT32 DataLength;
	UINT32 FragmentCount;
	EFI_TCP6_FRAGMENT_DATA FragmentTable[1];
};

struct EFI_TCP6_IO_TOKEN {
	EFI_TCP6_COMPLETION_TOKEN CompletionToken;
	union {
		EFI_TCP6_RECEIVE_DATA *RxData;
		EFI_TCP6_TRANSMIT_DATA *TxData;
	} Packet;
};

struct EFI_TCP6_CLOSE_TOKEN {
	EFI_TCP6_COMPLETION_TOKEN CompletionToken;
	BOOLEAN AbortOnClose;
};

struct EFI_IP6_ADDRESS_PAIR {
	EFI_HANDLE          InstanceHandle;
	EFI_IPv6_ADDRESS    Ip6Address;
	UINT8               PrefixLength;
};

struct EFI_IP6_VARIABLE_DATA {
	EFI_HANDLE              DriverHandle;
	UINT32                  AddressCount;
	EFI_IP6_ADDRESS_PAIR   AddressPairs[1];
};

struct EFI_IP6_CONFIG_DATA {
	UINT8                   DefaultProtocol;
	BOOLEAN                 AcceptAnyProtocol;
	BOOLEAN                 AcceptIcmpErrors;
	BOOLEAN                 AcceptPromiscuous;
	EFI_IPv6_ADDRESS        DestinationAddress;
	EFI_IPv6_ADDRESS        StationAddress;
	UINT8                   TrafficClass;
	UINT8                   HopLimit;
	UINT32                  FlowLabel;
	UINT32                  ReceiveTimeout;
	UINT32                  TransmitTimeout;
};

struct EFI_IP6_ADDRESS_INFO {
	EFI_IPv6_ADDRESS        Address;
	UINT8                   PrefixLength;
};

struct EFI_IP6_ROUTE_TABLE {
	EFI_IPv6_ADDRESS        Gateway;
	EFI_IPv6_ADDRESS        Destination;
	UINT8                   PrefixLength;
};

struct EFI_IP6_NEIGHBOR_CACHE {
	EFI_IPv6_ADDRESS        Neighbor;
	EFI_MAC_ADDRESS         LinkAddress;
	EFI_IP6_NEIGHBOR_STATE  State;
};

struct EFI_IP6_ICMP_TYPE {
	UINT8                   Type;
	UINT8                   Code;
};

struct EFI_IP6_MODE_DATA {
	BOOLEAN                 IsStarted;
	UINT32                  MaxPacketSize;
	EFI_IP6_CONFIG_DATA     ConfigData;
	BOOLEAN                 IsConfigured;
	UINT32                  AddressCount;
	EFI_IP6_ADDRESS_INFO    *AddressList;
	UINT32                  GroupCount;
	EFI_IPv6_ADDRESS        *GroupTable;
	UINT32                  RouteCount;
	EFI_IP6_ROUTE_TABLE     *RouteTable;
	UINT32                  NeighborCount;
	EFI_IP6_NEIGHBOR_CACHE  *NeighborCache;
	UINT32				      PrefixCount;
	EFI_IP6_ADDRESS_INFO    *PrefixTable;
	UINT32                  IcmpTypeCount;
	EFI_IP6_ICMP_TYPE       *IcmpTypeList;
	
};

typedef EFI_STATUS(EFIAPI *EFI_TCP6_GET_MODE_DATA) (IN EFI_TCP6_PROTOCOL *This, OUT EFI_TCP6_CONNECTION_STATE *Tcp6State OPTIONAL, OUT EFI_TCP6_CONFIG_DATA *Tcp6ConfigData OPTIONAL, OUT EFI_IP6_MODE_DATA *Ip6ModeData OPTIONAL, OUT EFI_MANAGED_NETWORK_CONFIG_DATA *MnpConfigData OPTIONAL, OUT EFI_SIMPLE_NETWORK_MODE *SnpModeData OPTIONAL);
typedef EFI_STATUS(EFIAPI *EFI_TCP6_CONFIGURE) (IN EFI_TCP6_PROTOCOL *This, IN EFI_TCP6_CONFIG_DATA *Tcp6ConfigData OPTIONAL);
typedef EFI_STATUS(EFIAPI *EFI_TCP6_CONNECT) (IN EFI_TCP6_PROTOCOL *This, IN EFI_TCP6_CONNECTION_TOKEN *ConnectionToken);
typedef EFI_STATUS(EFIAPI *EFI_TCP6_ACCEPT) (IN EFI_TCP6_PROTOCOL *This, IN EFI_TCP6_LISTEN_TOKEN *ListenToken);
typedef EFI_STATUS(EFIAPI *EFI_TCP6_TRANSMIT) (IN EFI_TCP6_PROTOCOL *This, IN EFI_TCP6_IO_TOKEN *Token);
typedef EFI_STATUS(EFIAPI *EFI_TCP6_RECEIVE) (IN EFI_TCP6_PROTOCOL *This, IN EFI_TCP6_IO_TOKEN *Token);
typedef EFI_STATUS(EFIAPI *EFI_TCP6_CLOSE)(IN EFI_TCP6_PROTOCOL *This, IN EFI_TCP6_CLOSE_TOKEN *CloseToken);
typedef EFI_STATUS(EFIAPI *EFI_TCP6_CANCEL)(IN EFI_TCP6_PROTOCOL *This, IN EFI_TCP6_COMPLETION_TOKEN *Token OPTIONAL);
typedef EFI_STATUS(EFIAPI *EFI_TCP6_POLL) (IN EFI_TCP6_PROTOCOL *This);


struct EFI_TCP6_PROTOCOL {
	EFI_TCP6_GET_MODE_DATA GetModeData;
	EFI_TCP6_CONFIGURE Configure;
	EFI_TCP6_CONNECT Connect;
	EFI_TCP6_ACCEPT Accept;
	EFI_TCP6_TRANSMIT Transmit;
	EFI_TCP6_RECEIVE Receive;
	EFI_TCP6_CLOSE Close;
	EFI_TCP6_CANCEL Cancel;
	EFI_TCP6_POLL Poll;
};

#define EFI_IP4_SERVICE_BINDING_PROTOCOL_GUID \
 {0xc51711e7,0xb4bf,0x404a,\
 {0xbf,0xb8,0x0a,0x04,0x8e,0xf1,0xff,0xe4}}

#define EFI_IP4_PROTOCOL_GUID \
 {0x41d94cd2,0x35b6,0x455a,\
 {0x82,0x58,0xd4,0xe5,0x13,0x34,0xaa,0xdd}}

#pragma pack(1)
struct EFI_IP4_HEADER {
	UINT8 HeaderLength : 4;
	UINT8 Version : 4;
	UINT8 TypeOfService;
	UINT16 TotalLength;
	UINT16 Identification;
	UINT16 Fragmentation;
	UINT8 TimeToLive;
	UINT8 Protocol;
	UINT16 Checksum;
	EFI_IPv4_ADDRESS SourceAddress;
	EFI_IPv4_ADDRESS DestinationAddress;
};
#pragma pack()

struct EFI_IP4_FRAGMENT_DATA {
	UINT32 FragmentLength;
	VOID *FragmentBuffer;
};

struct EFI_IP4_RECEIVE_DATA {
	EFI_TIME TimeStamp;
	EFI_EVENT RecycleSignal;
	UINT32 HeaderLength;
	EFI_IP4_HEADER *Header;
	UINT32 OptionsLength;
	VOID *Options;
	UINT32 DataLength;
	UINT32 FragmentCount;
	EFI_IP4_FRAGMENT_DATA FragmentTable[1];
};

struct EFI_IP4_OVERRIDE_DATA {
	EFI_IPv4_ADDRESS SourceAddress;
	EFI_IPv4_ADDRESS GatewayAddress;
	UINT8 Protocol;
	UINT8 TypeOfService;
	UINT8 TimeToLive;
	BOOLEAN DoNotFragment;
};

struct EFI_IP4_TRANSMIT_DATA {
	EFI_IPv4_ADDRESS DestinationAddress;
	EFI_IP4_OVERRIDE_DATA *OverrideData;
	UINT32 OptionsLength;
	VOID *OptionsBuffer;
	UINT32 TotalDataLength;
	UINT32 FragmentCount;
	EFI_IP4_FRAGMENT_DATA FragmentTable[1];
};

struct EFI_IP4_COMPLETION_TOKEN {
	EFI_EVENT Event;
	EFI_STATUS Status;
	union {
		EFI_IP4_RECEIVE_DATA *RxData;
		EFI_IP4_TRANSMIT_DATA *TxData;
	} Packet;
};

typedef EFI_STATUS(EFIAPI *EFI_IP4_GET_MODE_DATA) (IN EFI_IP4_PROTOCOL *This, OUT EFI_IP4_MODE_DATA *Ip4ModeData OPTIONAL, OUT EFI_MANAGED_NETWORK_CONFIG_DATA *MnpConfigData OPTIONAL, OUT EFI_SIMPLE_NETWORK_MODE *SnpModeData OPTIONAL);
typedef EFI_STATUS(EFIAPI *EFI_IP4_CONFIGURE) (IN EFI_IP4_PROTOCOL *This, IN EFI_IP4_CONFIG_DATA *IpConfigData OPTIONAL);
typedef EFI_STATUS(EFIAPI *EFI_IP4_GROUPS) (IN EFI_IP4_PROTOCOL *This, IN BOOLEAN JoinFlag, IN EFI_IPv4_ADDRESS *GroupAddress OPTIONAL);
typedef EFI_STATUS(EFIAPI *EFI_IP4_ROUTES) (IN EFI_IP4_PROTOCOL *This, IN BOOLEAN DeleteRoute, IN EFI_IPv4_ADDRESS *SubnetAddress, IN EFI_IPv4_ADDRESS *SubnetMask, IN EFI_IPv4_ADDRESS *GatewayAddress);
typedef EFI_STATUS(EFIAPI *EFI_IP4_TRANSMIT) (IN EFI_IP4_PROTOCOL *This, IN EFI_IP4_COMPLETION_TOKEN *Token);
typedef EFI_STATUS(EFIAPI *EFI_IP4_RECEIVE) (IN EFI_IP4_PROTOCOL *This, IN EFI_IP4_COMPLETION_TOKEN *Token);
typedef EFI_STATUS(EFIAPI *EFI_IP4_CANCEL)(IN EFI_IP4_PROTOCOL *This, IN EFI_IP4_COMPLETION_TOKEN *Token OPTIONAL);
typedef EFI_STATUS(EFIAPI *EFI_IP4_POLL) (IN EFI_IP4_PROTOCOL *This);

struct EFI_IP4_PROTOCOL {
	EFI_IP4_GET_MODE_DATA GetModeData;
	EFI_IP4_CONFIGURE Configure;
	EFI_IP4_GROUPS Groups;
	EFI_IP4_ROUTES Routes;
	EFI_IP4_TRANSMIT Transmit;
	EFI_IP4_RECEIVE Receive;
	EFI_IP4_CANCEL Cancel;
	EFI_IP4_POLL Poll;
};

#define EFI_IP4_CONFIG_PROTOCOL_GUID \
 {0x3b95aa31,0x3793,0x434b,\
 {0x86,0x67,0xc8,0x07,0x08,0x92,0xe0,0x5e}}

#define EFI_IP4_CONFIG2_INTERFACE_INFO_NAME_SIZE 32

struct EFI_IP4_IPCONFIG_DATA {
	EFI_IPv4_ADDRESS StationAddress;
	EFI_IPv4_ADDRESS SubnetMask;
	UINT32 RouteTableSize;
	EFI_IP4_ROUTE_TABLE *RouteTable OPTIONAL;
};

struct EFI_IP4_CONFIG2_INTERFACE_INFO {
	CHAR16 Name[EFI_IP4_CONFIG2_INTERFACE_INFO_NAME_SIZE];
	UINT8 IfType;
	UINT32 HwAddressSize;
	EFI_MAC_ADDRESS HwAddress;
	EFI_IPv4_ADDRESS StationAddress;
	EFI_IPv4_ADDRESS SubnetMask;
	UINT32 RouteTableSize;
	EFI_IP4_ROUTE_TABLE *RouteTable OPTIONAL;
};

typedef EFI_STATUS(EFIAPI *EFI_IP4_CONFIG_START) (IN EFI_IP4_CONFIG_PROTOCOL *This, IN EFI_EVENT DoneEvent, IN EFI_EVENT ReconfigEvent);
typedef EFI_STATUS(EFIAPI *EFI_IP4_CONFIG_STOP) (IN EFI_IP4_CONFIG_PROTOCOL *This);
typedef EFI_STATUS(EFIAPI *EFI_IP4_CONFIG_GET_DATA) (IN EFI_IP4_CONFIG_PROTOCOL *This, IN OUT UINTN *IpConfigDataSize, OUT EFI_IP4_IPCONFIG_DATA *IpConfigData OPTIONAL);

struct EFI_IP4_CONFIG_PROTOCOL {
	EFI_IP4_CONFIG_START Start;
	EFI_IP4_CONFIG_STOP Stop;
	EFI_IP4_CONFIG_GET_DATA GetData;
};

#define EFI_IP4_CONFIG2_PROTOCOL_GUID \
{ 0x5b446ed1, 0xe30b, 0x4faa,\
 { 0x87, 0x1a, 0x36, 0x54, 0xec, 0xa3, 0x60, 0x80 }}

typedef enum {
	Ip4Config2DataTypeInterfaceInfo,
	Ip4Config2DataTypePolicy,
	Ip4Config2DataTypeManualAddress,
	Ip4Config2DataTypeGateway,
	Ip4Config2DataTypeDnsServer,
	Ip4Config2DataTypeMaximum
} EFI_IP4_CONFIG2_DATA_TYPE;

typedef enum {
	Ip4Config2PolicyStatic,
	Ip4Config2PolicyDhcp,
	Ip4Config2PolicyMax
} EFI_IP4_CONFIG2_POLICY;

struct EFI_IP4_CONFIG2_MANUAL_ADDRESS {
	EFI_IPv4_ADDRESS Address;
	EFI_IPv4_ADDRESS SubnetMask;
};

typedef EFI_STATUS(EFIAPI *EFI_IP4_CONFIG2_SET_DATA) (IN EFI_IP4_CONFIG2_PROTOCOL *This, IN EFI_IP4_CONFIG2_DATA_TYPE DataType, IN UINTN DataSize, IN VOID *Data);
typedef EFI_STATUS(EFIAPI *EFI_IP4_CONFIG2_GET_DATA) (IN EFI_IP4_CONFIG2_PROTOCOL *This, IN EFI_IP4_CONFIG2_DATA_TYPE DataType, IN OUT UINTN *DataSize, IN VOID *Data OPTIONAL);
typedef EFI_STATUS(EFIAPI *EFI_IP4_CONFIG2_REGISTER_NOTIFY) (IN EFI_IP4_CONFIG2_PROTOCOL *This, IN EFI_IP4_CONFIG2_DATA_TYPE DataType, IN EFI_EVENT Event);
typedef EFI_STATUS(EFIAPI *EFI_IP4_CONFIG2_UNREGISTER_NOTIFY) (IN EFI_IP4_CONFIG2_PROTOCOL *This, IN EFI_IP4_CONFIG2_DATA_TYPE DataType, IN EFI_EVENT Event);

struct EFI_IP4_CONFIG2_PROTOCOL {
	EFI_IP4_CONFIG2_SET_DATA SetData;
	EFI_IP4_CONFIG2_GET_DATA GetData;
	EFI_IP4_CONFIG2_REGISTER_NOTIFY RegisterDataNotify;
	EFI_IP4_CONFIG2_UNREGISTER_NOTIFY UnregisterDataNotify;
};

#define EFI_IP6_SERVICE_BINDING_PROTOCOL_GUID \
 {0xec835dd3,0xfe0f,0x617b,\
 {0xa6,0x21,0xb3,0x50,0xc3,0xe1,0x33,0x88}}

#define EFI_IP6_PROTOCOL_GUID \
 {0x2c8759d5,0x5c2d,0x66ef,\
 {0x92,0x5f,0xb6,0x6c,0x10,0x19,0x57,0xe2}}

#pragma pack(1)
struct EFI_IP6_HEADER {
	UINT8 TrafficClassH : 4;
	UINT8 Version : 4;
	UINT8 FlowLabelH : 4;
	UINT8 TrafficClassL : 4;
	UINT16 FlowLabelL;
	UINT16 PayloadLength;
	UINT8 NextHeader;
	UINT8 HopLimit;
	EFI_IPv6_ADDRESS SourceAddress;
	EFI_IPv6_ADDRESS DestinationAddress;
};
#pragma pack()

struct EFI_IP6_FRAGMENT_DATA {
	UINT32 FragmentLength;
	VOID *FragmentBuffer;
};

struct EFI_IP6_RECEIVE_DATA {
	EFI_TIME TimeStamp;
	EFI_EVENT RecycleSignal;
	UINT32 HeaderLength;
	EFI_IP6_HEADER *Header;
	UINT32 DataLength;
	UINT32 FragmentCount;
	EFI_IP6_FRAGMENT_DATA FragmentTable[1];
};

struct EFI_IP6_OVERRIDE_DATA {
	UINT8 Protocol;
	UINT8 HopLimit;
	UINT32 FlowLabel;
};

struct EFI_IP6_TRANSMIT_DATA {
	EFI_IPv6_ADDRESS DestinationAddress;
	EFI_IP6_OVERRIDE_DATA *OverrideData;
	UINT32 ExtHdrsLength;
	VOID *ExtHdrs;
	UINT8 NextHeader;
	UINT32 DataLength;
	UINT32 FragmentCount;
	EFI_IP6_FRAGMENT_DATA FragmentTable[1];
};

struct EFI_IP6_COMPLETION_TOKEN {
	EFI_EVENT Event;
	EFI_STATUS Status;
	union {
		EFI_IP6_RECEIVE_DATA *RxData;
		EFI_IP6_TRANSMIT_DATA *TxData;
	} Packet;
};

typedef EFI_STATUS(EFIAPI *EFI_IP6_GET_MODE_DATA) (IN EFI_IP6_PROTOCOL *This, OUT EFI_IP6_MODE_DATA *Ip6ModeData OPTIONAL, OUT EFI_MANAGED_NETWORK_CONFIG_DATA *MnpConfigData OPTIONAL, OUT EFI_SIMPLE_NETWORK_MODE *SnpModeData OPTIONAL);
typedef EFI_STATUS(EFIAPI *EFI_IP6_CONFIGURE) (IN EFI_IP6_PROTOCOL *This, IN EFI_IP6_CONFIG_DATA *Ip6ConfigData OPTIONAL);
typedef EFI_STATUS(EFIAPI *EFI_IP6_GROUPS) (IN EFI_IP6_PROTOCOL *This, IN BOOLEAN JoinFlag, IN EFI_IPv6_ADDRESS *GroupAddress OPTIONAL);
typedef EFI_STATUS(EFIAPI *EFI_IP6_ROUTES) (IN EFI_IP6_PROTOCOL *This, IN BOOLEAN DeleteRoute, IN EFI_IPv6_ADDRESS *Destination OPTIONAL, IN UINT8 PrefixLength, IN EFI_IPv6_ADDRESS *GatewayAddress OPTIONAL);
typedef EFI_STATUS(EFIAPI *EFI_IP6_NEIGHBORS) (IN EFI_IP6_PROTOCOL *This, IN BOOLEAN DeleteFlag, IN EFI_IPv6_ADDRESS *TargetIp6Address, IN EFI_MAC_ADDRESS *TargetLinkAddress OPTIONAL, IN UINT32 Timeout, IN BOOLEAN Override);
typedef EFI_STATUS(EFIAPI *EFI_IP6_TRANSMIT) (IN EFI_IP6_PROTOCOL *This, IN EFI_IP6_COMPLETION_TOKEN *Token);
typedef EFI_STATUS(EFIAPI *EFI_IP6_RECEIVE) (IN EFI_IP6_PROTOCOL *This, IN EFI_IP6_COMPLETION_TOKEN *Token);
typedef EFI_STATUS(EFIAPI *EFI_IP6_CANCEL)(IN EFI_IP6_PROTOCOL *This, IN EFI_IP6_COMPLETION_TOKEN *Token OPTIONAL);
typedef EFI_STATUS(EFIAPI *EFI_IP6_POLL) (IN EFI_IP6_PROTOCOL *This);


struct EFI_IP6_PROTOCOL {
	EFI_IP6_GET_MODE_DATA GetModeData;
	EFI_IP6_CONFIGURE Configure;
	EFI_IP6_GROUPS Groups;
	EFI_IP6_ROUTES Routes;
	EFI_IP6_NEIGHBORS Neighbors;
	EFI_IP6_TRANSMIT Transmit;
	EFI_IP6_RECEIVE Receive;
	EFI_IP6_CANCEL Cancel;
	EFI_IP6_POLL Poll;
};

#define EFI_IP6_CONFIG_PROTOCOL_GUID \
 {0x937fe521,0x95ae,0x4d1a,\
 {0x89,0x29,0x48,0xbc,0xd9,0x0a,0xd3,0x1a}

typedef enum {
	Ip6ConfigDataTypeInterfaceInfo,
	Ip6ConfigDataTypeAltInterfaceId,
	Ip6ConfigDataTypePolicy,
	Ip6ConfigDataTypeDupAddrDetectTransmits,
	Ip6ConfigDataTypeManualAddress,
	Ip6ConfigDataTypeGateway,
	Ip6ConfigDataTypeDnsServer,
	Ip6ConfigDataTypeMaximum
} EFI_IP6_CONFIG_DATA_TYPE;

typedef enum {
	Ip6ConfigPolicyManual,
	Ip6ConfigPolicyAutomatic
} EFI_IP6_CONFIG_POLICY;

struct EFI_IP6_CONFIG_INTERFACE_INFO {
	CHAR16 Name[32];
	UINT8 IfType;
	UINT32 HwAddressSize;
	EFI_MAC_ADDRESS HwAddress;
	UINT32 AddressInfoCount;
	EFI_IP6_ADDRESS_INFO *AddressInfo;
	UINT32 RouteCount;
	EFI_IP6_ROUTE_TABLE *RouteTable;
};

struct EFI_IP6_CONFIG_INTERFACE_ID {
	UINT8 Id[8];
};

struct EFI_IP6_CONFIG_DUP_ADDR_DETECT_TRANSMITS {
	UINT32 DupAddrDetectTransmits;
};

struct EFI_IP6_CONFIG_MANUAL_ADDRESS {
	EFI_IPv6_ADDRESS Address;
	BOOLEAN IsAnycast;
	UINT8 PrefixLength;
};

typedef EFI_STATUS(EFIAPI *EFI_IP6_CONFIG_SET_DATA) (IN EFI_IP6_CONFIG_PROTOCOL *This, IN EFI_IP6_CONFIG_DATA_TYPE DataType, IN UINTN DataSize, IN VOID *Data);
typedef EFI_STATUS(EFIAPI *EFI_IP6_CONFIG_GET_DATA) (IN EFI_IP6_CONFIG_PROTOCOL *This, IN EFI_IP6_CONFIG_DATA_TYPE DataType, IN OUT UINTN *DataSize, IN VOID *Data OPTIONAL);
typedef EFI_STATUS(EFIAPI *EFI_IP6_CONFIG_REGISTER_NOTIFY) (IN EFI_IP6_CONFIG_PROTOCOL *This, IN EFI_IP6_CONFIG_DATA_TYPE DataType, IN EFI_EVENT Event);
typedef EFI_STATUS(EFIAPI *EFI_IP6_CONFIG_UNREGISTER_NOTIFY) (IN EFI_IP6_CONFIG_PROTOCOL *This, IN EFI_IP6_CONFIG_DATA_TYPE DataType, IN EFI_EVENT Event);

struct EFI_IP6_CONFIG_PROTOCOL {
	EFI_IP6_CONFIG_SET_DATA SetData;
	EFI_IP6_CONFIG_GET_DATA GetData;
	EFI_IP6_CONFIG_REGISTER_NOTIFY RegisterDataNotify;
	EFI_IP6_CONFIG_UNREGISTER_NOTIFY UnregisterDataNotify;
};

#define EFI_IPSEC_CONFIG_PROTOCOL_GUID \
 {0xce5e5929,0xc7a3,0x4602,\
 {0xad,0x9e,0xc9,0xda,0xf9,0x4e,0xbf,0xcf}}

#define MAX_PEERID_LEN 128

typedef enum {
	IPsecConfigDataTypeSpd,
	IPsecConfigDataTypeSad,
	IPsecConfigDataTypePad,
	IPsecConfigDataTypeMaximum
} EFI_IPSEC_CONFIG_DATA_TYPE;

typedef enum {
	EfiIPsecInBound,
	EfiIPsecOutBound
} EFI_IPSEC_TRAFFIC_DIR;

typedef enum {
	EfiIPsecActionDiscard,
	EfiIPsecActionBypass,
	EfiIPsecActionProtect
} EFI_IPSEC_ACTION;

typedef enum {
	EfiIPsecTransport,
	EfiIPsecTunnel
} EFI_IPSEC_MODE;

typedef enum {
	EfiIPsecTunnelClearDf,
	EfiIPsecTunnelSetDf,
	EfiIPsecTunnelCopyDf
} EFI_IPSEC_TUNNEL_DF_OPTION;

typedef enum {
	EfiIPsecAH,
	EfiIPsecESP
} EFI_IPSEC_PROTOCOL_TYPE;

typedef enum {
	EfiIPsecAuthProtocolIKEv1,
	EfiIPsecAuthProtocolIKEv2,
	EfiIPsecAuthProtocolMaximum
} EFI_IPSEC_AUTH_PROTOCOL_TYPE;

typedef enum {
	EfiIPsecAuthMethodPreSharedSecret,
	EfiIPsecAuthMethodCertificates,
	EfiIPsecAuthMethodMaximum
} EFI_IPSEC_AUTH_METHOD;

struct EFI_IP_ADDRESS_INFO {
	EFI_IP_ADDRESS Address;
	UINT8 PrefixLength;
};

struct EFI_IPSEC_SPD_SELECTOR {
	UINT32 LocalAddressCount;
	EFI_IP_ADDRESS_INFO *LocalAddress;
	UINT32 RemoteAddressCount;
	EFI_IP_ADDRESS_INFO *RemoteAddress;
	UINT16 NextLayerProtocol;
	// Several additional selectors depend on the ProtoFamily
	UINT16 LocalPort;
	UINT16 LocalPortRange;
	UINT16 RemotePort;
	UINT16 RemotePortRange;
};

typedef struct _EFI_IPSEC_SA_LIFETIME {
	UINT64 ByteCount;
	UINT64 SoftLifetime;
	UINT64 HardLifetime;
} EFI_IPSEC_SA_LIFETIME;

typedef struct _EFI_IPSEC_TUNNEL_OPTION {
	EFI_IP_ADDRESS LocalTunnelAddress;
	EFI_IP_ADDRESS RemoteTunnelAddress;
	EFI_IPSEC_TUNNEL_DF_OPTION DF;
} EFI_IPSEC_TUNNEL_OPTION;

struct EFI_IPSEC_PROCESS_POLICY {
	BOOLEAN ExtSeqNum;
	BOOLEAN SeqOverflow;
	BOOLEAN FragCheck;
	EFI_IPSEC_SA_LIFETIME SaLifetime;
	EFI_IPSEC_MODE Mode;
	EFI_IPSEC_TUNNEL_OPTION *TunnelOption;
	EFI_IPSEC_PROTOCOL_TYPE Proto;
	UINT8 AuthAlgoId;
	UINT8 EncAlgoId;
};

typedef struct _EFI_IPSEC_SA_ID {
	UINT32 Spi;
	EFI_IPSEC_PROTOCOL_TYPE Proto;
	EFI_IP_ADDRESS DestAddress;
} EFI_IPSEC_SA_ID;

struct EFI_IPSEC_SPD_DATA {
	UINT8 *Name[MAX_PEERID_LEN];
	UINT32 PackageFlag;
	EFI_IPSEC_TRAFFIC_DIR TrafficDirection;
	EFI_IPSEC_ACTION Action;
	EFI_IPSEC_PROCESS_POLICY *ProcessingPolicy;
	UINTN SaIdCount;
	EFI_IPSEC_SA_ID *SaId[1];
};

typedef struct _EFI_IPSEC_AH_ALGO_INFO {
	UINT8 AuthAlgoId;
	UINTN KeyLength;
	VOID *Key;
} EFI_IPSEC_AH_ALGO_INFO;

typedef struct _EFI_IPSEC_ESP_ALGO_INFO {
	UINT8 EncAlgoId;
	UINTN EncKeyLength;
	VOID *EncKey;
	UINT8 AuthAlgoId;
	UINTN AuthKeyLength;
	VOID *AuthKey;
} EFI_IPSEC_ESP_ALGO_INFO;

typedef union {
	EFI_IPSEC_AH_ALGO_INFO AhAlgoInfo;
	EFI_IPSEC_ESP_ALGO_INFO EspAlgoInfo;
} EFI_IPSEC_ALGO_INFO;

typedef struct _EFI_IPSEC_SA_DATA {
	EFI_IPSEC_MODE Mode;
	UINT64 SNCount;
	UINT8 AntiReplayWindows;
	EFI_IPSEC_ALGO_INFO AlgoInfo;
	EFI_IPSEC_SA_LIFETIME SaLifetime;
	UINT32 PathMTU;
	EFI_IPSEC_SPD_SELECTOR *SpdSelector;
	BOOLEAN ManualSet;
} EFI_IPSEC_SA_DATA;

typedef struct _EFI_IPSEC_SA_DATA2 {
	EFI_IPSEC_MODE Mode;
	UINT64 SNCount;
	UINT8 AntiReplayWindows;
	EFI_IPSEC_ALGO_INFO AlgoInfo;
	EFI_IPSEC_SA_LIFETIME SaLifetime;
	UINT32 PathMTU;
	EFI_IPSEC_SPD_SELECTOR *SpdSelector;
	BOOLEAN ManualSet;
	EFI_IP_ADDRESS TunnelSourceAddress;
	EFI_IP_ADDRESS TunnelDestinationAddress;
} EFI_IPSEC_SA_DATA2;

typedef struct _EFI_IPSEC_PAD_ID {
	BOOLEAN PeerIdValid;
	union {
		EFI_IP_ADDRESS_INFO IpAddress;
		UINT8 PeerId[MAX_PEERID_LEN];
	} Id;
} EFI_IPSEC_PAD_ID;

typedef struct _EFI_IPSEC_PAD_DATA {
	EFI_IPSEC_AUTH_PROTOCOL_TYPE AuthProtocol;
	EFI_IPSEC_AUTH_METHOD AuthMethod;
	BOOLEAN IkeIdFlag;
	UINTN AuthDataSize;
	VOID *AuthData;
	UINTN RevocationDataSize;
	VOID *RevocationData;
} EFI_IPSEC_PAD_DATA;

typedef union {
	EFI_IPSEC_SPD_SELECTOR SpdSelector;
	EFI_IPSEC_SA_ID SaId;
	EFI_IPSEC_PAD_ID PadId;
} EFI_IPSEC_CONFIG_SELECTOR;

typedef EFI_STATUS(EFIAPI *EFI_IPSEC_CONFIG_SET_DATA) (IN EFI_IPSEC_CONFIG_PROTOCOL *This, IN EFI_IPSEC_CONFIG_DATA_TYPE DataType, IN EFI_IPSEC_CONFIG_SELECTOR *Selector, IN VOID *Data, IN EFI_IPSEC_CONFIG_SELECTOR *InsertBefore OPTIONAL);
typedef EFI_STATUS(EFIAPI *EFI_IPSEC_CONFIG_GET_DATA) (IN EFI_IPSEC_CONFIG_PROTOCOL *This, IN EFI_IPSEC_CONFIG_DATA_TYPE DataType, IN EFI_IPSEC_CONFIG_SELECTOR *Selector, IN OUT UINTN *DataSize, OUT VOID *Data);
typedef EFI_STATUS(EFIAPI *EFI_IPSEC_CONFIG_GET_NEXT_SELECTOR) (IN EFI_IPSEC_CONFIG_PROTOCOL *This, IN EFI_IPSEC_CONFIG_DATA_TYPE DataType, IN OUT UINTN *SelectorSize, IN OUT EFI_IPSEC_CONFIG_SELECTOR *Selector);
typedef EFI_STATUS(EFIAPI *EFI_IPSEC_CONFIG_REGISTER_NOTIFY) (IN EFI_IPSEC_CONFIG_PROTOCOL *This, IN EFI_IPSEC_CONFIG_DATA_TYPE DataType, IN EFI_EVENT Event);
typedef EFI_STATUS(EFIAPI *EFI_IPSEC_CONFIG_UNREGISTER_NOTIFY) (IN EFI_IPSEC_CONFIG_PROTOCOL *This, IN EFI_IPSEC_CONFIG_DATA_TYPE DataType, IN EFI_EVENT Event);

struct EFI_IPSEC_CONFIG_PROTOCOL {
	EFI_IPSEC_CONFIG_SET_DATA SetData;
	EFI_IPSEC_CONFIG_GET_DATA GetData;
	EFI_IPSEC_CONFIG_GET_NEXT_SELECTOR GetNextSelector;
	EFI_IPSEC_CONFIG_REGISTER_NOTIFY RegisterDataNotify;
	EFI_IPSEC_CONFIG_UNREGISTER_NOTIFY UnregisterDataNotify;
};
#define EFI_IPSEC_PROTOCOL_GUID \
 {0xdfb386f7,0xe100,0x43ad,\
 {0x9c,0x9a,0xed,0x90,0xd0,0x8a,0x5e,0x12 }}

typedef struct _EFI_IPSEC_FRAGMENT_DATA {
	UINT32 FragmentLength;
	VOID *FragmentBuffer;
} EFI_IPSEC_FRAGMENT_DATA;

typedef EFI_STATUS(EFIAPI *EFI_IPSEC_PROCESS) (IN EFI_IPSEC_PROTOCOL *This, IN EFI_HANDLE NicHandle, IN UINT8 IpVer, IN OUT VOID *IpHead, IN UINT8 *LastHead, IN VOID *OptionsBuffer, IN UINT32 OptionsLength, IN OUT EFI_IPSEC_FRAGMENT_DATA **FragmentTable, IN UINT32 *FragmentCount, IN EFI_IPSEC_TRAFFIC_DIR TrafficDirection, OUT EFI_EVENT *RecycleSignal);

struct EFI_IPSEC_PROTOCOL {
	EFI_IPSEC_PROCESS Process;
	EFI_EVENT DisabledEvent;
	BOOLEAN DisabledFlag;
};

#define EFI_IPSEC2_PROTOCOL_GUID \
{0xa3979e64, 0xace8, 0x4ddc, \
 {0xbc, 0x07, 0x4d, 0x66, 0xb8, 0xfd, 0x09, 0x77}};

typedef EFI_STATUS(EFIAPI *EFI_IPSEC_PROCESSEXT) (IN EFI_IPSEC2_PROTOCOL *This, IN EFI_HANDLE NicHandle, IN UINT8 IpVer, IN OUT VOID *IpHead, IN OUT UINT8 *LastHead, IN OUT VOID **OptionsBuffer, IN OUT UINT32 *OptionsLength, IN OUT EFI_IPSEC_FRAGMENT_DATA **FragmentTable, IN OUT UINT32 *FragmentCount, IN EFI_IPSEC_TRAFFIC_DIR TrafficDirection, OUT EFI_EVENT *RecycleSignal);

struct EFI_IPSEC2_PROTOCOL {
	EFI_IPSEC_PROCESSEXT ProcessExt;
	EFI_EVENT DisabledEvent;
	BOOLEAN DisabledFlag;
};

#define EFI_FTP4_SERVICE_BINDING_PROTOCOL_GUID \
 {0xfaaecb1, 0x226e, 0x4782,\
 {0xaa, 0xce, 0x7d, 0xb9, 0xbc, 0xbf, 0x4d, 0xaf}}

#define EFI_FTP4_PROTOCOL_GUID \
 {0xeb338826, 0x681b, 0x4295,\
 {0xb3, 0x56, 0x2b, 0x36, 0x4c, 0x75, 0x7b, 0x09}}

typedef struct {
	EFI_EVENT Event;
	EFI_STATUS Status;
} EFI_FTP4_CONNECTION_TOKEN;

typedef struct {
	UINT8 *Username;
	UINT8 *Password;
	BOOLEAN Active;
	BOOLEAN UseDefaultSetting;
	EFI_IPv4_ADDRESS StationIp;
	EFI_IPv4_ADDRESS SubnetMask;
	EFI_IPv4_ADDRESS GatewayIp;
	EFI_IPv4_ADDRESS ServerIp;
	UINT16 ServerPort;
	UINT16 AltDataPort;
	UINT8 RepType;
	UINT8 FileStruct;
	UINT8 TransMode;
} EFI_FTP4_CONFIG_DATA;

typedef EFI_STATUS(EFIAPI *EFI_FTP4_DATA_CALLBACK)(IN EFI_FTP4_PROTOCOL *This, IN EFI_FTP4_COMMAND_TOKEN *Token);

struct EFI_FTP4_COMMAND_TOKEN {
	EFI_EVENT Event;
	UINT8 *Pathname;
	UINT64 DataBufferSize;
	VOID *DataBuffer;
	EFI_FTP4_DATA_CALLBACK *DataCallback;
	VOID *Context;
	EFI_STATUS Status;
};

typedef EFI_STATUS(EFIAPI *EFI_FTP4_GET_MODE_DATA)(IN EFI_FTP4_PROTOCOL *This, OUT EFI_FTP4_CONFIG_DATA *ModeData);
typedef EFI_STATUS(EFIAPI *EFI_FTP4_CONNECT) (IN EFI_FTP4_PROTOCOL *This, IN EFI_FTP4_CONNECTION_TOKEN *Token);
typedef EFI_STATUS(EFIAPI *EFI_FTP4_CLOSE)(IN EFI_FTP4_PROTOCOL *This, IN EFI_FTP4_CONNECTION_TOKEN *Token);
typedef EFI_STATUS(EFIAPI *EFI_FTP4_CONFIGURE) (IN EFI_FTP4_PROTOCOL *This, IN EFI_FTP4_CONFIG_DATA *FtpConfigData OPTIONAL);
typedef EFI_STATUS(EFIAPI *EFI_FTP4_READ_FILE)(IN EFI_FTP4_PROTOCOL *This, IN EFI_FTP4_COMMAND_TOKEN *Token);
typedef EFI_STATUS(EFIAPI *EFI_FTP4_WRITE_FILE)(IN EFI_FTP4_PROTOCOL *This, IN EFI_FTP4_COMMAND_TOKEN *Token);
typedef EFI_STATUS(EFIAPI *EFI_FTP4_READ_DIRECTORY) (IN EFI_FTP4_PROTOCOL *This, IN EFI_FTP4_COMMAND_TOKEN *Token);
typedef EFI_STATUS(EFIAPI *EFI_FTP4_POLL) (IN EFI_FTP4_PROTOCOL *This);

struct EFI_FTP4_PROTOCOL {
	EFI_FTP4_GET_MODE_DATA GetModeData;
	EFI_FTP4_CONNECT Connect;
	EFI_FTP4_CLOSE Close;
	EFI_FTP4_CONFIGURE Configure;
	EFI_FTP4_READ_FILE ReadFile;
	EFI_FTP4_WRITE_FILE WriteFile;
	EFI_FTP4_READ_DIRECTORY ReadDirectory;
	EFI_FTP4_POLL Poll;
};

#define EFI_TLS_SERVICE_BINDING_PROTOCOL_GUID \
{ 0x952cb795, 0xff36, 0x48cf, \
{0xa2, 0x49, 0x4d, 0xf4, 0x86, 0xd6, 0xab, 0x8d}}

#define EFI_TLS_PROTOCOL_GUID \
 { 0xca959f, 0x6cfa, 0x4db1, \
 {0x95, 0xbc, 0xe4, 0x6c, 0x47, 0x51, 0x43, 0x90 }}

#define EFI_TLS_VERIFY_NONE 0x0
#define EFI_TLS_VERIFY_PEER 0x1
#define EFI_TLS_VERIFY_FAIL_IF_NO_PEER_CERT 0x2
#define EFI_TLS_VERIFY_CLIENT_ONCE 0x4

#define MAX_TLS_SESSION_ID_LENGTH 32

typedef enum {
	//
	// Session Configuration
	//
	EfiTlsVersion,
	EfiTlsConnectionEnd,
	EfiTlsCipherList,
	EfiTlsCompressionMethod,
	EfiTlsExtensionData,
	EfiTlsVerifyMethod,
	EfiTlsSessionID,
	EfiTlsSessionState,
	//
	// Session information
	//
	EfiTlsClientRandom,
	EfiTlsServerRandom,
	EfiTlsKeyMaterial,
	EfiTlsSessionDataTypeMaximum
} EFI_TLS_SESSION_DATA_TYPE;

typedef enum {
	EfiTlsSessionNotStarted,
	EfiTlsSessionHandShaking,
	EfiTlsSessionDataTransferring,
	EfiTlsSessionClosing,
	EfiTlsSessionError,
	EfiTlsSessionStateMaximum
} EFI_TLS_SESSION_STATE;

typedef enum {
	EfiTlsEncrypt,
	EfiTlsDecrypt,
} EFI_TLS_CRYPT_MODE;

typedef struct {
	UINT8 Major;
	UINT8 Minor;
} EFI_TLS_VERSION;

typedef enum {
	EfiTlsClient,
	EfiTlsServer,
} EFI_TLS_CONNECTION_END;

typedef struct {
	UINT8 Data1;
	UINT8 Data2;
} EFI_TLS_CIPHER;

typedef UINT8 EFI_TLS_COMPRESSION;

typedef struct {
	UINT16 ExtensionType;
	UINT16 Length;
	UINT8 *Data;
} EFI_TLS_EXTENSION;

typedef UINT32 EFI_TLS_VERIFY;

typedef struct {
	UINT32 GmtUnixTime;
	UINT8 RandomBytes[28];
} EFI_TLS_RANDOM;

typedef struct {
	UINT8 Data[48];
} EFI_TLS_MASTER_SECRET;

typedef struct {
	UINT16 Length;
	UINT8 Data[MAX_TLS_SESSION_ID_LENGTH];
} EFI_TLS_SESSION_ID;

typedef struct {
	UINT32 FragmentLength;
	VOID *FragmentBuffer;
} EFI_TLS_FRAGMENT_DATA;

typedef EFI_STATUS(EFIAPI *EFI_TLS_SET_SESSION_DATA)(IN EFI_TLS_PROTOCOL *This, IN EFI_TLS_SESSION_DATA_TYPE DataType, IN VOID *Data, IN UINTN DataSize);
typedef EFI_STATUS(EFIAPI *EFI_TLS_GET_SESSION_DATA)(IN EFI_TLS_PROTOCOL *This, IN EFI_TLS_SESSION_DATA_TYPE DataType, IN OUT VOID *Data OPTIONAL, IN OUT UINTN *DataSize);
typedef EFI_STATUS(EFIAPI *EFI_TLS_BUILD_RESPONSE_PACKET)(IN EFI_TLS_PROTOCOL *This, IN UINT8 *RequestBuffer OPTIONAL, IN UINTN RequestSize OPTIONAL, OUT UINT8 *Buffer OPTIONAL, IN OUT UINTN *BufferSize);
typedef EFI_STATUS(EFIAPI *EFI_TLS_PROCESS_PACKET)(IN EFI_TLS_PROTOCOL *This, IN OUT EFI_TLS_FRAGMENT_DATA **FragmentTable, IN UINT32 *FragmentCount, IN EFI_TLS_CRYPT_MODE CryptMode);

struct EFI_TLS_PROTOCOL {
	EFI_TLS_SET_SESSION_DATA SetSessionData;
	EFI_TLS_GET_SESSION_DATA GetSessionData;
	EFI_TLS_BUILD_RESPONSE_PACKET BuildResponsePacket;
	EFI_TLS_PROCESS_PACKET ProcessPacket;
};

#define EFI_TLS_CONFIGURATION_PROTOCOL_GUID \
 { 0x1682fe44, 0xbd7a, 0x4407, \
 {0xb7, 0xc7, 0xdc, 0xa3, 0x7c, 0xa3, 0x92, 0x2d }}

typedef enum {
	EfiTlsConfigDataTypeHostPublicCert,
	EfiTlsConfigDataTypeHostPrivateKey,
	EfiTlsConfigDataTypeCACertificate,
	EfiTlsConfigDataTypeCertRevocationList,
	EfiTlsConfigDataTypeMaximum
} EFI_TLS_CONFIG_DATA_TYPE;

typedef EFI_STATUS(EFIAPI *EFI_TLS_CONFIGURATION_SET_DATA)(IN EFI_TLS_CONFIGURATION_PROTOCOL *This, IN EFI_TLS_CONFIG_DATA_TYPE DataType, IN VOID *Data, IN UINTN DataSize);
typedef EFI_STATUS(EFIAPI *EFI_TLS_CONFIGURATION_GET_DATA)(IN EFI_TLS_CONFIGURATION_PROTOCOL *This, IN EFI_TLS_CONFIG_DATA_TYPE DataType, IN OUT VOID *Data OPTIONAL, IN OUT UINTN *DataSize);

struct EFI_TLS_CONFIGURATION_PROTOCOL {
	EFI_TLS_CONFIGURATION_SET_DATA SetData;
	EFI_TLS_CONFIGURATION_GET_DATA GetData;
};

#define EFI_ARP_SERVICE_BINDING_PROTOCOL_GUID \
 {0xf44c00ee,0x1f2c,0x4a00,\
 {0xaa,0x09,0x1c,0x9f,0x3e,0x08,0x00,0xa3}}

#define EFI_ARP_PROTOCOL_GUID \
 {0xf4b427bb,0xba21,0x4f16,\
 {0xbc,0x4e,0x43,0xe4,0x16,0xab,0x61,0x9c}}

typedef struct {
	UINT16 SwAddressType;
	UINT8 SwAddressLength;
	VOID *StationAddress;
	UINT32 EntryTimeOut;
	UINT32 RetryCount;
	UINT32 RetryTimeOut;
} EFI_ARP_CONFIG_DATA;

typedef struct {
	UINT32 Size;
	BOOLEAN DenyFlag;
	BOOLEAN StaticFlag;
	UINT16 HwAddressType;
	UINT16 SwAddressType;
	UINT8 HwAddressLength;
	UINT8 SwAddressLength;
} EFI_ARP_FIND_DATA;

typedef EFI_STATUS(EFIAPI *EFI_ARP_CONFIGURE) (IN EFI_ARP_PROTOCOL *This, IN EFI_ARP_CONFIG_DATA *ConfigData OPTIONAL);
typedef EFI_STATUS(EFIAPI *EFI_ARP_ADD) (IN EFI_ARP_PROTOCOL *This, IN BOOLEAN DenyFlag, IN VOID *TargetSwAddress OPTIONAL, IN VOID *TargetHwAddress OPTIONAL, IN UINT32 TimeoutValue, IN BOOLEAN Overwrite);
typedef EFI_STATUS(EFIAPI *EFI_ARP_FIND) (IN EFI_ARP_PROTOCOL *This, IN BOOLEAN BySwAddress, IN VOID *AddressBuffer OPTIONAL, OUT UINT32 *EntryLength OPTIONAL, OUT UINT32 *EntryCount OPTIONAL, OUT EFI_ARP_FIND_DATA **Entries OPTIONAL, IN BOOLEAN Refresh);
typedef EFI_STATUS(EFIAPI *EFI_ARP_DELETE) (IN EFI_ARP_PROTOCOL *This, IN BOOLEAN BySwAddress, IN VOID *AddressBuffer OPTIONAL);
typedef EFI_STATUS(EFIAPI *EFI_ARP_FLUSH) (IN EFI_ARP_PROTOCOL *This);
typedef EFI_STATUS(EFIAPI *EFI_ARP_REQUEST) (IN EFI_ARP_PROTOCOL *This, IN VOID *TargetSwAddress OPTIONAL, IN EFI_EVENT ResolvedEvent OPTIONAL, OUT VOID *TargetHwAddress);
typedef EFI_STATUS(EFIAPI *EFI_ARP_CANCEL) (IN EFI_ARP_PROTOCOL *This, IN VOID *TargetSwAddress OPTIONAL, IN EFI_EVENT ResolvedEvent OPTIONAL);

struct EFI_ARP_PROTOCOL {
	EFI_ARP_CONFIGURE Configure;
	EFI_ARP_ADD Add;
	EFI_ARP_FIND Find;
	EFI_ARP_DELETE Delete;
	EFI_ARP_FLUSH Flush;
	EFI_ARP_REQUEST Request;
	EFI_ARP_CANCEL Cancel;
};

#define EFI_DHCP4_SERVICE_BINDING_PROTOCOL_GUID \
 {0x9d9a39d8,0xbd42,0x4a73,\
 {0xa4,0xd5,0x8e,0xe9,0x4b,0xe1,0x13,0x80}}

#define EFI_DHCP4_PROTOCOL_GUID \
 {0x8a219718,0x4ef5,0x4761,\
 {0x91,0xc8,0xc0,0xf0,0x4b,0xda,0x9e,0x56}}

typedef enum {
	Dhcp4Stopped = 0x0,
	Dhcp4Init = 0x1,
	Dhcp4Selecting = 0x2,
	Dhcp4Requesting = 0x3,
	Dhcp4Bound = 0x4,
	Dhcp4Renewing = 0x5,
	Dhcp4Rebinding = 0x6,
	Dhcp4InitReboot = 0x7,
	Dhcp4Rebooting = 0x8
} EFI_DHCP4_STATE;

typedef enum {
	Dhcp4SendDiscover = 0x01,
	Dhcp4RcvdOffer = 0x02,
	Dhcp4SelectOffer = 0x03,
	Dhcp4SendRequest = 0x04,
	Dhcp4RcvdAck = 0x05,
	Dhcp4RcvdNak = 0x06,
	Dhcp4SendDecline = 0x07,
	Dhcp4BoundCompleted = 0x08,
	Dhcp4EnterRenewing = 0x09,
	Dhcp4EnterRebinding = 0x0a,
	Dhcp4AddressLost = 0x0b,
	Dhcp4Fail = 0x0c
} EFI_DHCP4_EVENT;

#pragma pack(1)
typedef struct {
	UINT8 OpCode;
	UINT8 HwType;
	UINT8 HwAddrLen;
	UINT8 Hops;
	UINT32 Xid;
	UINT16 Seconds;
	UINT16 Reserved;
	EFI_IPv4_ADDRESS ClientAddr;
	EFI_IPv4_ADDRESS YourAddr;
	EFI_IPv4_ADDRESS ServerAddr;
	EFI_IPv4_ADDRESS GatewayAddr;
	UINT8 ClientHwAddr[16];
	CHAR8 ServerName[64];
	CHAR8 BootFileName[128];
} EFI_DHCP4_HEADER;
#pragma pack()

#pragma pack(1)
typedef struct {
	UINT32 Size;
	UINT32 Length;
	struct {
		EFI_DHCP4_HEADER Header;
		UINT32 Magik;
		UINT8 Option[1];
	} Dhcp4;
} EFI_DHCP4_PACKET;
#pragma pack()

typedef EFI_STATUS(*EFI_DHCP4_CALLBACK)(IN EFI_DHCP4_PROTOCOL *This, IN VOID *Context, IN EFI_DHCP4_STATE CurrentState, IN EFI_DHCP4_EVENT Dhcp4Event, IN EFI_DHCP4_PACKET *Packet, OPTIONAL	OUT EFI_DHCP4_PACKET **NewPacket OPTIONAL);

#pragma pack(1)
typedef struct {
	UINT8 OpCode;
	UINT8 Length;
	UINT8 Data[1];
} EFI_DHCP4_PACKET_OPTION;
#pragma pack()

typedef struct {
	UINT32 DiscoverTryCount;
	UINT32 *DiscoverTimeout;
	UINT32 RequestTryCount;
	UINT32 *RequestTimeout;
	EFI_IPv4_ADDRESS ClientAddress;
	EFI_DHCP4_CALLBACK Dhcp4Callback;
	VOID *CallbackContext;
	UINT32 OptionCount;
	EFI_DHCP4_PACKET_OPTION **OptionList;
} EFI_DHCP4_CONFIG_DATA;

typedef struct {
	EFI_DHCP4_STATE State;
	EFI_DHCP4_CONFIG_DATA ConfigData;
	EFI_IPv4_ADDRESS ClientAddress;
	EFI_MAC_ADDRESS ClientMacAddress;
	EFI_IPv4_ADDRESS ServerAddress;
	EFI_IPv4_ADDRESS RouterAddress;
	EFI_IPv4_ADDRESS SubnetMask;
	UINT32 LeaseTime;
	EFI_DHCP4_PACKET *ReplyPacket;
} EFI_DHCP4_MODE_DATA;

typedef struct {
	EFI_IPv4_ADDRESS ListenAddress;
	EFI_IPv4_ADDRESS SubnetMask;
	UINT16 ListenPort;
} EFI_DHCP4_LISTEN_POINT;

typedef struct {
	EFI_STATUS Status;
	EFI_EVENT CompletionEvent;
	EFI_IPv4_ADDRESS RemoteAddress;
	UINT16 RemotePort;
	EFI_IPv4_ADDRESS GatewayAddress;
	UINT32 ListenPointCount;
	EFI_DHCP4_LISTEN_POINT *ListenPoints;
	UINT32 TimeoutValue;
	EFI_DHCP4_PACKET *Packet;
	UINT32 ResponseCount;
	EFI_DHCP4_PACKET *ResponseList;
} EFI_DHCP4_TRANSMIT_RECEIVE_TOKEN;

typedef EFI_STATUS(EFIAPI *EFI_DHCP4_GET_MODE_DATA)(IN EFI_DHCP4_PROTOCOL *This, OUT EFI_DHCP4_MODE_DATA *Dhcp4ModeData);
typedef EFI_STATUS(EFIAPI *EFI_DHCP4_CONFIGURE) (IN EFI_DHCP4_PROTOCOL *This, IN EFI_DHCP4_CONFIG_DATA *Dhcp4CfgData OPTIONAL);
typedef EFI_STATUS(EFIAPI *EFI_DHCP4_START) (IN EFI_DHCP4_PROTOCOL *This, IN EFI_EVENT CompletionEvent OPTIONAL);
typedef EFI_STATUS(EFIAPI *EFI_DHCP4_RENEW_REBIND) (IN EFI_DHCP4_PROTOCOL *This, IN BOOLEAN RebindRequest, IN EFI_EVENT CompletionEvent OPTIONAL);
typedef EFI_STATUS(EFIAPI *EFI_DHCP4_RELEASE) (IN EFI_DHCP4_PROTOCOL *This);
typedef EFI_STATUS(EFIAPI *EFI_DHCP4_STOP) (IN EFI_DHCP4_PROTOCOL *This);
typedef EFI_STATUS(EFIAPI *EFI_DHCP4_BUILD) (IN EFI_DHCP4_PROTOCOL *This, IN EFI_DHCP4_PACKET *SeedPacket, IN UINT32 DeleteCount, IN UINT8 *DeleteList OPTIONAL, IN UINT32 AppendCount, IN EFI_DHCP4_PACKET_OPTION **AppendList OPTIONAL, OUT EFI_DHCP4_PACKET **NewPacket);
typedef EFI_STATUS(EFIAPI *EFI_DHCP4_TRANSMIT_RECEIVE) (IN EFI_DHCP4_PROTOCOL *This, IN EFI_DHCP4_TRANSMIT_RECEIVE_TOKEN *Token);
typedef EFI_STATUS(EFIAPI *EFI_DHCP4_PARSE) (IN EFI_DHCP4_PROTOCOL *This, IN EFI_DHCP4_PACKET *Packet, IN OUT UINT32 *OptionCount, IN OUT EFI_DHCP4_PACKET_OPTION **PacketOptionList OPTIONAL);

struct EFI_DHCP4_PROTOCOL {
	EFI_DHCP4_GET_MODE_DATA GetModeData;
	EFI_DHCP4_CONFIGURE Configure;
	EFI_DHCP4_START Start;
	EFI_DHCP4_RENEW_REBIND RenewRebind;
	EFI_DHCP4_RELEASE Release;
	EFI_DHCP4_STOP Stop;
	EFI_DHCP4_BUILD Build;
	EFI_DHCP4_TRANSMIT_RECEIVE TransmitReceive;
	EFI_DHCP4_PARSE Parse;
};

#define EFI_DHCP6_SERVICE_BINDING_PROTOCOL_GUID \
 {0x9fb9a8a1,0x2f4a,0x43a6,\
 {0x88,0x9c,0xd0,0xf7,0xb6,0xc4,0x7a,0xd5}}

#define EFI_DHCP6_PROTOCOL_GUID \
 {0x87c8bad7,0x595,0x4053,\
 {0x82,0x97,0xde,0xde,0x39,0x5f,0x5d,0x5b}}

#define EFI_DHCP6_IA_TYPE_NA 3
#define EFI_DHCP6_IA_TYPE_TA 4

typedef enum {
	Dhcp6Init = 0x0,
	Dhcp6Selecting = 0x1,
	Dhcp6Requesting = 0x2,
	Dhcp6Declining = 0x3,
	Dhcp6Confirming = 0x4,
	Dhcp6Releasing = 0x5,
	Dhcp6Bound = 0x6,
	Dhcp6Renewing = 0x7,
	Dhcp6Rebinding = 0x8
} EFI_DHCP6_STATE;

typedef struct {
	UINT16 Length;
	UINT8 Duid[1];
} EFI_DHCP6_DUID;

typedef struct {
	UINT16 Type;
	UINT32 IaId;
} EFI_DHCP6_IA_DESCRIPTOR;
typedef struct {
	EFI_IPv6_ADDRESS IpAddress;
	UINT32 PreferredLifetime;
	UINT32 ValidLifetime;
} EFI_DHCP6_IA_ADDRESS;

#pragma pack(1)
typedef struct {
	UINT32 TransactionId : 24;
	UINT32 MessageType : 8;
} EFI_DHCP6_HEADER;
#pragma pack()

#pragma pack(1)
typedef struct {
	UINT32 Size;
	UINT32 Length;
	struct {
		EFI_DHCP6_HEADER Header;
		UINT8 Option[1];
	} Dhcp6;
} EFI_DHCP6_PACKET;
#pragma pack()

typedef struct {
	EFI_DHCP6_IA_DESCRIPTOR Descriptor;
	EFI_DHCP6_STATE State;
	EFI_DHCP6_PACKET *ReplyPacket;
	UINT32 IaAddressCount;
	EFI_DHCP6_IA_ADDRESS IaAddress[1];
} EFI_DHCP6_IA;

typedef struct {
	EFI_DHCP6_DUID *ClientId;
	EFI_DHCP6_IA *Ia;
} EFI_DHCP6_MODE_DATA;

typedef enum {
	Dhcp6SendSolicit = 0x0,
	Dhcp6RcvdAdvertise = 0x1,
	Dhcp6SelectAdvertise = 0x2,
	Dhcp6SendRequest = 0x3,
	Dhcp6RcvdReply = 0x4,
	Dhcp6RcvdReconfigure = 0x5,
	Dhcp6SendDecline = 0x6,
	Dhcp6SendConfirm = 0x7,
	Dhcp6SendRelease = 0x8,
	Dhcp6SendRenew = 0x9,
	Dhcp6SendRebind = 0xa
} EFI_DHCP6_EVENT;

typedef EFI_STATUS(EFIAPI *EFI_DHCP6_CALLBACK)(IN EFI_DHCP6_PROTOCOL *This, IN VOID *Context, IN EFI_DHCP6_STATE CurrentState, IN EFI_DHCP6_EVENT Dhcp6Event, IN EFI_DHCP6_PACKET *Packet, OUT EFI_DHCP6_PACKET **NewPacket OPTIONAL);

#pragma pack(1)
typedef struct {
	UINT16 OpCode;
	UINT16 OpLen;
	UINT8 Data[1];
} EFI_DHCP6_PACKET_OPTION;
#pragma pack()

typedef struct {
	UINT32 Irt;
	UINT32 Mrc;
	UINT32 Mrt;
	UINT32 Mrd;
} EFI_DHCP6_RETRANSMISSION;

typedef struct {
	EFI_DHCP6_CALLBACK Dhcp6Callback;
	VOID *CallbackContext;
	UINT32 OptionCount;
	EFI_DHCP6_PACKET_OPTION **OptionList;
	EFI_DHCP6_IA_DESCRIPTOR IaDescriptor;
	EFI_EVENT IaInfoEvent;
	BOOLEAN ReconfigureAccept;
	BOOLEAN RapidCommit;
	EFI_DHCP6_RETRANSMISSION *SolicitRetransmission;
} EFI_DHCP6_CONFIG_DATA;

typedef EFI_STATUS(EFIAPI *EFI_DHCP6_GET_MODE_DATA)(IN EFI_DHCP6_PROTOCOL *This, OUT EFI_DHCP6_MODE_DATA *Dhcp6ModeData OPTIONAL, OUT EFI_DHCP6_CONFIG_DATA *Dhcp6ConfigData OPTIONAL);
typedef EFI_STATUS(EFIAPI *EFI_DHCP6_CONFIGURE) (IN EFI_DHCP6_PROTOCOL *This, IN EFI_DHCP6_CONFIG_DATA *Dhcp6CfgData OPTIONAL);
typedef EFI_STATUS(EFIAPI *EFI_DHCP6_START) (IN EFI_DHCP6_PROTOCOL *This);
typedef EFI_STATUS(EFIAPI *EFI_DHCP6_INFO_CALLBACK)(IN EFI_DHCP6_PROTOCOL *This, IN VOID *Context, IN EFI_DHCP6_PACKET *Packet);
typedef EFI_STATUS(EFIAPI *EFI_DHCP6_INFO_REQUEST) (IN EFI_DHCP6_PROTOCOL *This, IN BOOLEAN SendClientId, IN EFI_DHCP6_PACKET_OPTION *OptionRequest, IN UINT32 OptionCount, IN EFI_DHCP6_PACKET_OPTION **OptionList OPTIONAL, IN EFI_DHCP6_RETRANSMISSION *Retransmission, IN EFI_EVENT TimeoutEvent OPTIONAL, IN EFI_DHCP6_INFO_CALLBACK ReplyCallback, IN VOID *CallbackContext OPTIONAL);
typedef EFI_STATUS(EFIAPI *EFI_DHCP6_RENEW_REBIND) (IN EFI_DHCP6_PROTOCOL *This, IN BOOLEAN RebindRequest);
typedef EFI_STATUS(EFIAPI *EFI_DHCP6_DECLINE) (IN EFI_DHCP6_PROTOCOL *This, IN UINT32 AddressCount, IN EFI_IPv6_ADDRESS *Addresses);
typedef EFI_STATUS(EFIAPI *EFI_DHCP6_RELEASE) (IN EFI_DHCP6_PROTOCOL *This, IN UINT32 AddressCount, IN EFI_IPv6_ADDRESS *Addresses);
typedef EFI_STATUS(EFIAPI *EFI_DHCP6_STOP) (IN EFI_DHCP6_PROTOCOL *This);
typedef EFI_STATUS(EFIAPI *EFI_DHCP6_PARSE) (IN EFI_DHCP6_PROTOCOL *This, IN EFI_DHCP6_PACKET *Packet, IN OUT UINT32 *OptionCount, IN EFI_DHCP6_PACKET_OPTION **PacketOptionList OPTIONAL);

struct EFI_DHCP6_PROTOCOL {
	EFI_DHCP6_GET_MODE_DATA GetModeData;
	EFI_DHCP6_CONFIGURE Configure;
	EFI_DHCP6_START Start;
	EFI_DHCP6_INFO_REQUEST InfoRequest;
	EFI_DHCP6_RENEW_REBIND RenewRebind;
	EFI_DHCP6_DECLINE Decline;
	EFI_DHCP6_RELEASE Release;
	EFI_DHCP6_STOP Stop;
	EFI_DHCP6_PARSE Parse;
};

#define EFI_DNS4_SERVICE_BINDING_PROTOCOL_GUID \
{ 0xb625b186, 0xe063, 0x44f7,\
 { 0x89, 0x5, 0x6a, 0x74, 0xdc, 0x6f, 0x52, 0xb4}}

#define EFI_DNS4_PROTOCOL_GUID \
{ 0xae3d28cc, 0xe05b, 0x4fa1,\
 {0xa0, 0x11, 0x7e, 0xb5, 0x5a, 0x3f, 0x14, 0x1 }}

typedef struct {
	UINTN DnsServerListCount;
	EFI_IPv4_ADDRESS *DnsServerList;
	BOOLEAN UseDefaultSetting;
	BOOLEAN EnableDnsCache;
	UINT8 Protocol;
	EFI_IPv4_ADDRESS StationIp;
	EFI_IPv4_ADDRESS SubnetMask;
	UINT16 LocalPort;
	UINT32 RetryCount;
	UINT32 RetryInterval;
} EFI_DNS4_CONFIG_DATA;

typedef struct {
	CHAR16 *HostName;
	EFI_IPv4_ADDRESS *IpAddress;
	UINT32 Timeout;
} EFI_DNS4_CACHE_ENTRY;

typedef struct {
	EFI_DNS4_CONFIG_DATA DnsConfigData;
	UINT32 DnsServerCount;
	EFI_IPv4_ADDRESS *DnsServerList;
	UINT32 DnsCacheCount;
	EFI_DNS4_CACHE_ENTRY *DnsCacheList;
} EFI_DNS4_MODE_DATA;

typedef struct {
	UINT32 IpCount;
	EFI_IPv4_ADDRESS *IpList;
} DNS_HOST_TO_ADDR_DATA;

typedef struct {
	CHAR16 *HostName;
} DNS_ADDR_TO_HOST_DATA;

typedef struct {
	CHAR8 *QName;
	UINT16 QType;
	UINT16 QClass;
	UINT32 TTL;
	UINT16 DataLength;
	CHAR8 *RData;
} DNS_RESOURCE_RECORD;

typedef struct {
	UINTN RRCount;
	DNS_RESOURCE_RECORD *RRList;
} DNS_GENERAL_LOOKUP_DATA;

typedef struct {
	EFI_EVENT Event;
	EFI_STATUS Status;
	UINT32 RetryCount;
	UINT32 RetryInterval;
	union {
		DNS_HOST_TO_ADDR_DATA *H2AData;
		DNS_ADDR_TO_HOST_DATA *A2HData;
		DNS_GENERAL_LOOKUP_DATA *GLookupData;
	} RspData;
} EFI_DNS4_COMPLETION_TOKEN;

typedef EFI_STATUS(EFIAPI *EFI_DNS4_GET_MODE_DATA)(IN EFI_DNS4_PROTOCOL *This, OUT EFI_DNS4_MODE_DATA *DnsModeData);
typedef EFI_STATUS(EFIAPI *EFI_DNS4_CONFIGURE)(IN EFI_DNS4_PROTOCOL *This, IN EFI_DNS4_CONFIG_DATA *DnsConfigData);
typedef EFI_STATUS(EFIAPI *EFI_DNS4_HOST_NAME_TO_IP) (IN EFI_DNS4_PROTOCOL *This, IN CHAR16 *HostName, IN EFI_DNS4_COMPLETION_TOKEN *Token);
typedef EFI_STATUS(EFIAPI *EFI_DNS4_IP_TO_HOST_NAME) (IN EFI_DNS4_PROTOCOL *This, IN EFI_IPv4_ADDRESS IpAddress, IN EFI_DNS4_COMPLETION_TOKEN *Token);
typedef EFI_STATUS(EFIAPI *EFI_DNS4_GENERAL_LOOKUP) (IN EFI_DNS4_PROTOCOL *This, IN CHAR8 *QName, IN UINT16 QType, IN UINT16 QClass, IN EFI_DNS4_COMPLETION_TOKEN *Token);
typedef EFI_STATUS(EFIAPI *EFI_DNS4_UPDATE_DNS_CACHE) (IN EFI_DNS4_PROTOCOL *This, IN BOOLEAN DeleteFlag, IN BOOLEAN Override, IN EFI_DNS4_CACHE_ENTRY DnsCacheEntry);
typedef EFI_STATUS(EFIAPI *EFI_DNS4_POLL) (IN EFI_DNS4_PROTOCOL *This);
typedef EFI_STATUS(EFIAPI *EFI_DNS4_CANCEL) (IN EFI_DNS4_PROTOCOL *This, IN EFI_DNS4_COMPLETION_TOKEN *Token);

struct EFI_DNS4_PROTOCOL {
	EFI_DNS4_GET_MODE_DATA GetModeData;
	EFI_DNS4_CONFIGURE Configure;
	EFI_DNS4_HOST_NAME_TO_IP HostNameToIp;
	EFI_DNS4_IP_TO_HOST_NAME IpToHostName;
	EFI_DNS4_GENERAL_LOOKUP GeneralLookUp;
	EFI_DNS4_UPDATE_DNS_CACHE UpdateDnsCache;
	EFI_DNS4_POLL Poll;
	EFI_DNS4_CANCEL Cancel;
};

#define EFI_DNS6_SERVICE_BINDING_PROTOCOL_GUID \
{ 0x7f1647c8, 0xb76e, 0x44b2,\
 { 0xa5, 0x65, 0xf7, 0xf, 0xf1, 0x9c, 0xd1, 0x9e}}

#define EFI_DNS6_PROTOCOL_GUID \
{ 0xca37bc1f, 0xa327, 0x4ae9,\
 { 0x82, 0x8a, 0x8c, 0x40, 0xd8, 0x50, 0x6a, 0x17 }}

typedef struct {
	BOOLEAN EnableDnsCache;
	UINT8 Protocol;
	EFI_IPv6_ADDRESS StationIp;
	UINT16 LocalPort;
	UINT32 DnsServerCount;
	EFI_IPv6_ADDRESS *DnsServerList;
	UINT32 RetryCount;
	UINT32 RetryInterval;
} EFI_DNS6_CONFIG_DATA;

typedef struct {
	CHAR16 *HostName;
	EFI_IPv6_ADDRESS *IpAddress;
	UINT32 Timeout;
} EFI_DNS6_CACHE_ENTRY;

typedef struct {
	EFI_DNS6_CONFIG_DATA DnsConfigData;
	UINT32 DnsServerCount;
	EFI_IPv6_ADDRESS *DnsServerList;
	UINT32 DnsCacheCount;
	EFI_DNS6_CACHE_ENTRY *DnsCacheList;
} EFI_DNS6_MODE_DATA;

typedef struct {
	UINT32 IpCount;
	EFI_IPv6_ADDRESS *IpList;
} DNS6_HOST_TO_ADDR_DATA;

typedef struct {
	CHAR16 *HostName;
} DNS6_ADDR_TO_HOST_DATA;

typedef struct {
	CHAR8 *QName;
	UINT16 QType;
	UINT16 QClass;
	UINT32 TTL;
	UINT16 DataLength;
	CHAR8 *RData;
} DNS6_RESOURCE_RECORD;

typedef struct {
	UINTN RRCount;
	DNS6_RESOURCE_RECORD *RRList;
} DNS6_GENERAL_LOOKUP_DATA;

typedef struct {
	EFI_EVENT Event;
	EFI_STATUS Status;
	UINT32 RetryCount;
	UINT32 RetryInterval;
	union {
		DNS6_HOST_TO_ADDR_DATA *H2AData;
		DNS6_ADDR_TO_HOST_DATA *A2HData;
		DNS6_GENERAL_LOOKUP_DATA *GLookupData;
	} RspData;
} EFI_DNS6_COMPLETION_TOKEN;

typedef EFI_STATUS(EFIAPI *EFI_DNS6_GET_MODE_DATA)(IN EFI_DNS6_PROTOCOL *This, OUT EFI_DNS6_MODE_DATA *DnsModeData);
typedef EFI_STATUS(EFIAPI *EFI_DNS6_CONFIGURE)(IN EFI_DNS6_PROTOCOL *This, IN EFI_DNS6_CONFIG_DATA *DnsConfigData);
typedef EFI_STATUS(EFIAPI *EFI_DNS6_HOST_NAME_TO_IP) (IN EFI_DNS6_PROTOCOL *This, IN CHAR16 *HostName, IN EFI_DNS6_COMPLETION_TOKEN *Token);
typedef EFI_STATUS(EFIAPI *EFI_DNS6_IP_TO_HOST_NAME) (IN EFI_DNS6_PROTOCOL *This, IN EFI_IPv6_ADDRESS IpAddress, IN EFI_DNS6_COMPLETION_TOKEN *Token);
typedef EFI_STATUS(EFIAPI *EFI_DNS6_GENERAL_LOOKUP) (IN EFI_DNS6_PROTOCOL *This, IN CHAR8 *QName, IN UINT16 QType, IN UINT16 QClass, IN EFI_DNS6_COMPLETION_TOKEN *Token);
typedef EFI_STATUS(EFIAPI *EFI_DNS6_UPDATE_DNS_CACHE) (IN EFI_DNS6_PROTOCOL *This, IN BOOLEAN DeleteFlag, IN BOOLEAN Override, IN EFI_DNS6_CACHE_ENTRY DnsCacheEntry);
typedef EFI_STATUS(EFIAPI *EFI_DNS6_POLL) (IN EFI_DNS6_PROTOCOL *This);
typedef EFI_STATUS(EFIAPI *EFI_DNS6_CANCEL) (IN EFI_DNS6_PROTOCOL *This, IN EFI_DNS6_COMPLETION_TOKEN *Token);

struct EFI_DNS6_PROTOCOL {
	EFI_DNS6_GET_MODE_DATA GetModeData;
	EFI_DNS6_CONFIGURE Configure;
	EFI_DNS6_HOST_NAME_TO_IP HostNameToIp;
	EFI_DNS6_IP_TO_HOST_NAME IpToHostName;
	EFI_DNS6_GENERAL_LOOKUP GeneralLookUp;
	EFI_DNS6_UPDATE_DNS_CACHE UpdateDnsCache;
	EFI_DNS6_POLL Poll;
	EFI_DNS6_CANCEL Cancel;
};

#define EFI_HTTP_SERVICE_BINDING_PROTOCOL_GUID \
 {0xbdc8e6af, 0xd9bc, 0x4379,\
 {0xa7, 0x2a, 0xe0, 0xc4, 0xe7, 0x5d, 0xae, 0x1c}}

#define EFI_HTTP_PROTOCOL_GUID \
 {0x7A59B29B, 0x910B, 0x4171,\
 {0x82, 0x42, 0xA8, 0x5A, 0x0D, 0xF2, 0x5B, 0x5B}}

typedef enum {
	HttpVersion10,
	HttpVersion11,
	HttpVersionUnsupported
} EFI_HTTP_VERSION;

typedef struct {
	BOOLEAN UseDefaultAddress;
	EFI_IPv4_ADDRESS LocalAddress;
	EFI_IPv4_ADDRESS LocalSubnet;
	UINT16 LocalPort;
} EFI_HTTPv4_ACCESS_POINT;

typedef struct {
	EFI_IPv6_ADDRESS LocalAddress;
	UINT16 LocalPort;
} EFI_HTTPv6_ACCESS_POINT;


typedef struct {
	EFI_HTTP_VERSION HttpVersion;
	UINT32 TimeOutMillisec;
	BOOLEAN LocalAddressIsIPv6;
	union {
		EFI_HTTPv4_ACCESS_POINT *IPv4Node;
		EFI_HTTPv6_ACCESS_POINT *IPv6Node;
	} AccessPoint;
} EFI_HTTP_CONFIG_DATA;

typedef enum {
	HttpMethodGet,
	HttpMethodPost,
	HttpMethodPatch,
	HttpMethodOptions,
	HttpMethodConnect,
	HttpMethodHead,
	HttpMethodPut,
	HttpMethodDelete,
	HttpMethodTrace,
	HttpMethodMax
} EFI_HTTP_METHOD;

typedef struct {
	EFI_HTTP_METHOD Method;
	CHAR16 *Url;
} EFI_HTTP_REQUEST_DATA;

typedef struct {
	CHAR8 *FieldName;
	CHAR8 *FieldValue;
} EFI_HTTP_HEADER;

typedef enum {
	HTTP_STATUS_UNSUPPORTED_STATUS = 0,
	HTTP_STATUS_100_CONTINUE,
	HTTP_STATUS_101_SWITCHING_PROTOCOLS,
	HTTP_STATUS_200_OK,
	HTTP_STATUS_201_CREATED,
	HTTP_STATUS_202_ACCEPTED,
	HTTP_STATUS_203_NON_AUTHORITATIVE_INFORMATION,
	HTTP_STATUS_204_NO_CONTENT,
	HTTP_STATUS_205_RESET_CONTENT,
	HTTP_STATUS_206_PARTIAL_CONTENT,
	HTTP_STATUS_300_MULTIPLE_CHIOCES,
	HTTP_STATUS_301_MOVED_PERMANENTLY,
	HTTP_STATUS_302_FOUND,
	HTTP_STATUS_303_SEE_OTHER,
	HTTP_STATUS_304_NOT_MODIFIED,
	HTTP_STATUS_305_USE_PROXY,
	HTTP_STATUS_307_TEMPORARY_REDIRECT,
	HTTP_STATUS_400_BAD_REQUEST,
	HTTP_STATUS_401_UNAUTHORIZED,
	HTTP_STATUS_402_PAYMENT_REQUIRED,
	HTTP_STATUS_403_FORBIDDEN,
	HTTP_STATUS_404_NOT_FOUND,
	HTTP_STATUS_405_METHOD_NOT_ALLOWED,
	HTTP_STATUS_406_NOT_ACCEPTABLE,
	HTTP_STATUS_407_PROXY_AUTHENTICATION_REQUIRED,
	HTTP_STATUS_408_REQUEST_TIME_OUT,
	HTTP_STATUS_409_CONFLICT,
	HTTP_STATUS_410_GONE,
	HTTP_STATUS_411_LENGTH_REQUIRED,
	HTTP_STATUS_412_PRECONDITION_FAILED,
	HTTP_STATUS_413_REQUEST_ENTITY_TOO_LARGE,
	HTTP_STATUS_414_REQUEST_URI_TOO_LARGE,
	HTTP_STATUS_415_UNSUPPORTED_MEDIA_TYPE,
	HTTP_STATUS_416_REQUESTED_RANGE_NOT_SATISFIED,
	HTTP_STATUS_417_EXPECTATION_FAILED,
	HTTP_STATUS_500_INTERNAL_SERVER_ERROR,
	HTTP_STATUS_501_NOT_IMPLEMENTED,
	HTTP_STATUS_502_BAD_GATEWAY,
	HTTP_STATUS_503_SERVICE_UNAVAILABLE,
	HTTP_STATUS_504_GATEWAY_TIME_OUT,
	HTTP_STATUS_505_HTTP_VERSION_NOT_SUPPORTED
} EFI_HTTP_STATUS_CODE;

typedef struct {
	EFI_HTTP_STATUS_CODE StatusCode;
} EFI_HTTP_RESPONSE_DATA;

typedef struct {
	union {
		EFI_HTTP_REQUEST_DATA *Request;
		EFI_HTTP_RESPONSE_DATA *Response;
	} Data;
	UINTN HeaderCount;
	EFI_HTTP_HEADER *Headers;
	UINTN BodyLength;
	VOID *Body;
} EFI_HTTP_MESSAGE;

typedef struct {
	EFI_EVENT Event;
	EFI_STATUS Status;
	EFI_HTTP_MESSAGE *Message;
} EFI_HTTP_TOKEN;

typedef EFI_STATUS(EFIAPI *EFI_HTTP_GET_MODE_DATA)(IN EFI_HTTP_PROTOCOL *This, OUT EFI_HTTP_CONFIG_DATA *HttpConfigData);
typedef EFI_STATUS(EFIAPI *EFI_HTTP_CONFIGURE)(IN EFI_HTTP_PROTOCOL*This, IN EFI_HTTP_CONFIG_DATA*HttpConfigData);
typedef EFI_STATUS(EFIAPI *EFI_HTTP_REQUEST) (IN EFI_HTTP_PROTOCOL *This, IN EFI_HTTP_TOKEN *Token);
typedef EFI_STATUS(EFIAPI *EFI_HTTP_CANCEL)(IN EFI_HTTP_PROTOCOL *This, IN EFI_HTTP_TOKEN *Token);
typedef EFI_STATUS(EFIAPI *EFI_HTTP_RESPONSE) (IN EFI_HTTP_PROTOCOL *This, IN EFI_HTTP_TOKEN *Token);
typedef EFI_STATUS(EFIAPI *EFI_HTTP_POLL) (IN EFI_HTTP_PROTOCOL*This);

struct EFI_HTTP_PROTOCOL {
	EFI_HTTP_GET_MODE_DATA GetModeData;
	EFI_HTTP_CONFIGURE Configure;
	EFI_HTTP_REQUEST Request;
	EFI_HTTP_CANCEL Cancel;
	EFI_HTTP_RESPONSE Response;
	EFI_HTTP_POLL Poll;
};

#define EFI_HTTP_UTILITIES_PROTOCOL_GUID \
{ 0x3E35C163, 0x4074, 0x45DD,\
 { 0x43, 0x1E, 0x23, 0x98, 0x9D, 0xD8, 0x6B, 0x32 }} 

typedef EFI_STATUS(EFIAPI *EFI_HTTP_UTILS_BUILD) (IN EFI_HTTP_UTILITIES_PROTOCOL *This, IN UINTN SeedMessageSize, IN VOID *SeedMessage OPTIONAL, IN UINTN DeleteCount, IN CHAR8 **DeleteList OPTIONAL, IN UINTN AppendCount, IN EFI_HTTP_HEADER **AppendList OPTIONAL, OUT UINTN *NewMessageSize, OUT VOID **NewMessage);
typedef EFI_STATUS(EFIAPI *EFI_HTTP_UTILS_PARSE) (IN EFI_HTTP_PROTOCOL *This, IN CHAR8 *HttpMessage, IN UINTN HttpMessageSize, OUT EFI_HTTP_HEADER **HeaderFields, OUT UINTN *FieldCount);

struct EFI_HTTP_UTILITIES_PROTOCOL {
	EFI_HTTP_UTILS_BUILD Build;
	EFI_HTTP_UTILS_PARSE Parse;
};

#define EFI_REST_PROTOCOL_GUID \
 {0x0DB48A36, 0x4E54, 0xEA9C,\
 { 0x9B, 0x09, 0x1E, 0xA5, 0xBE, 0x3A, 0x66, 0x0B }}

typedef EFI_STATUS(EFIAPI *EFI_REST_SEND_RECEIVE)(IN EFI_REST_PROTOCOL *This, IN EFI_HTTP_MESSAGE *RequestMessage, OUT EFI_HTTP_MESSAGE *ResponseMessage);
typedef EFI_STATUS(EFIAPI *EFI_REST_GET_TIME)(IN EFI_REST_PROTOCOL *This, OUT EFI_TIME *Time);

struct EFI_REST_PROTOCOL {
	EFI_REST_SEND_RECEIVE SendReceive;
	EFI_REST_GET_TIME GetServiceTime;
};

#define EFI_UDP4_SERVICE_BINDING_PROTOCOL_GUID \
 {0x83f01464,0x99bd,0x45e5,\
 {0xb3,0x83,0xaf,0x63,0x05,0xd8,0xe9,0xe6}}

#define EFI_UDP4_PROTOCOL_GUID \
 {0x3ad9df29,0x4501,0x478d,\
 {0xb1,0xf8,0x7f,0x7f,0xe7,0x0e,0x50,0xf3}}

#define EFI_NETWORK_UNREACHABLE (100)
#define EFI_HOST_UNREACHABLE (101)
#define EFI_PROTOCOL_UNREACHABLE (102)
#define EFI_PORT_UNREACHABLE (103)
typedef struct {
	//Receiving Filters
	BOOLEAN AcceptBroadcast;
	BOOLEAN AcceptPromiscuous;
	BOOLEAN AcceptAnyPort;
	BOOLEAN AllowDuplicatePort;
	// I/O parameters
	UINT8 TypeOfService;
	UINT8 TimeToLive;
	BOOLEAN DoNotFragment;
	UINT32 ReceiveTimeout;
	UINT32 TransmitTimeout;
	// Access Point
	BOOLEAN UseDefaultAddress;
	EFI_IPv4_ADDRESS StationAddress;
	EFI_IPv4_ADDRESS SubnetMask;
	UINT16 StationPort;
	EFI_IPv4_ADDRESS RemoteAddress;
	UINT16 RemotePort;
} EFI_UDP4_CONFIG_DATA;

typedef struct {
	EFI_IPv4_ADDRESS SourceAddress;
	UINT16 SourcePort;
	EFI_IPv4_ADDRESS DestinationAddress;
	UINT16 DestinationPort;
} EFI_UDP4_SESSION_DATA;

typedef struct {
	UINT32 FragmentLength;
	VOID *FragmentBuffer;
} EFI_UDP4_FRAGMENT_DATA;

typedef struct {
	EFI_TIME TimeStamp;
	EFI_EVENT RecycleSignal;
	EFI_UDP4_SESSION_DATA UdpSession;
	UINT32 DataLength;
	UINT32 FragmentCount;
	EFI_UDP4_FRAGMENT_DATA FragmentTable[1];
} EFI_UDP4_RECEIVE_DATA;

typedef struct {
	EFI_UDP4_SESSION_DATA *UdpSessionData;
	EFI_IPv4_ADDRESS *GatewayAddress;
	UINT32 DataLength;
	UINT32 FragmentCount;
	EFI_UDP4_FRAGMENT_DATA FragmentTable[1];
} EFI_UDP4_TRANSMIT_DATA;

typedef struct {
	EFI_EVENT Event;
	EFI_STATUS Status;
	union {
		EFI_UDP4_RECEIVE_DATA *RxData;
		EFI_UDP4_TRANSMIT_DATA *TxData;
	} Packet;
} EFI_UDP4_COMPLETION_TOKEN;

typedef EFI_STATUS(EFIAPI *EFI_UDP4_GET_MODE_DATA) (IN EFI_UDP4_PROTOCOL *This, OUT EFI_UDP4_CONFIG_DATA *Udp4ConfigData OPTIONAL, OUT EFI_IP4_MODE_DATA *Ip4ModeData OPTIONAL, OUT EFI_MANAGED_NETWORK_CONFIG_DATA *MnpConfigData OPTIONAL, OUT EFI_SIMPLE_NETWORK_MODE *SnpModeData OPTIONAL);
typedef EFI_STATUS(EFIAPI *EFI_UDP4_CONFIGURE) (IN EFI_UDP4_PROTOCOL *This, IN EFI_UDP4_CONFIG_DATA *UdpConfigData OPTIONAL);
typedef EFI_STATUS(EFIAPI *EFI_UDP4_GROUPS) (IN EFI_UDP4_PROTOCOL *This, IN BOOLEAN JoinFlag, IN EFI_IPv4_ADDRESS *MulticastAddress OPTIONAL);
typedef EFI_STATUS(EFIAPI *EFI_UDP4_ROUTES) (IN EFI_UDP4_PROTOCOL *This, IN BOOLEAN DeleteRoute, IN EFI_IPv4_ADDRESS *SubnetAddress, IN EFI_IPv4_ADDRESS *SubnetMask, IN EFI_IPv4_ADDRESS *GatewayAddress);
typedef EFI_STATUS(EFIAPI *EFI_UDP4_TRANSMIT) (IN EFI_UDP4_PROTOCOL *This, IN EFI_UDP4_COMPLETION_TOKEN *Token);
typedef EFI_STATUS(EFIAPI *EFI_UDP4_RECEIVE) (IN EFI_UDP4_PROTOCOL *This, IN EFI_UDP4_COMPLETION_TOKEN *Token);
typedef EFI_STATUS(EFIAPI *EFI_UDP4_CANCEL)(IN EFI_UDP4_PROTOCOL *This, IN EFI_UDP4_COMPLETION_TOKEN *Token OPTIONAL);
typedef EFI_STATUS(EFIAPI *EFI_UDP4_POLL) (IN EFI_UDP4_PROTOCOL *This);


struct EFI_UDP4_PROTOCOL {
	EFI_UDP4_GET_MODE_DATA GetModeData;
	EFI_UDP4_CONFIGURE Configure;
	EFI_UDP4_GROUPS Groups;
	EFI_UDP4_ROUTES Routes;
	EFI_UDP4_TRANSMIT Transmit;
	EFI_UDP4_RECEIVE Receive;
	EFI_UDP4_CANCEL Cancel;
	EFI_UDP4_POLL Poll;
};


#define EFI_UDP6_SERVICE_BINDING_PROTOCOL_GUID \
 {0x66ed4721, 0x3c98, 0x4d3e,\
 {0x81, 0xe3, 0xd0, 0x3d, 0xd3, 0x9a, 0x72, 0x54}}

#define EFI_UDP6_PROTOCOL_GUID \
 {0x4f948815, 0xb4b9, 0x43cb,\
 {0x8a, 0x33, 0x90, 0xe0, 0x60, 0xb3, 0x49, 0x55}}

typedef struct {
	//Receiving Filters

	BOOLEAN AcceptPromiscuous;
	BOOLEAN AcceptAnyPort;
	BOOLEAN AllowDuplicatePort;
	//I/O parameters
	

	UINT8 TrafficClass;
	UINT8 HopLimit;
	
	UINT32 ReceiveTimeout;
	UINT32 TransmitTimeout;
	//Access Point
	EFI_IPv6_ADDRESS StationAddress;
	UINT16 StationPort;
	EFI_IPv6_ADDRESS RemoteAddress;
	UINT16 RemotePort;
} EFI_UDP6_CONFIG_DATA;

typedef struct {
	EFI_IPv6_ADDRESS SourceAddress;
	UINT16 SourcePort;
	EFI_IPv6_ADDRESS DestinationAddress;
	UINT16 DestinationPort;
} EFI_UDP6_SESSION_DATA;

typedef struct {
	UINT32 FragmentLength;
	VOID *FragmentBuffer;
} EFI_UDP6_FRAGMENT_DATA;

typedef struct {
	EFI_TIME TimeStamp;
	EFI_EVENT RecycleSignal;
	EFI_UDP6_SESSION_DATA UdpSession;
	UINT32 DataLength;
	UINT32 FragmentCount;
	EFI_UDP6_FRAGMENT_DATA FragmentTable[1];
} EFI_UDP6_RECEIVE_DATA;

typedef struct {
	EFI_UDP6_SESSION_DATA *UdpSessionData;
	UINT32 DataLength;
	UINT32 FragmentCount;
	EFI_UDP6_FRAGMENT_DATA FragmentTable[1];
} EFI_UDP6_TRANSMIT_DATA;

typedef struct {
	EFI_EVENT Event;
	EFI_STATUS Status;
	union {
		EFI_UDP6_RECEIVE_DATA *RxData;
		EFI_UDP6_TRANSMIT_DATA *TxData;
	} Packet;
} EFI_UDP6_COMPLETION_TOKEN;
typedef EFI_STATUS(EFIAPI *EFI_UDP6_GET_MODE_DATA) (IN EFI_UDP6_PROTOCOL *This, OUT EFI_UDP6_CONFIG_DATA *Udp6ConfigData OPTIONAL, OUT EFI_IP6_MODE_DATA *Ip6ModeData OPTIONAL, OUT EFI_MANAGED_NETWORK_CONFIG_DATA *MnpConfigData OPTIONAL, OUT EFI_SIMPLE_NETWORK_MODE *SnpModeData OPTIONAL);
typedef EFI_STATUS(EFIAPI *EFI_UDP6_CONFIGURE) (IN EFI_UDP6_PROTOCOL *This, IN EFI_UDP6_CONFIG_DATA *UdpConfigData OPTIONAL);
typedef EFI_STATUS(EFIAPI *EFI_UDP6_GROUPS) (IN EFI_UDP6_PROTOCOL *This, IN BOOLEAN JoinFlag, IN EFI_IPv6_ADDRESS *MulticastAddress OPTIONAL);
typedef EFI_STATUS(EFIAPI *EFI_UDP6_TRANSMIT) (IN EFI_UDP6_PROTOCOL *This, IN EFI_UDP6_COMPLETION_TOKEN *Token);
typedef EFI_STATUS(EFIAPI *EFI_UDP6_RECEIVE) (IN EFI_UDP6_PROTOCOL *This, IN EFI_UDP6_COMPLETION_TOKEN *Token);
typedef EFI_STATUS(EFIAPI *EFI_UDP6_CANCEL)(IN EFI_UDP6_PROTOCOL *This, IN EFI_UDP6_COMPLETION_TOKEN *Token OPTIONAL);
typedef EFI_STATUS(EFIAPI *EFI_UDP6_POLL) (IN EFI_UDP6_PROTOCOL *This);


struct EFI_UDP6_PROTOCOL {
	EFI_UDP6_GET_MODE_DATA GetModeData;
	EFI_UDP6_CONFIGURE Configure;
	EFI_UDP6_GROUPS Groups;
	EFI_UDP6_TRANSMIT Transmit;
	EFI_UDP6_RECEIVE Receive;
	EFI_UDP6_CANCEL Cancel;
	EFI_UDP6_POLL Poll;
};

#define EFI_MTFTP4_SERVICE_BINDING_PROTOCOL_GUID \
 {0x2e800be,0x8f01,0x4aa6,\
 {0x94,0x6b,0xd7,0x13,0x88,0xe1,0x83,0x3f}}

#define EFI_MTFTP4_PROTOCOL_GUID \
 {0x78247c57,0x63db,0x4708,\
 {0x99,0xc2,0xa8,0xb4,0xa9,0xa6,0x1f,0x6b}}

#define EFI_MTFTP4_OPCODE_RRQ 1
#define EFI_MTFTP4_OPCODE_WRQ 2
#define EFI_MTFTP4_OPCODE_DATA 3
#define EFI_MTFTP4_OPCODE_ACK 4
#define EFI_MTFTP4_OPCODE_ERROR 5
#define EFI_MTFTP4_OPCODE_OACK 6
#define EFI_MTFTP4_OPCODE_DIR 7
//This field should be ignored and treated as reserved.
#define EFI_MTFTP4_OPCODE_DATA8 8
//This field should be ignored and treated as reserved.
#define EFI_MTFTP4_OPCODE_ACK8 9

#define EFI_MTFTP4_ERRORCODE_NOT_DEFINED 0
#define EFI_MTFTP4_ERRORCODE_FILE_NOT_FOUND 1
#define EFI_MTFTP4_ERRORCODE_ACCESS_VIOLATION 2
#define EFI_MTFTP4_ERRORCODE_DISK_FULL 3
#define EFI_MTFTP4_ERRORCODE_ILLEGAL_OPERATION 4
#define EFI_MTFTP4_ERRORCODE_UNKNOWN_TRANSFER_ID 5
#define EFI_MTFTP4_ERRORCODE_FILE_ALREADY_EXISTS 6
#define EFI_MTFTP4_ERRORCODE_NO_SUCH_USER 7
#define EFI_MTFTP4_ERRORCODE_REQUEST_DENIED 8

typedef struct {
	BOOLEAN UseDefaultSetting;
	EFI_IPv4_ADDRESS StationIp;
	EFI_IPv4_ADDRESS SubnetMask;
	UINT16 LocalPort;
	EFI_IPv4_ADDRESS GatewayIp;
	EFI_IPv4_ADDRESS ServerIp;
	UINT16 InitialServerPort;
	UINT16 TryCount;
	UINT16 TimeoutValue;
} EFI_MTFTP4_CONFIG_DATA;

typedef struct {
	EFI_MTFTP4_CONFIG_DATA ConfigData;
	UINT8 SupportedOptionCount;
	UINT8 **SupportedOptions;
	UINT8 UnsupportedOptionCount;
	UINT8 **UnsupportedOptions;
} EFI_MTFTP4_MODE_DATA;

typedef struct {
	EFI_IPv4_ADDRESS GatewayIp;
	EFI_IPv4_ADDRESS ServerIp;
	UINT16 ServerPort;
	UINT16 TryCount;
	UINT16 TimeoutValue;
} EFI_MTFTP4_OVERRIDE_DATA;

typedef struct {
	UINT8 *OptionStr;
	UINT8 *ValueStr;
} EFI_MTFTP4_OPTION;

typedef struct {
	UINT16 OpCode;
	UINT16 Block[1];
} EFI_MTFTP4_ACK_HEADER;

typedef struct {
	UINT16 OpCode;
	UINT64 Block;
	UINT8 Data[1];
} EFI_MTFTP4_DATA8_HEADER;

typedef struct {
	UINT16 OpCode;
	UINT64 Block[1];
} EFI_MTFTP4_ACK8_HEADER;

typedef struct {
	UINT16 OpCode;
	UINT8 Filename[1];
} EFI_MTFTP4_REQ_HEADER;

typedef struct {
	UINT16 OpCode;
	UINT8 Data[1];
} EFI_MTFTP4_OACK_HEADER;

typedef struct {
	UINT16 OpCode;
	UINT16 Block;
	UINT8 Data[1];
} EFI_MTFTP4_DATA_HEADER;

typedef struct {
	UINT16 OpCode;
	UINT16 ErrorCode;
	UINT8 ErrorMessage[1];
} EFI_MTFTP4_ERROR_HEADER;

typedef union {
	UINT16 OpCode;
	EFI_MTFTP4_REQ_HEADER Rrq, Wrq;
	EFI_MTFTP4_OACK_HEADER Oack;
	EFI_MTFTP4_DATA_HEADER Data;
	EFI_MTFTP4_ACK_HEADER Ack;
	// This field should be ignored and treated as reserved
	EFI_MTFTP4_DATA8_HEADER Data8;
	// This field should be ignored and treated as reserved
	EFI_MTFTP4_ACK8_HEADER Ack8;
	EFI_MTFTP4_ERROR_HEADER Error;
} EFI_MTFTP4_PACKET;


typedef EFI_STATUS(EFIAPI *EFI_MTFTP4_CHECK_PACKET)(IN EFI_MTFTP4_PROTOCOL *This, IN EFI_MTFTP4_TOKEN *Token, IN UINT16 PacketLen, IN EFI_MTFTP4_PACKET *Packet);
typedef EFI_STATUS(EFIAPI *EFI_MTFTP4_TIMEOUT_CALLBACK)(IN EFI_MTFTP4_PROTOCOL *This, IN EFI_MTFTP4_TOKEN *Token);
typedef EFI_STATUS(EFIAPI *EFI_MTFTP4_PACKET_NEEDED)(IN EFI_MTFTP4_PROTOCOL *This, IN EFI_MTFTP4_TOKEN *Token, IN OUT UINT16 *Length, OUT VOID **Buffer);

struct EFI_MTFTP4_TOKEN {
	EFI_STATUS Status;
	EFI_EVENT Event;
	EFI_MTFTP4_OVERRIDE_DATA *OverrideData;
	UINT8 *Filename;
	UINT8 *ModeStr;
	UINT32 OptionCount;
	EFI_MTFTP4_OPTION *OptionList;
	UINT64 BufferSize;
	VOID *Buffer;
	VOID *Context;
	EFI_MTFTP4_CHECK_PACKET CheckPacket;
	EFI_MTFTP4_TIMEOUT_CALLBACK TimeoutCallback;
	EFI_MTFTP4_PACKET_NEEDED PacketNeeded;
};

typedef EFI_STATUS(EFIAPI *EFI_MTFTP4_GET_MODE_DATA)(IN EFI_MTFTP4_PROTOCOL *This, OUT EFI_MTFTP4_MODE_DATA *ModeData);
typedef EFI_STATUS(EFIAPI *EFI_MTFTP4_CONFIGURE)(IN EFI_MTFTP4_PROTOCOL *This, IN EFI_MTFTP4_CONFIG_DATA *MtftpConfigData OPTIONAL);
typedef EFI_STATUS(EFIAPI *EFI_MTFTP4_GET_INFO)(IN EFI_MTFTP4_PROTOCOL *This, IN EFI_MTFTP4_OVERRIDE_DATA *OverrideData OPTIONAL, IN UINT8 *Filename, IN UINT8 *ModeStr OPTIONAL, IN UINT8 OptionCount, IN EFI_MTFTP4_OPTION *OptionList OPTIONAL, OUT UINT32 *PacketLength, OUT EFI_MTFTP4_PACKET **Packet OPTIONAL);
typedef EFI_STATUS(EFIAPI *EFI_MTFTP4_PARSE_OPTIONS)(IN EFI_MTFTP4_PROTOCOL *This, IN UINT32 PacketLen, IN EFI_MTFTP4_PACKET *Packet, OUT UINT32 *OptionCount, OUT EFI_MTFTP4_OPTION **OptionList OPTIONAL);
typedef EFI_STATUS(EFIAPI *EFI_MTFTP4_READ_FILE)(IN EFI_MTFTP4_PROTOCOL *This, IN EFI_MTFTP4_TOKEN *Token);
typedef EFI_STATUS(EFIAPI *EFI_MTFTP4_WRITE_FILE)(IN EFI_MTFTP4_PROTOCOL *This, IN EFI_MTFTP4_TOKEN *Token);
typedef EFI_STATUS(EFIAPI *EFI_MTFTP4_READ_DIRECTORY)(IN EFI_MTFTP4_PROTOCOL *This, IN EFI_MTFTP4_TOKEN *Token);
typedef EFI_STATUS(EFIAPI *EFI_MTFTP4_POLL) (IN EFI_MTFTP4_PROTOCOL *This);

struct EFI_MTFTP4_PROTOCOL {
	EFI_MTFTP4_GET_MODE_DATA GetModeData;
	EFI_MTFTP4_CONFIGURE Configure;
	EFI_MTFTP4_GET_INFO GetInfo;
	EFI_MTFTP4_PARSE_OPTIONS ParseOptions;
	EFI_MTFTP4_READ_FILE ReadFile;
	EFI_MTFTP4_WRITE_FILE WriteFile;
	EFI_MTFTP4_READ_DIRECTORY ReadDirectory;
	EFI_MTFTP4_POLL Poll;
};

#define EFI_MTFTP6_SERVICE_BINDING_PROTOCOL_GUID \
 {0xd9760ff3,0x3cca,0x4267,\
 {0x80,0xf9,0x75,0x27,0xfa,0xfa,0x42,0x23}}

#define EFI_MTFTP6_PROTOCOL_GUID \
 {0xbf0a78ba,0xec29,0x49cf,\
 {0xa1,0xc9,0x7a,0xe5,0x4e,0xab,0x6a,0x51}}

#define EFI_MTFTP6_OPCODE_RRQ 1
#define EFI_MTFTP6_OPCODE_WRQ 2
#define EFI_MTFTP6_OPCODE_DATA 3
#define EFI_MTFTP6_OPCODE_ACK 6
#define EFI_MTFTP6_OPCODE_ERROR 5
#define EFI_MTFTP6_OPCODE_OACK 6
#define EFI_MTFTP6_OPCODE_DIR 7
//This field should be ignored and treated as reserved#define
#define EFI_MTFTP6_OPCODE_DATA8 8
//This field should be ignored and treated as reserved#define
#define EFI_MTFTP6_OPCODE_ACK8 9

#define EFI_MTFTP6_ERRORCODE_NOT_DEFINED 0
#define EFI_MTFTP6_ERRORCODE_FILE_NOT_FOUND 1
#define EFI_MTFTP6_ERRORCODE_ACCESS_VIOLATION 2
#define EFI_MTFTP6_ERRORCODE_DISK_FULL 3
#define EFI_MTFTP6_ERRORCODE_ILLEGAL_OPERATION 6
#define EFI_MTFTP6_ERRORCODE_UNKNOWN_TRANSFER_ID 5
#define EFI_MTFTP6_ERRORCODE_FILE_ALREADY_EXISTS 6
#define EFI_MTFTP6_ERRORCODE_NO_SUCH_USER 7
#define EFI_MTFTP6_ERRORCODE_REQUEST_DENIED 8

typedef struct {
	EFI_IPv6_ADDRESS StationIp;
	UINT16 LocalPort;
	EFI_IPv6_ADDRESS ServerIp;
	UINT16 InitialServerPort;
	UINT16 TryCount;
	UINT16 TimeoutValue;
} EFI_MTFTP6_CONFIG_DATA;

typedef struct {
	EFI_MTFTP6_CONFIG_DATA ConfigData;
	UINT8 SupportedOptionCount;
	UINT8 **SupportedOptions;
} EFI_MTFTP6_MODE_DATA;

typedef struct {
	EFI_IPv6_ADDRESS ServerIp;
	UINT16 ServerPort;
	UINT16 TryCount;
	UINT16 TimeoutValue;
} EFI_MTFTP6_OVERRIDE_DATA;

typedef struct {
	UINT8 *OptionStr;
	UINT8 *ValueStr;
} EFI_MTFTP6_OPTION;

typedef struct {
	UINT16 OpCode;
	UINT16 Block[1];
} EFI_MTFTP6_ACK_HEADER;

typedef struct {
	UINT16 OpCode;
	UINT64 Block;
	UINT8 Data[1];
} EFI_MTFTP6_DATA8_HEADER;

typedef struct {
	UINT16 OpCode;
	UINT64 Block[1];
} EFI_MTFTP6_ACK8_HEADER;

typedef struct {
	UINT16 OpCode;
	UINT16 ErrorCode;
	UINT8 ErrorMessage[1];
} EFI_MTFTP6_ERROR_HEADER;

typedef struct {
	UINT16 OpCode;
	UINT8 Filename[1];
} EFI_MTFTP6_REQ_HEADER;

typedef struct {
	UINT16 OpCode;
	UINT8 Data[1];
} EFI_MTFTP6_OACK_HEADER;

typedef struct {
	UINT16 OpCode;
	UINT16 Block;
	UINT8 Data[1];
} EFI_MTFTP6_DATA_HEADER;

typedef union {
	UINT16 OpCode;
	EFI_MTFTP6_REQ_HEADER Rrq;
	EFI_MTFTP6_REQ_HEADER Wrq;
	EFI_MTFTP6_OACK_HEADER Oack;
	EFI_MTFTP6_DATA_HEADER Data;
	EFI_MTFTP6_ACK_HEADER Ack;
	// This field should be ignored and treated as reserved.
	EFI_MTFTP6_DATA8_HEADER Data8;
	// This field should be ignored and treated as reserved.
	EFI_MTFTP6_ACK8_HEADER Ack8;
	EFI_MTFTP6_ERROR_HEADER Error;
} EFI_MTFTP6_PACKET;


typedef EFI_STATUS(EFIAPI *EFI_MTFTP6_CHECK_PACKET)(IN EFI_MTFTP6_PROTOCOL *This, IN EFI_MTFTP6_TOKEN *Token, IN UINT16 PacketLen, IN EFI_MTFTP6_PACKET *Packet);
typedef EFI_STATUS(EFIAPI *EFI_MTFTP6_TIMEOUT_CALLBACK)(IN EFI_MTFTP6_PROTOCOL *This, IN EFI_MTFTP6_TOKEN *Token);
typedef EFI_STATUS(EFIAPI *EFI_MTFTP6_PACKET_NEEDED)(IN EFI_MTFTP6_PROTOCOL *This, IN EFI_MTFTP6_TOKEN Token, IN OUT UINT16 *Length, OUT VOID **Buffer);

struct EFI_MTFTP6_TOKEN {
	EFI_STATUS Status;
	EFI_EVENT Event;
	EFI_MTFTP6_OVERRIDE_DATA OverrideData;
	UINT8 *Filename;
	UINT8 *ModeStr;
	UINT32 OptionCount;
	EFI_MTFTP6_OPTION* OptionList;
	UINT64 BufferSize;
	VOID *Buffer;
	VOID *Context;
	EFI_MTFTP6_CHECK_PACKET CheckPacket;
	EFI_MTFTP6_TIMEOUT_CALLBACK TimeoutCallback;
	EFI_MTFTP6_PACKET_NEEDED PacketNeeded;
};

typedef EFI_STATUS(EFIAPI *EFI_MTFTP6_GET_MODE_DATA)(IN EFI_MTFTP6_PROTOCOL *This, OUT EFI_MTFTP6_MODE_DATA *ModeData);
typedef EFI_STATUS(EFIAPI *EFI_MTFTP6_CONFIGURE)(IN EFI_MTFTP6_PROTOCOL *This, IN EFI_MTFTP6_CONFIG_DATA *MtftpConfigData OPTIONAL);
typedef EFI_STATUS(EFIAPI *EFI_MTFTP6_GET_INFO)(IN EFI_MTFTP6_PROTOCOL *This, IN EFI_MTFTP6_OVERRIDE_DATA *OverrideData OPTIONAL, IN UINT8 *Filename, IN UINT8 *ModeStr OPTIONAL, IN UINT8 OptionCount, IN EFI_MTFTP6_OPTION *OptionList OPTIONAL, OUT UINT32 *PacketLength, OUT EFI_MTFTP6_PACKET **Packet OPTIONAL);
typedef EFI_STATUS(EFIAPI *EFI_MTFTP6_PARSE_OPTIONS)(IN EFI_MTFTP6_PROTOCOL *This, IN UINT32 PacketLen, IN EFI_MTFTP6_PACKET *Packet, OUT UINT32 *OptionCount, OUT EFI_MTFTP6_OPTION **OptionList OPTIONAL);
typedef EFI_STATUS(EFIAPI *EFI_MTFTP6_READ_FILE)(IN EFI_MTFTP6_PROTOCOL *This, IN EFI_MTFTP6_TOKEN *Token);
typedef EFI_STATUS(EFIAPI *EFI_MTFTP6_WRITE_FILE)(IN EFI_MTFTP6_PROTOCOL *This, IN EFI_MTFTP6_TOKEN *Token);
typedef EFI_STATUS(EFIAPI *EFI_MTFTP6_READ_DIRECTORY)(IN EFI_MTFTP6_PROTOCOL *This, IN EFI_MTFTP6_TOKEN *Token);
typedef EFI_STATUS(EFIAPI *EFI_MTFTP6_POLL) (IN EFI_MTFTP6_PROTOCOL *This);

struct EFI_MTFTP6_PROTOCOL {
	EFI_MTFTP6_GET_MODE_DATA GetModeData;
	EFI_MTFTP6_CONFIGURE Configure;
	EFI_MTFTP6_GET_INFO GetInfo;
	EFI_MTFTP6_PARSE_OPTIONS ParseOptions;
	EFI_MTFTP6_READ_FILE ReadFile;
	EFI_MTFTP6_WRITE_FILE WriteFile;
	EFI_MTFTP6_READ_DIRECTORY ReadDirectory;
	EFI_MTFTP6_POLL Poll;
};
/*
#define EFI_AUTHENTICATION_INFO_PROTOCOL_GUID \
 {0x7671d9d0,0x53db,0x4173,\
 {0xaa,0x69,0x23,0x27,0xf2,0x1f,0x0b,0xc7}}

typedef EFI_STATUS(EFIAPI *EFI_AUTHENTICATION_INFO_PROTOCOL_GET) (IN EFI_AUTHENTICATION_INFO_PROTOCOL *This, IN EFI_HANDLE ControllerHandle, OUT VOID **Buffer);
typedef EFI_STATUS(EFIAPI *EFI_AUTHENTICATION_INFO_PROTOCOL_SET) (IN EFI_AUTHENTICATION_INFO_PROTOCOL *This, IN EFI_HANDLE ControllerHandle, IN VOID *Buffer);

struct EFI_AUTHENTICATION_INFO_PROTOCOL {
	EFI_AUTHENTICATION_INFO_PROTOCOL_GET Get;
	EFI_AUTHENTICATION_INFO_PROTOCOL_SET Set;
};

#define EFI_AUTHENTICATION_CHAP_RADIUS_GUID \
 {0xd6062b50,0x15ca,0x11da,\
 {0x92,0x19,0x00,0x10,0x83,0xff,0xca,0x4d}}

#define EFI_AUTHENTICATION_CHAP_LOCAL_GUID \
 {0xc280c73e,0x15ca,0x11da,\
 {0xb0,0xca,0x00,0x10,0x83,0xff,0xca,0x4d}}

#define WIN_CERT_TYPE_PKCS_SIGNED_DATA 0x0002
#define WIN_CERT_TYPE_EFI_PKCS115 0x0EF0
#define WIN_CERT_TYPE_EFI_GUID 0x0EF1 



typedef struct _WIN_CERTIFICATE_UEFI_GUID {
	WIN_CERTIFICATE Hdr;
	EFI_GUID CertType;
	UINT8* CertData;
} WIN_CERTIFICATE_UEFI_GUID;

typedef struct _WIN_CERTIFICATE_EFI_PKCS1_15 {
	WIN_CERTIFICATE Hdr;
	EFI_GUID HashAlgorithm;
	UINT8 *Signature;
} WIN_CERTIFICATE_EFI_PKCS1_15;

struct WIN_CERTIFICATE {
	UINT32 dwLength;
	UINT16 wRevision;
	UINT16 wCertificateType;
	UINT8 *bCertificate;
};


#define EFI_CERT_TYPE_RSA2048_SHA256_GUID \
{ 0xa7717414, 0xc616, 0x4977, \
{0x94, 0x20, 0x84, 0x47, 0x12, 0xa7, 0x35, 0xbf} }

#define EFI_CERT_TYPE_PKCS7_GUID \
{0x4aafd29d, 0x68df, 0x49ee, \
{0x8a, 0xa9, 0x34, 0x7d, 0x37, 0x56, 0x65, 0xa7}}

typedef struct _EFI_CERT_BLOCK_RSA_2048_SHA256 {
	EFI_GUID HashType;
	UINT8 PublicKey[256];
	UINT8 Signature[256];
} EFI_CERT_BLOCK_RSA_2048_SHA256;

#pragma pack(1)
typedef struct _EFI_SIGNATURE_DATA {
	EFI_GUID SignatureOwner;
	UINT8 *SignatureData;
} EFI_SIGNATURE_DATA;

typedef struct _EFI_SIGNATURE_LIST {
	EFI_GUID SignatureType;
	UINT32 SignatureListSize;
	UINT32 SignatureHeaderSize;
	UINT32 SignatureSize;
	// UINT8 SignatureHeader[SignatureHeaderSize];
	// EFI_SIGNATURE_DATA Signatures[][SignatureSize];
} EFI_SIGNATURE_LIST;
#pragma pack()

#define EFI_CERT_SHA256_GUID \
 { 0xc1c41626, 0x504c, 0x4092, \
 { 0xac, 0xa9, 0x41, 0xf9, 0x36, 0x93, 0x43, 0x28 } }

#define EFI_CERT_RSA2048_GUID \
 { 0x3c5766e8, 0x269c, 0x4e34, \
 { 0xaa, 0x14, 0xed, 0x77, 0x6e, 0x85, 0xb3, 0xb6 } }

#define EFI_CERT_RSA2048_SHA256_GUID \
 { 0xe2b36190, 0x879b, 0x4a3d, \
 { 0xad, 0x8d, 0xf2, 0xe7, 0xbb, 0xa3, 0x27, 0x84 } }

#define EFI_CERT_SHA1_GUID \
 { 0x826ca512, 0xcf10, 0x4ac9, \
 { 0xb1, 0x87, 0xbe, 0x01, 0x49, 0x66, 0x31, 0xbd } }

#define EFI_CERT_RSA2048_SHA1_GUID \
 { 0x67f8444f, 0x8743, 0x48f1, \
 { 0xa3, 0x28, 0x1e, 0xaa, 0xb8, 0x73, 0x60, 0x80 } }

#define EFI_CERT_X509_GUID \
 { 0xa5c059a1, 0x94e4, 0x4aa7, \
 { 0x87, 0xb5, 0xab, 0x15, 0x5c, 0x2b, 0xf0, 0x72 } }

#define EFI_CERT_SHA224_GUID \
 { 0xb6e5233, 0xa65c, 0x44c9, \
 {0x94, 0x07, 0xd9, 0xab, 0x83, 0xbf, 0xc8, 0xbd} }

#define EFI_CERT_SHA384_GUID \
 { 0xff3e5307, 0x9fd0, 0x48c9, \
 {0x85, 0xf1, 0x8a, 0xd5, 0x6c, 0x70, 0x1e, 0x01}}

#define EFI_CERT_SHA512_GUID \
 { 0x93e0fae, 0xa6c4, 0x4f50, \
 {0x9f, 0x1b, 0xd4, 0x1e, 0x2b, 0x89, 0xc1, 0x9a}}

#define EFI_CERT_X509_SHA256_GUID \
 { 0x3bd2a492, 0x96c0, 0x4079, \
 { 0xb4, 0x20, 0xfc, 0xf9, 0x8e, 0xf1, 0x03, 0xed } }

#pragma pack(1)
typedef struct _EFI_CERT_X509_SHA256 {
	EFI_SHA256_HASH ToBeSignedHash;
	EFI_TIME TimeOfRevocation;
}EFI_CERT_X509_SHA256;
#pragma pack()

#define EFI_CERT_X509_SHA384_GUID \
 { 0x7076876e, 0x80c2, 0x4ee6, \
 { 0xaa, 0xd2, 0x28, 0xb3, 0x49, 0xa6, 0x86, 0x5b } };

#pragma pack(1)
typedef struct _EFI_CERT_X509_SHA384 {
	EFI_SHA384_HASH ToBeSignedHash;
	EFI_TIME TimeOfRevocation;
} EFI_CERT_X509_SHA384;
#pragma pack()

#define EFI_CERT_X509_SHA512_GUID \
 { 0x446dbf63, 0x2502, 0x4cda, \
 { 0xbc, 0xfa, 0x24, 0x65, 0xd2, 0xb0, 0xfe, 0x9d } };

#define EFI_IMAGE_EXECUTION_AUTHENTICATION 0x00000007
#define EFI_IMAGE_EXECUTION_AUTH_UNTESTED 0x00000000
#define EFI_IMAGE_EXECUTION_AUTH_SIG_FAILED 0x00000001
#define EFI_IMAGE_EXECUTION_AUTH_SIG_PASSED 0x00000002
#define EFI_IMAGE_EXECUTION_AUTH_SIG_NOT_FOUND 0x00000003
#define EFI_IMAGE_EXECUTION_AUTH_SIG_FOUND 0x00000004
#define EFI_IMAGE_EXECUTION_POLICY_FAILED 0x00000005
#define EFI_IMAGE_EXECUTION_INITIALIZED 0x00000008

#pragma pack(1)
typedef struct _EFI_CERT_X509_SHA512 {
	EFI_SHA512_HASH ToBeSignedHash;
	EFI_TIME TimeOfRevocation;
} EFI_CERT_X509_SHA512;
#pragma pack()

typedef struct {
	UINTN NumberOfImages;
	EFI_IMAGE_EXECUTION_INFO *InformationInfo;
} EFI_IMAGE_EXECUTION_INFO_TABLE;

typedef UINT32 EFI_IMAGE_EXECUTION_ACTION;

typedef struct {
	EFI_IMAGE_EXECUTION_ACTION Action;
	UINT32 InfoSize;
	// CHAR16 Name[];
	// EFI_DEVICE_PATH_PROTOCOL DevicePath;
	// EFI_SIGNATURE_LIST Signature;
} EFI_IMAGE_EXECUTION_INFO;



#define EFI_IMAGE_SECURITY_DATABASE_GUID \
 { 0xd719b2cb, 0x3d3a, 0x4596, \
 { 0xa3, 0xbc, 0xda, 0xd0, 0x0e, 0x67, 0x65, 0x6f }}

#define EFI_IMAGE_SECURITY_DATABASE L"db"
#define EFI_IMAGE_SECURITY_DATABASE1 L"dbx"
#define EFI_IMAGE_SECURITY_DATABASE2 L"dbt"
#define EFI_IMAGE_SECURITY_DATABASE3 L"dbr"*/
/*
#define UEFI_CONFIG_LANG "x-UEFI"
#define UEFI_CONFIG_LANG_2 "x-i-UEFI"

#define EFI_HII_DEFAULT_CLASS_STANDARD 0x0000
#define EFI_HII_DEFAULT_CLASS_MANUFACTURING 0x0001
#define EFI_HII_DEFAULT_CLASS_SAFE 0x0002
#define EFI_HII_DEFAULT_CLASS_PLATFORM_BEGIN 0x4000
#define EFI_HII_DEFAULT_CLASS_PLATFORM_END 0x7fff
#define EFI_HII_DEFAULT_CLASS_HARDWARE_BEGIN 0x8000
#define EFI_HII_DEFAULT_CLASS_HARDWARE_END 0xbfff
#define EFI_HII_DEFAULT_CLASS_FIRMWARE_BEGIN 0xc000
#define EFI_HII_DEFAULT_CLASS_FIRMWARE_END 0xffff

#define EFI_HII_PACKAGE_TYPE_ALL 0x00
#define EFI_HII_PACKAGE_TYPE_GUID 0x01
#define EFI_HII_PACKAGE_FORMS 0x02
#define EFI_HII_PACKAGE_STRINGS 0x04
#define EFI_HII_PACKAGE_FONTS 0x05
#define EFI_HII_PACKAGE_IMAGES 0x06
#define EFI_HII_PACKAGE_SIMPLE_FONTS 0x07
#define EFI_HII_PACKAGE_DEVICE_PATH 0x08
#define EFI_HII_PACKAGE_KEYBOARD_LAYOUT 0x09
#define EFI_HII_PACKAGE_ANIMATIONS 0x0A
#define EFI_HII_PACKAGE_END 0xDF
#define EFI_HII_PACKAGE_TYPE_SYSTEM_BEGIN 0xE0
#define EFI_HII_PACKAGE_TYPE_SYSTEM_END 0xFF

#define EFI_GLYPH_NON_SPACING 0x01
#define EFI_GLYPH_WIDE 0x02
#define EFI_GLYPH_HEIGHT 19
#define EFI_GLYPH_WIDTH 8

#define EFI_HII_FONT_STYLE_NORMAL 0x00000000
#define EFI_HII_FONT_STYLE_BOLD 0x00000001
#define EFI_HII_FONT_STYLE_ITALIC 0x00000002
#define EFI_HII_FONT_STYLE_EMBOSS 0x00010000
#define EFI_HII_FONT_STYLE_OUTLINE 0x00020000
#define EFI_HII_FONT_STYLE_SHADOW 0x00040000
#define EFI_HII_FONT_STYLE_UNDERLINE 0x00080000
#define EFI_HII_FONT_STYLE_DBL_UNDER 0x00100000

typedef struct {
	UINT32 Length : 24;
	UINT32 Type : 8;
	UINT8 *Data;
} EFI_HII_PACKAGE_HEADER;

typedef struct {
	CHAR16 UnicodeWeight;
	UINT8 Attributes;
	UINT8 GlyphCol1[EFI_GLYPH_HEIGHT];
} EFI_NARROW_GLYPH;

typedef struct {
	CHAR16 UnicodeWeight;
	UINT8 Attributes;
	UINT8 GlyphCol1[EFI_GLYPH_HEIGHT];
	UINT8 GlyphCol2[EFI_GLYPH_HEIGHT];
	UINT8 Pad[3];
} EFI_WIDE_GLYPH;

typedef UINT32 EFI_HII_FONT_STYLE;

typedef struct _EFI_HII_GLYPH_BLOCK {
	UINT8 BlockType;
	UINT8 *BlockBody;
} EFI_HII_GLYPH_BLOCK;

typedef struct _EFI_HII_GLYPH_INFO {
	UINT16 Width;
	UINT16 Height;
	INT16 OffsetX;
	INT16 OffsetY;
	INT16 AdvanceX;
} EFI_HII_GLYPH_INFO;

typedef struct _EFI_HII_FONT_PACKAGE_HDR {
	EFI_HII_PACKAGE_HEADER Header;
	UINT32 HdrSize;
	UINT32 GlyphBlockOffset;
	EFI_HII_GLYPH_INFO Cell;
	EFI_HII_FONT_STYLE FontStyle;
	CHAR16 *FontFamily;
} EFI_HII_FONT_PACKAGE_HDR;

typedef struct _EFI_HII_SIMPLE_FONT_PACKAGE_HDR {
	EFI_HII_PACKAGE_HEADER Header;
	UINT16 NumberOfNarrowGlyphs;
	UINT16 NumberOfWideGlyphs;
	EFI_NARROW_GLYPH *NarrowGlyphs;
	EFI_WIDE_GLYPH *WideGlyphs;
} EFI_HII_SIMPLE_FONT_PACKAGE_HDR;

typedef struct _EFI_HII_GIBT_DEFAULTS_BLOCK {
	EFI_HII_GLYPH_BLOCK Header;
	EFI_HII_GLYPH_INFO Cell;
} EFI_HII_GIBT_DEFAULTS_BLOCK;

typedef struct _EFI_HII_GIBT_DUPLICATE_BLOCK {
	EFI_HII_GLYPH_BLOCK Header;
	CHAR16 CharValue;
} EFI_HII_GIBT_DUPLICATE_BLOCK;

typedef struct _EFI_GLYPH_GIBT_END_BLOCK {
	EFI_HII_GLYPH_BLOCK Header;
} EFI_GLYPH_GIBT_END_BLOCK;

typedef struct _EFI_HII_GIBT_EXT1_BLOCK {
	EFI_HII_GLYPH_BLOCK Header;
	UINT8 BlockType2;
	UINT8 Length;
} EFI_HII_GIBT_EXT1_BLOCK;

typedef struct _EFI_HII_GIBT_EXT2_BLOCK {
	EFI_HII_GLYPH_BLOCK Header;
	UINT8 BlockType2;
	UINT16 Length;
} EFI_HII_GIBT_EXT2_BLOCK;

typedef struct _EFI_HII_GIBT_EXT4_BLOCK {
	EFI_HII_GLYPH_BLOCK Header;
	UINT8 BlockType2;
	UINT32 Length;
} EFI_HII_GIBT_EXT4_BLOCK;

typedef struct _EFI_HII_GIBT_GLYPH_BLOCK {
	EFI_HII_GLYPH_BLOCK Header;
	EFI_HII_GLYPH_INFO Cell;
	UINT8 BitmapData[1];
} EFI_HII_GIBT_GLYPH_BLOCK;

typedef struct _EFI_HII_GIBT_GLYPHS_BLOCK {
	EFI_HII_GLYPH_BLOCK Header;
	EFI_HII_GLYPH_INFO Cell;
	UINT16 Count;
	UINT8 BitmapData[1];
} EFI_HII_GIBT_GLYPHS_BLOCK;

typedef struct _EFI_HII_GIBT_GLYPH_DEFAULT_BLOCK {
	EFI_HII_GLYPH_BLOCK Header;
	UINT8 *BitmapData;
} EFI_HII_GIBT_GLYPH_DEFAULT_BLOCK;

typedef struct _EFI_HII_GIBT_GLYPHS_DEFAULT_BLOCK {
	EFI_HII_GLYPH_BLOCK Header;
	UINT16 Count;
	UINT8 *BitmapData;
} EFI_HII_GIBT_GLYPHS_DEFAULT_BLOCK;

typedef struct _EFI_HII_GIBT_SKIP2_BLOCK {
	EFI_HII_GLYPH_BLOCK Header;
	UINT16 SkipCount;
} EFI_HII_GIBT_SKIP2_BLOCK;

typedef struct _EFI_HII_GIBT_SKIP1_BLOCK {
	EFI_HII_GLYPH_BLOCK Header;
	UINT8 SkipCount;
} EFI_HII_GIBT_SKIP1_BLOCK;

typedef struct _EFI_HII_GIBT_VARIABILITY_BLOCK {
	EFI_HII_GLYPH_BLOCK Header;
	EFI_HII_GLYPH_INFO Cell;
	UINT8 GlyphPackInBits;
	UINT8 BitmapData[1];
} EFI_HII_GIBT_VARIABILITY_BLOCK;

typedef struct _EFI_HII_DEVICE_PATH_PACKAGE {
	EFI_HII_PACKAGE_HEADER Header;
	//EFI_DEVICE_PATH_PROTOCOL DevicePath[];
} EFI_HII_DEVICE_PATH_PACKAGE;

typedef struct _EFI_HII_GUID_PACKAGE_HDR {
	EFI_HII_PACKAGE_HEADER Header;
	EFI_GUID Guid;
	// Data per GUID definition may follow
} EFI_HII_GUID_PACKAGE_HDR;

typedef struct {
	UINT8 BlockType;
	UINT8 *BlockBody;
} EFI_HII_STRING_BLOCK;

typedef struct _EFI_HII_STRING_PACKAGE_HDR {
	EFI_HII_PACKAGE_HEADER Header;
	UINT32 HdrSize;
	UINT32 StringInfoOffset;
	CHAR16 LanguageWindow[16];
	EFI_STRING_ID LanguageName;
	CHAR8 *Language;
} EFI_HII_STRING_PACKAGE_HDR;

typedef struct _EFI_HII_SIBT_DUPLICATE_BLOCK {
	EFI_HII_STRING_BLOCK Header;
	EFI_STRING_ID StringId;
} EFI_HII_SIBT_DUPLICATE_BLOCK;

typedef struct _EFI_HII_SIBT_END_BLOCK {
	EFI_HII_STRING_BLOCK Header;
} EFI_HII_SIBT_END_BLOCK;

typedef struct _EFI_HII_SIBT_EXT1_BLOCK {
	EFI_HII_STRING_BLOCK Header;
	UINT8 BlockType2;
	UINT8 Length;
} EFI_HII_SIBT_EXT1_BLOCK;

typedef struct _EFI_HII_SIBT_EXT2_BLOCK {
	UINT8 BlockType2;
	UINT16 Length;
} EFI_HII_SIBT_EXT2_BLOCK;

typedef struct _EFI_HII_SIBT_EXT4_BLOCK {
	EFI_HII_STRING_BLOCK Header;
	UINT8 BlockType2;
	UINT32 Length;
} EFI_HII_SIBT_EXT4_BLOCK;

typedef struct _EFI_HII_SIBT_FONT_BLOCK {
	EFI_HII_SIBT_EXT2_BLOCK Header;
	UINT8 FontId;
	UINT16 FontSize;
	EFI_HII_FONT_STYLE FontStyle;
	CHAR16 *FontName;
} EFI_HII_SIBT_FONT_BLOCK;

typedef struct _EFI_HII_SIBT_SKIP1_BLOCK {
	EFI_HII_STRING_BLOCK Header;
	UINT8 SkipCount;
} EFI_HII_SIBT_SKIP1_BLOCK;

typedef struct _EFI_HII_SIBT_SKIP2_BLOCK {
	EFI_HII_STRING_BLOCK Header;
	UINT16 SkipCount;
} EFI_HII_SIBT_SKIP2_BLOCK;

typedef struct _EFI_HII_SIBT_STRING_SCSU_BLOCK {
	EFI_HII_STRING_BLOCK Header;
	UINT8 *StringText;
} EFI_HII_SIBT_STRING_SCSU_BLOCK;

typedef struct _EFI_HII_SIBT_STRING_SCSU_FONT_BLOCK {
	EFI_HII_STRING_BLOCK Header;
	UINT8 FontIdentifier;
	UINT8 *StringText;
} EFI_HII_SIBT_STRING_SCSU_FONT_BLOCK;

typedef struct _EFI_HII_SIBT_STRINGS_SCSU_BLOCK {
	EFI_HII_STRING_BLOCK Header;
	UINT16 StringCount;
	UINT8 *StringText;
} EFI_HII_SIBT_STRINGS_SCSU_BLOCK;

typedef struct _EFI_HII_SIBT_STRINGS_SCSU_FONT_BLOCK {
	EFI_HII_STRING_BLOCK Header;
	UINT8 FontIdentifier;
	UINT16 StringCount;
	UINT8 *StringText;
} EFI_HII_SIBT_STRINGS_SCSU_FONT_BLOCK;

typedef struct _EFI_HII_SIBT_STRING_UCS2_BLOCK {
	EFI_HII_STRING_BLOCK Header;
	CHAR16 *StringText;
} EFI_HII_SIBT_STRING_UCS2_BLOCK;

typedef struct _EFI_HII_SIBT_STRING_UCS2_FONT_BLOCK {
	EFI_HII_STRING_BLOCK Header;
	UINT8 FontIdentifier;
	CHAR16 *StringText;
} EFI_HII_SIBT_STRING_UCS2_FONT_BLOCK;

typedef struct _EFI_HII_SIBT_STRINGS_UCS2_BLOCK {
	EFI_HII_STRING_BLOCK Header;
	UINT16 StringCount;
	CHAR16 *StringText;
} EFI_HII_SIBT_STRINGS_UCS2_BLOCK;

typedef struct _EFI_HII_SIBT_STRINGS_UCS2_FONT_BLOCK {
	EFI_HII_STRING_BLOCK Header;
	UINT8 FontIdentifier;
	UINT16 StringCount;
	CHAR16 *StringText;
} EFI_HII_SIBT_STRINGS_UCS2_FONT_BLOCK;

typedef struct _EFI_HII_IMAGE_PACKAGE_HDR {
	EFI_HII_PACKAGE_HEADER Header;
	UINT32 ImageInfoOffset;
	UINT32 PaletteInfoOffset;
} EFI_HII_IMAGE_PACKAGE_HDR;

typedef struct _EFI_HII_IMAGE_BLOCK {
	UINT8 BlockType;
	UINT8 *BlockBody;
} EFI_HII_IMAGE_BLOCK;

#define EFI_HII_IIBT_END 0x00

typedef struct _EFI_HII_IIBT_END_BLOCK {
	EFI_HII_IMAGE_BLOCK Header;
} EFI_HII_IIBT_END_BLOCK;

#define EFI_HII_IIBT_EXT1 0x30

typedef struct _EFI_HII_IIBT_EXT1_BLOCK {
	EFI_HII_IMAGE_BLOCK Header;
	UINT8 BlockType2;
	UINT8 Length;
} EFI_HII_IIBT_EXT1_BLOCK;

#define EFI_HII_IIBT_EXT2 0x31

typedef struct _EFI_HII_IIBT_EXT2_BLOCK {
	EFI_HII_IMAGE_BLOCK Header;
	UINT8 BlockType2;
	UINT16 Length;
} EFI_HII_IIBT_EXT2_BLOCK;

#define EFI_HII_IIBT_EXT4 0x32

typedef struct _EFI_HII_IIBT_EXT4_BLOCK {
	EFI_HII_IMAGE_BLOCK Header;
	UINT8 BlockType2;
	UINT32 Length;
} EFI_HII_IIBT_EXT4_BLOCK;

typedef struct _EFI_HII_IIBT_IMAGE_1BIT_BASE {
	UINT16 Width;
	UINT16 Height;
	UINT8 *Data;
} EFI_HII_IIBT_IMAGE_1BIT_BASE;

#define EFI_HII_IIBT_IMAGE_1BIT 0x10

typedef struct _EFI_HII_IIBT_IMAGE_1BIT_BLOCK {
	EFI_HII_IMAGE_BLOCK Header;
	UINT8 PaletteIndex;
	EFI_HII_IIBT_IMAGE_1BIT_BASE Bitmap;
} EFI_HII_IIBIT_IMAGE_1BIT_BLOCK;

#define EFI_HII_IIBT_IMAGE_1BIT_TRANS 0x11

typedef struct _EFI_HII_IIBT_IMAGE_1BIT_TRANS_BLOCK {
	EFI_HII_IMAGE_BLOCK Header;
	UINT8 PaletteIndex;
	EFI_HII_IIBT_IMAGE_1BIT_BASE Bitmap;
} EFI_HII_IIBT_IMAGE_1BIT_TRANS_BLOCK;

#define EFI_HII_IIBT_IMAGE_24BIT 0x16

typedef struct _EFI_HII_RGB_PIXEL {
	UINT8 b;
	UINT8 g;
	UINT8 r;
} EFI_HII_RGB_PIXEL;

typedef struct _EFI_HII_IIBT_IMAGE_24BIT_BASE {
	UINT16 Width;
	UINT16 Height;
	EFI_HII_RGB_PIXEL *Bitmap;
} EFI_HII_IIBT_IMAGE_24BIT_BASE;

typedef struct _EFI_HII_IIBT_IMAGE_24BIT_BLOCK {
	EFI_HII_IMAGE_BLOCK Header;
	EFI_HII_IIBT_IMAGE_24BIT_BASE Bitmap;
} EFI_HII_IIBT_IMAGE_24BIT_BLOCK;

#define _EFI_HII_IIBT_IMAGE_24BIT_TRANS 0x17

typedef struct EFI_HII_IIBT_IMAGE_24BIT_TRANS_BLOCK {
	EFI_HII_IMAGE_BLOCK Header;
	EFI_HII_IIBT_IMAGE_24BIT_BASE Bitmap;
} EFI_HII_IIBT_IMAGE_24BIT_TRANS_BLOCK;

typedef struct _EFI_HII_IIBT_IMAGE_4BIT_BASE {
	UINT16 Width;
	UINT16 Height;
	UINT8 *Data;
} EFI_HII_IIBT_IMAGE_4BIT_BASE;

#define EFI_HII_IIBT_IMAGE_4BIT 0x12

typedef struct _EFI_HII_IIBT_IMAGE_4BIT_BLOCK {
	EFI_HII_IMAGE_BLOCK Header;
	UINT8 PaletteIndex;
	EFI_HII_IIBT_IMAGE_4BIT_BASE Bitmap;
} EFI_HII_IIBT_IMAGE_4BIT_BLOCK;

#define EFI_HII_IIBT_IMAGE_4BIT_TRANS 0x13
 
typedef struct _EFI_HII_IIBT_IMAGE_4BIT_TRANS_BLOCK {
	EFI_HII_IMAGE_BLOCK Header;
	UINT8 PaletteIndex;
	EFI_HII_IIBT_IMAGE_4BIT_BASE Bitmap;
} EFI_HII_IIBT_IMAGE_4BIT_TRANS_BLOCK;

#define EFI_HII_IIBT_IMAGE_8BIT 0x14

typedef struct _EFI_HII_IIBT_IMAGE_8BIT_BASE {
	UINT16 Width;
	UINT16 Height;
	UINT8 *Data;
} EFI_HII_IIBT_IMAGE_8BIT_BASE;

typedef struct _EFI_HII_IIBT_IMAGE_8BIT_BLOCK {
	EFI_HII_IMAGE_BLOCK Header;
	UINT8 PaletteIndex;
	EFI_HII_IIBT_IMAGE_8BIT_BASE Bitmap;
} EFI_HII_IIBT_IMAGE_8BIT_BLOCK;

#define EFI_HII_IIBT_IMAGE_8BIT_TRANS 0x15

typedef struct _EFI_HII_IIBT_IMAGE_8BIT_TRANS_BLOCK {
	EFI_HII_IMAGE_BLOCK Header;
	UINT8 PaletteIndex;
	EFI_HII_IIBT_IMAGE_8BIT_BASE Bitmap;
} EFI_HII_IIBT_IMAGE_8BIT_TRANS_BLOCK;

#define EFI_HII_IIBT_DUPLICATE 0x20

#define EFI_HII_IIBT_IMAGE_JPEG 0x18

typedef struct _EFI_HII_IIBT_JPEG_BLOCK {
	EFI_HII_IMAGE_BLOCK Header;
	UINT32 Size;
	UINT8 *Data;
} EFI_HII_IIBT_JPEG;

typedef struct _EFI_HII_IIBT_DUPLICATE_BLOCK {
	EFI_HII_IMAGE_BLOCK Header;
	EFI_IMAGE_ID ImageId;
} EFI_HII_IIBT_DUPLICATE_BLOCK;

#define EFI_HII_IIBT_SKIP1 0x22

typedef struct _EFI_HII_IIBT_SKIP1_BLOCK {
	EFI_HII_IMAGE_BLOCK Header;
	UINT8 SkipCount;
} EFI_HII_IIBT_SKIP1_BLOCK;

#define EFI_HII_IIBT_SKIP2 0x21

typedef struct _EFI_HII_IIBT_SKIP2_BLOCK {
	EFI_HII_IMAGE_BLOCK Header;
	UINT16 SkipCount;
} EFI_HII_IIBT_SKIP2_BLOCK;

typedef struct _EFI_HII_IIBT_PNG_BLOCK {
	EFI_HII_IMAGE_BLOCK Header;
	UINT32 Size;
	UINT8 Data[1];
} EFI_HII_IIBT_PNG_BLOCK;

typedef struct _EFI_HII_IMAGE_PALETTE_INFO_HEADER {
	UINT16 PaletteCount;
} EFI_HII_IMAGE_PALETTE_INFO_HEADER;

typedef struct _EFI_HII_IMAGE_PALETTE_INFO {
	UINT16 PaletteSize;
	EFI_HII_RGB_PIXEL *PaletteValue;
} EFI_HII_IMAGE_PALETTE_INFO;

typedef struct _EFI_HII_FORM_PACKAGE_HDR {
	EFI_HII_PACKAGE_HEADER Header;
		//EFI_IFR_OP_HEADER OpCodeHeader;
} EFI_HII_FORM_PACKAGE_HDR;

typedef struct _EFI_IFR_OP_HEADER {
	UINT8 OpCode;
	UINT8 Length : 7;
	UINT8 Scope : 1;
} EFI_IFR_OP_HEADER;

typedef UINT16 EFI_QUESTION_ID;
typedef UINT16 EFI_IMAGE_ID;
typedef UINT16 EFI_FORM_ID;
typedef UINT16 EFI_VARSTORE_ID;
typedef UINT16 EFI_ANIMATION_ID;

#define EFI_IFR_FLAG_READ_ONLY 0x01
#define EFI_IFR_FLAG_CALLBACK 0x04
#define EFI_IFR_FLAG_RESET_REQUIRED 0x10
#define EFI_IFR_FLAG_RECONNECT_REQUIRED 0x40
#define EFI_IFR_FLAG_OPTIONS_ONLY 0x80

typedef UINT16 EFI_STRING_ID;

typedef struct _EFI_IFR_STATEMENT_HEADER {
	EFI_STRING_ID Prompt;
	EFI_STRING_ID Help;
} EFI_IFR_STATEMENT_HEADER;

typedef struct _EFI_IFR_QUESTION_HEADER {
	EFI_IFR_STATEMENT_HEADER Header;
	EFI_QUESTION_ID QuestionId;
	EFI_VARSTORE_ID VarStoreId;
	union {
		EFI_STRING_ID VarName;
		UINT16 VarOffset;
	} VarStoreInfo;
	UINT8 Flags;
} EFI_IFR_QUESTION_HEADER;

#define EFI_IFR_ACTION_OP 0x0C

typedef struct _EFI_IFR_ACTION {
	EFI_IFR_OP_HEADER Header;
	EFI_IFR_QUESTION_HEADER Question;
	EFI_STRING_ID QuestionConfig;
} EFI_IFR_ACTION;

typedef struct _EFI_IFR_ACTION_1 {
	EFI_IFR_OP_HEADER Header;
	EFI_IFR_QUESTION_HEADER Question;
}_EFI_IFR_ACTION_1;

#define EFI_IFR_ANIMATION_OP 0x1F

typedef struct _EFI_IFR_ANIMATION {
	EFI_IFR_OP_HEADER Header;
	EFI_ANIMATION_ID Id;
} EFI_IFR_ANIMATION;

typedef struct _EFI_IFR_ADD {
	EFI_IFR_OP_HEADER Header;
} EFI_IFR_ADD;

#define EFI_IFR_AND_OP 0x15

typedef struct _EFI_IFR_AND {
	EFI_IFR_OP_HEADER Header;
} EFI_IFR_AND;

#define EFI_IFR_BITWISE_AND_OP 0x35

typedef struct _EFI_IFR_BITWISE_AND {
	EFI_IFR_OP_HEADER Header;
} EFI_IFR_BITWISE_AND;


#define EFI_IFR_BITWISE_NOT_OP 0x37

typedef struct _EFI_IFR_BITWISE_NOT {
	EFI_IFR_OP_HEADER Header;
} EFI_IFR_BITWISE_NOT;

#define EFI_IFR_BITWISE_OR_OP 0x36

typedef struct _EFI_IFR_BITWISE_OR {
	EFI_IFR_OP_HEADER Header;
} EFI_IFR_BITWISE_OR;

#define EFI_IFR_CATENATE_OP 0x5e

typedef struct _EFI_IFR_CATENATE {
	EFI_IFR_OP_HEADER Header;
} EFI_IFR_CATENATE;

#define EFI_IFR_CHECKBOX_OP 0x06

typedef struct _EFI_IFR_CHECKBOX {
	EFI_IFR_OP_HEADER Header;
	EFI_IFR_QUESTION_HEADER Question;
	UINT8 Flags;
} EFI_IFR_CHECKBOX;

#define EFI_IFR_CHECKBOX_DEFAULT 0x01
#define EFI_IFR_CHECKBOX_DEFAULT_MFG 0x02

#define EFI_IFR_CONDITIONAL_OP 0x50

typedef struct _EFI_IFR_CONDITIONAL {
	EFI_IFR_OP_HEADER Header;
} EFI_IFR_CONDITIONAL;

#define EFI_IFR_DATE_OP 0x1A

typedef struct _EFI_IFR_DATE {
	EFI_IFR_OP_HEADER Header;
	EFI_IFR_QUESTION_HEADER Question;
	UINT8 Flags;
} EFI_IFR_DATE;

#define EFI_QF_DATE_YEAR_SUPPRESS 0x01
#define EFI_QF_DATE_MONTH_SUPPRESS 0x02
#define EFI_QF_DATE_DAY_SUPPRESS 0x04
#define EFI_QF_DATE_STORAGE 0x30

#define QF_DATE_STORAGE_NORMAL 0x00
#define QF_DATE_STORAGE_TIME 0x10
#define QF_DATE_STORAGE_WAKEUP 0x20

#define EFI_IFR_DEFAULT_OP 0x5b

typedef struct _EFI_IFR_DEFAULT {
	EFI_IFR_OP_HEADER Header;
	UINT16 DefaultId;
	UINT8 Type;
	EFI_IFR_TYPE_VALUE Value;
} EFI_IFR_DEFAULT;

typedef struct _EFI_IFR_DEFAULT_2 {
	EFI_IFR_OP_HEADER Header;
	UINT16 DefaultId;
	UINT8 Type;
} EFI_IFR_DEFAULT_2;

#define EFI_IFR_DEFAULTSTORE_OP 0x5c

typedef struct _EFI_IFR_DEFAULTSTORE {
	EFI_IFR_OP_HEADER Header;
	EFI_STRING_ID DefaultName;
	UINT16 DefaultId;
} EFI_IFR_DEFAULTSTORE;

#define EFI_IFR_DISABLE_IF_OP 0x1e

typedef struct _EFI_IFR_DISABLE_IF {
	EFI_IFR_OP_HEADER Header;
} EFI_IFR_DISABLE_IF;

#define EFI_IFR_DIVIDE_OP 0x3d

typedef struct _EFI_IFR_DIVIDE {
	EFI_IFR_OP_HEADER Header;
} EFI_IFR_DIVIDE;

#define EFI_IFR_DUP_OP 0x57

typedef struct _EFI_IFR_DUP {
	EFI_IFR_OP_HEADER Header;
} EFI_IFR_DUP;

#define EFI_IFR_END_OP 0x29
typedef struct _EFI_IFR_END {
	EFI_IFR_OP_HEADER Header;
} EFI_IFR_END;

#define EFI_IFR_EQUAL_OP 0x2f
typedef struct _EFI_IFR_EQUAL {
	EFI_IFR_OP_HEADER Header;
} EFI_IFR_EQUAL;

#define EFI_IFR_EQ_ID_ID_OP 0x13
typedef struct _EFI_IFR_EQ_ID_ID {
	EFI_IFR_OP_HEADER Header;
	EFI_QUESTION_ID QuestionId1;
	EFI_QUESTION_ID QuestionId2;
} EFI_IFR_EQ_ID_ID;

#define EFI_IFR_EQ_ID_VAL_LIST_OP 0x14
typedef struct _EFI_IFR_EQ_ID_VAL_LIST {
	EFI_IFR_OP_HEADER Header;
	EFI_QUESTION_ID QuestionId;
	UINT16 ListLength;
	UINT16 ValueList[1];
} EFI_IFR_EQ_ID_VAL_LIST;

#define EFI_IFR_EQ_ID_VAL_OP 0x12
typedef struct _EFI_IFR_EQ_ID_VAL {
	EFI_IFR_OP_HEADER Header;
	EFI_QUESTION_ID QuestionId;
	UINT16 Value;
} EFI_IFR_EQ_ID_VAL;

#define EFI_IFR_FALSE_OP 0x47
typedef struct _EFI_IFR_FALSE {
	EFI_IFR_OP_HEADER Header;
} EFI_IFR_FALSE;

#define EFI_IFR_FIND_OP 0x4c
typedef struct _EFI_IFR_FIND {
	EFI_IFR_OP_HEADER Header;
	UINT8 Format;
} EFI_IFR_FIND;

#define EFI_IFR_FF_CASE_SENSITIVE 0x00
#define EFI_IFR_FF_CASE_INSENSITIVE 0x01

#define EFI_IFR_FORM_OP 0x01
typedef struct _EFI_IFR_FORM {
	EFI_IFR_OP_HEADER Header;
	EFI_FORM_ID FormId;
	EFI_STRING_ID FormTitle;
} EFI_IFR_FORM;

typedef struct _EFI_IFR_FORM_MAP_METHOD {
	EFI_STRING_ID MethodTitle;
	EFI_GUID MethodIdentifier;
} EFI_IFR_FORM_MAP_METHOD;
typedef struct _EFI_IFR_FORM_MAP {
	EFI_IFR_OP_HEADER Header;
	EFI_FORM_ID FormId;
	//EFI_IFR_FORM_MAP_METHOD Methods[];
} EFI_IFR_FORM_MAP;

#define EFI_HII_STANDARD_FORM_GUID \
{ 0x3bd2f4ec, 0xe524, 0x46e4, \
{ 0xa9, 0xd8, 0x51, 0x01, 0x17, 0x42, 0x55, 0x62 } }

#define EFI_IFR_FORM_SET_OP 0x0E
typedef struct _EFI_IFR_FORM_SET {
	EFI_IFR_OP_HEADER Header;
	EFI_GUID Guid;
	EFI_STRING_ID FormSetTitle;
	EFI_STRING_ID Help;
	UINT8 Flags;
	//EFI_GUID *ClassGuid;
} EFI_IFR_FORM_SET;

#define EFI_IFR_GET_OP 0x2B
typedef struct _EFI_IFR_GET {
	EFI_IFR_OP_HEADER Header;
	EFI_VARSTORE_ID VarStoreId;
	union {
		EFI_STRING_ID VarName;
		UINT16 VarOffset;
	} VarStoreInfo;
	UINT8 VarStoreType;
} EFI_IFR_GET;

#define EFI_IFR_GRAY_OUT_IF_OP 0x19
typedef struct _EFI_IFR_GRAY_OUT_IF {
	EFI_IFR_OP_HEADER Header;
} EFI_IFR_GRAY_OUT_IF;


#define EFI_IFR_GREATER_EQUAL_OP 0x32
typedef struct _EFI_IFR_GREATER_EQUAL {
	EFI_IFR_OP_HEADER Header;
} EFI_IFR_GREATER_EQUAL;

#define EFI_IFR_GREATER_THAN_OP 0x31
typedef struct _EFI_IFR_GREATER_THAN {
	EFI_IFR_OP_HEADER Header;
} EFI_IFR_GREATER_THAN;

#define EFI_IFR_GUID_OP 0x5F
typedef struct _EFI_IFR_GUID {
	EFI_IFR_OP_HEADER Header;
	EFI_GUID Guid;
	//Optional Data Follows
} EFI_IFR_GUID;

#define EFI_IFR_IMAGE_OP 0x04
typedef struct _EFI_IFR_IMAGE {
	EFI_IMAGE_ID Id;
} EFI_IFR_IMAGE;

#define EFI_IFR_INCONSISTENT_IF_OP 0x011
typedef struct _EFI_IFR_INCONSISTENT_IF {
	EFI_IFR_OP_HEADER Header;
	EFI_STRING_ID Error;
} EFI_IFR_INCONSISTENT_IF; 

#define EFI_IFR_LENGTH_OP 0x56
typedef struct _EFI_IFR_LENGTH {
	EFI_IFR_OP_HEADER Header;
} EFI_IFR_LENGTH;

#define EFI_IFR_LESS_EQUAL_OP 0x34
typedef struct _EFI_IFR_LESS_EQUAL {
	EFI_IFR_OP_HEADER Header;
} EFI_IFR_LESS_EQUAL;#define EFI_IFR_LESS_THAN_OP 0x33
typedef struct _EFI_IFR_LESS_THAN {
	EFI_IFR_OP_HEADER Header;
} EFI_IFR_LESS_THAN;

#define EFI_IFR_LOCKED_OP 0x0B
typedef struct _EFI_IFR_LOCKED {
	EFI_IFR_OP_HEADER Header;
} EFI_IFR_LOCKED;

#define EFI_IFR_MAP_OP 0x22
typedef struct _EFI_IFR_MAP {
	EFI_IFR_OP_HEADER Header;
} EFI_IFR_MAP;

#define EFI_IFR_MATCH_OP 0x2a
typedef struct _EFI_IFR_MATCH {
	EFI_IFR_OP_HEADER Header;
} EFI_IFR_MATCH;

#define EFI_IFR_MID_OP 0x4b
typedef struct _EFI_IFR_MID {
	EFI_IFR_OP_HEADER Header;
} EFI_IFR_MID;

#define EFI_IFR_MODAL_TAG_OP 0x61
typedef struct _EFI_IFR_MODAL_TAG {
	EFI_IFR_OP_HEADER Header;
} EFI_IFR_MODAL_TAG;

#define EFI_IFR_MODULO_OP 0x3e
typedef struct _EFI_IFR_MODULO {
	EFI_IFR_OP_HEADER Header;
} EFI_IFR_MODULO;

#define EFI_IFR_MULTIPLY_OP 0x3c
typedef struct _EFI_IFR_MULTIPLY {
	EFI_IFR_OP_HEADER Header;
} EFI_IFR_MULTPLY;

#define EFI_IFR_NOT_OP 0x17
typedef struct _EFI_IFR_NOT {
	EFI_IFR_OP_HEADER Header;
} EFI_IFR_NOT;

#define EFI_IFR_NOT_EQUAL_OP 0x30
typedef struct _EFI_IFR_NOT_EQUAL {
	EFI_IFR_OP_HEADER Header;
} EFI_IFR_NOT_EQUAL;

#define EFI_IFR_NO_SUBMIT_IF_OP 0x10
typedef struct _EFI_IFR_NO_SUBMIT_IF {
	EFI_IFR_OP_HEADER Header;
	EFI_STRING_ID Error;
} EFI_IFR_NO_SUBMIT_IF;

#define EFI_IFR_NUMERIC_OP 0x07
typedef struct _EFI_IFR_NUMERIC {
	EFI_IFR_OP_HEADER Header;
	EFI_IFR_QUESTION_HEADER Question;
	UINT8 Flags;

	union {
		struct {
			UINT8 MinValue;
			UINT8 MaxValue;
			UINT8 Step;
		} u8;
		struct {
			UINT16 MinValue;
			UINT16 MaxValue;
			UINT16 Step;
		} u16;
		struct {
			UINT32 MinValue;
			UINT32 MaxValue;
			UINT32 Step;
		} u32;
		struct {
			UINT64 MinValue;
			UINT64 MaxValue;
			UINT64 Step;
		} u64;
	} data;
} EFI_IFR_NUMERIC;

#define EFI_IFR_NUMERIC_SIZE 0x03
#define EFI_IFR_NUMERIC_SIZE_1 0x00
#define EFI_IFR_NUMERIC_SIZE_2 0x01
#define EFI_IFR_NUMERIC_SIZE_4 0x02
#define EFI_IFR_NUMERIC_SIZE_8 0x03
#define EFI_IFR_DISPLAY 0x30
#define EFI_IFR_DISPLAY_INT_DEC 0x00
#define EFI_IFR_DISPLAY_UINT_DEC 0x10
#define EFI_IFR_DISPLAY_UINT_HEX 0x20

#define EFI_IFR_ONE_OP 0x53
typedef struct _EFI_IFR_ONE {
	EFI_IFR_OP_HEADER Header;
} EFI_IFR_ONE;

#define EFI_IFR_ONES_OP 0x54
typedef struct _EFI_IFR_ONES {
	EFI_IFR_OP_HEADER Header;
} EFI_IFR_ONES;

#define EFI_IFR_ONE_OF_OP 0x05
typedef struct _EFI_IFR_ONE_OF {
	EFI_IFR_OP_HEADER Header;
	EFI_IFR_QUESTION_HEADER Question;
	UINT8 Flags;
	union {
		struct {
			UINT8 MinValue;
			UINT8 MaxValue;
			UINT8 Step;
		} u8;
		struct {
			UINT16 MinValue;
			UINT16 MaxValue;
			UINT16 Step;
		} u16;
		struct {
			UINT32 MinValue;
			UINT32 MaxValue;
			UINT32 Step;
		} u32;
		struct {
			UINT64 MinValue;
			UINT64 MaxValue;
			UINT64 Step;
		} u64;
	} data;
} EFI_IFR_ONE_OF;

typedef union {
	UINT8 u8; // EFI_IFR_TYPE_NUM_SIZE_8
	UINT16 u16; // EFI_IFR_TYPE_NUM_SIZE_16
	UINT32 u32; // EFI_IFR_TYPE_NUM_SIZE_32
	UINT64 u64; // EFI_IFR_TYPE_NUM_SIZE_64
	BOOLEAN b; // EFI_IFR_TYPE_BOOLEAN
	EFI_HII_TIME time; // EFI_IFR_TYPE_TIME
	EFI_HII_DATE date; // EFI_IFR_TYPE_DATE
	EFI_STRING_ID string; // EFI_IFR_TYPE_STRING, EFI_IFR_TYPE_ACTION
	EFI_HII_REF ref; // EFI_IFR_TYPE_REF
					 // UINT8 buffer[]; // EFI_IFR_TYPE_BUFFER
} EFI_IFR_TYPE_VALUE;

typedef struct {
	UINT8 Hour;
	UINT8 Minute;
	UINT8 Second;
} EFI_HII_TIME;

typedef struct {
	UINT16 Year;
	UINT8 Month;
	UINT8 Day; //
} EFI_HII_DATE;

typedef struct {
	EFI_QUESTION_ID QuestionId;
	EFI_FORM_ID FormId;
	EFI_GUID FormSetGuid;
	EFI_STRING_ID DevicePath;
} EFI_HII_REF;

#define EFI_IFR_TYPE_NUM_SIZE_8 0x00
#define EFI_IFR_TYPE_NUM_SIZE_16 0x01
#define EFI_IFR_TYPE_NUM_SIZE_32 0x02
#define EFI_IFR_TYPE_NUM_SIZE_64 0x03
#define EFI_IFR_TYPE_BOOLEAN 0x04
#define EFI_IFR_TYPE_TIME 0x05
#define EFI_IFR_TYPE_DATE 0x06
#define EFI_IFR_TYPE_STRING 0x07
#define EFI_IFR_TYPE_OTHER 0x08
#define EFI_IFR_TYPE_UNDEFINED 0x09
#define EFI_IFR_TYPE_ACTION 0x0A
#define EFI_IFR_TYPE_BUFFER 0x0B
#define EFI_IFR_TYPE_REF 0x0C
#define EFI_IFR_OPTION_DEFAULT 0x10
#define EFI_IFR_OPTION_DEFAULT_MFG 0x20

#define EFI_IFR_ONE_OF_OPTION_OP 0x09
typedef struct _EFI_IFR_ONE_OF_OPTION {
	EFI_IFR_OP_HEADER Header;
	EFI_STRING_ID Option;
	UINT8 Flags;
	UINT8 Type;
	EFI_IFR_TYPE_VALUE Value;
} EFI_IFR_ONE_OF_OPTION;

#define EFI_IFR_OR_OP 0x16
typedef struct _EFI_IFR_OR {
	EFI_IFR_OP_HEADER Header;
} EFI_IFR_OR;

#define EFI_IFR_ORDERED_LIST_OP 0x23
typedef struct _EFI_IFR_ORDERED_LIST {
	EFI_IFR_OP_HEADER Header;
	EFI_IFR_QUESTION_HEADER Question;
	UINT8 MaxContainers;
	UINT8 Flags;
} EFI_IFR_ORDERED_LIST;

#define EFI_IFR_UNIQUE_SET 0x01
#define EFI_IFR_NO_EMPTY_SET 0x02

#define EFI_IFR_PASSWORD_OP 0x08
typedef struct _EFI_IFR_PASSWORD {
	EFI_IFR_OP_HEADER Header;
	EFI_IFR_QUESTION_HEADER Question;
	UINT16 MinSize;
	UINT16 MaxSize;
} EFI_IFR_PASSWORD;

#define EFI_IFR_QUESTION_REF1_OP 0x40
typedef struct _EFI_IFR_QUESTION_REF1 {
	EFI_IFR_OP_HEADER Header;
	EFI_QUESTION_ID QuestionId;
} EFI_IFR_QUESTION_REF1;#define EFI_IFR_QUESTION_REF2_OP 0x41
typedef struct _EFI_IFR_QUESTION_REF2 {
	EFI_IFR_OP_HEADER Header;
} EFI_IFR_QUESTION_REF2;

#define EFI_IFR_QUESTION_REF3_OP 0x51
typedef struct _EFI_IFR_QUESTION_REF3 {
	EFI_IFR_OP_HEADER Header;
} EFI_IFR_QUESTION_REF3;

typedef struct _EFI_IFR_QUESTION_REF3_2 {
	EFI_IFR_OP_HEADER Header;
	EFI_STRING_ID DevicePath;
} EFI_IFR_QUESTION_REF3_2;

typedef struct _EFI_IFR_QUESTION_REF3_3 {
	EFI_IFR_OP_HEADER Header;
	EFI_STRING_ID DevicePath;
	EFI_GUID Guid;
} EFI_IFR_QUESTION_REF3_3;

#define EFI_IFR_READ_OP 0x2D
typedef struct _EFI_IFR_READ {
	EFI_IFR_OP_HEADER Header;
} EFI_IFR_READ;

#define EFI_IFR_REF_OP 0x0F
typedef struct _EFI_IFR_REF {
	EFI_IFR_OP_HEADER Header;
	EFI_IFR_QUESTION_HEADER Question;
	EFI_FORM_ID FormId;
} EFI_IFR_REF;

typedef struct _EFI_IFR_REF2 {
	EFI_IFR_OP_HEADER Header;
	EFI_IFR_QUESTION_HEADER Question;
	EFI_FORM_ID FormId;
	EFI_QUESTION_ID QuestionId;
} EFI_IFR_REF2;

typedef struct _EFI_IFR_REF3 {
	EFI_IFR_OP_HEADER Header;
	EFI_IFR_QUESTION_HEADER Question;
	EFI_FORM_ID FormId;
	EFI_QUESTION_ID QuestionId;
	EFI_GUID FormSetId;
} EFI_IFR_REF3;

typedef struct _EFI_IFR_REF4 {
	EFI_IFR_OP_HEADER Header;
	EFI_IFR_QUESTION_HEADER Question;
	EFI_FORM_ID FormId;
	EFI_QUESTION_ID QuestionId;
	EFI_GUID FormSetId;
	EFI_STRING_ID DevicePath;
} EFI_IFR_REF4;

typedef struct _EFI_IFR_REF5 {
	EFI_IFR_OP_HEADER Header;
	EFI_IFR_QUESTION_HEADER Question;
} EFI_IFR_REF5;

#define EFI_IFR_REFRESH_OP 0x1d
typedef struct _EFI_IFR_REFRESH {
	EFI_IFR_OP_HEADER Header;
	UINT8 RefreshInterval;
} EFI_IFR_REFRESH;

#define EFI_IFR_REFRESH_ID_OP 0x62
typedef struct _EFI_IFR_REFRESH_ID {
	EFI_IFR_OP_HEADER Header;
	EFI_GUID RefreshEventGroupId;
} EFI_IFR_REFRESH_ID;


#define EFI_IFR_RESET_BUTTON_OP 0x0d
typedef struct _EFI_IFR_RESET_BUTTON {
	EFI_IFR_OP_HEADER Header;
	EFI_IFR_QUESTION_HEADER Statement;
	EFI_DEFAULT_ID DefaultId;
} EFI_IFR_RESET_BUTTON;

typedef UINT16 EFI_DEFAULT_ID;

#define EFI_IFR_RULE_OP 0x18
typedef struct _EFI_IFR_RULE {
	EFI_IFR_OP_HEADER Header;
	UINT8 RuleId;
} EFI_IFR_RULE;

#define EFI_IFR_RULE_REF_OP 0x3f
typedef struct _EFI_IFR_RULE_REF {
	EFI_IFR_OP_HEADER Header;
	UINT8 RuleId;
} EFI_IFR_RULE_REF;

#define EFI_IFR_SECURITY_OP 0x60
typedef struct _EFI_IFR_SECURITY {
	EFI_IFR_OP_HEADER Header;
	EFI_GUID Permissions;
} EFI_IFR_SECURITY;

#define EFI_IFR_SET_OP 0x2C
typedef struct _EFI_IFR_SET {
	EFI_IFR_OP_HEADER Header;
	EFI_VARSTORE_ID VarStoreId;
	union {
		EFI_STRING_ID VarName;
		UINT16 VarOffset;
	} VarStoreInfo;
	UINT8 VarStoreType;
} EFI_IFR_SET;

#define EFI_IFR_SHIFT_LEFT_OP 0x38
typedef struct _EFI_IFR_SHIFT_LEFT {
	EFI_IFR_OP_HEADER Header;
} EFI_IFR_SHIFT_LEFT;

#define EFI_IFR_SHIFT_RIGHT_OP 0x39
typedef struct _EFI_IFR_SHIFT_RIGHT {
	EFI_IFR_OP_HEADER Header;
} EFI_IFR_SHIFT_RIGHT;

#define EFI_IFR_SPAN_OP 0x59
typedef struct _EFI_IFR_SPAN {
	EFI_IFR_OP_HEADER Header;
	UINT8 Flags;
} EFI_IFR_SPAN;#define EFI_IFR_FLAGS_FIRST_MATCHING 0x00
#define EFI_IFR_FLAGS_FIRST_NON_MATCHING 0x01

#define EFI_IFR_STRING_OP 0x1C
typedef struct _EFI_IFR_STRING {
	EFI_IFR_OP_HEADER Header;
	EFI_IFR_QUESTION_HEADER Question;
	UINT8 MinSize;
	UINT8 MaxSize;
	UINT8 Flags;
} EFI_IFR_STRING;

#define EFI_IFR_STRING_MULTI_LINE 0x01

#define EFI_IFR_STRING_REF1_OP 0x4e
typedef struct _EFI_IFR_STRING_REF1 {
	EFI_IFR_OP_HEADER Header;
	EFI_STRING_ID StringId;
} EFI_IFR_STRING_REF1;*/

#define EFI_TIMESTAMP_PROTOCOL_GUID \
 { 0xafbfde41, 0x2e6e, 0x4262, \
 { 0xba, 0x65, 0x62, 0xb9, 0x23, 0x6e, 0x54, 0x95 }}

typedef struct {
	UINT64 Frequency;
	UINT64 EndValue;
} EFI_TIMESTAMP_PROPERTIES;

typedef UINT64(EFIAPI *TIMESTAMP_GET) ();
typedef EFI_STATUS(EFIAPI *TIMESTAMP_GET_PROPERTIES) (OUT EFI_TIMESTAMP_PROPERTIES *Properties);

struct EFI_TIMESTAMP_PROTOCOL {
	TIMESTAMP_GET GetTimestamp;
	TIMESTAMP_GET_PROPERTIES GetProperties;
};


//Lib 

#define TRUE 1
#define FALSE 0

typedef UINT8* va_list;

#define va_size(s) sizeof(s)//((sizeof(s) + sizeof(INT32) - 1) & ~(sizeof(INT32) - 1))

#define va_start(list, arg) (list = ((va_list)&arg) + va_size(arg))
#define va_arg(list, type) (*(type*)((list += va_size(type)) - va_size(type)))
#define va_end(list) (list = (va_list)0)

BOOLEAN InitializeLib(EFI_HANDLE* handle, EFI_SYSTEM_TABLE* systbl);

extern VOID* __cdecl memset(VOID* dest, INT32 v, UINTN size);
#pragma intrinsic(memset)

extern VOID* __cdecl memcpy(VOID* dest, CONST VOID* src, UINTN size);
#pragma intrinsic(memcpy)

UINTN strlen(CONST CHAR16* string);
#pragma intrinsic(strlen)

UINTN __cdecl sprintf(CHAR16* buffer, UINTN bufferSize, CONST CHAR16* format, ...);
UINTN vsprintf(CHAR16* buffer, UINTN bufferSize, CONST CHAR16* format, va_list list);

VOID SetCursor(UINTN x, UINTN y);
VOID print(CONST CHAR16* string);
VOID println(CONST CHAR16* string);
VOID __cdecl printf(CONST CHAR16* format, ...);
VOID vprintf(CONST CHAR16* format, va_list list);

VOID* AllocPages(EFI_ALLOCATE_TYPE type, EFI_MEMORY_TYPE memType, UINTN pages);
VOID* AllocPool(EFI_MEMORY_TYPE type, UINTN size);
VOID Free(VOID* address, UINTN pages);

VOID Sleep(UINTN microseconds);

BOOLEAN ExitBootServices(UINTN key);